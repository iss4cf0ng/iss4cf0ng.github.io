<!DOCTYPE html><html lang="en-us" theme-mode="dark"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>[Studying] Analyzing BeastDoor | ISSAC/iss4cf0ng's blog</title><link rel="icon" type="image/x-icon" href="/favicon.ico"><script>var config = {"root":"/","search":{"preload":true,"activeHolder":"Enter here","blurHolder":"Search","noResult":"Data \"$0\" not found"},"code":{"codeInfo":"$0 - $1 lines","copy":"copy","copyFinish":"copied","expand":"expand"}}</script><script src="//unpkg.com/mermaid@9.2.2/dist/mermaid.min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.6.1/MathJax.js"></script><script>MathJax.Hub.Config({
 menuSettings: {
   zoom: "None"
 },
 showMathMenu: false,
 jax: ["input/TeX","output/CommonHTML"],
 extensions: ["tex2jax.js"],
 TeX: {
   extensions: ["AMSmath.js","AMSsymbols.js"],
   equationNumbers: {
     autoNumber: "AMS"
   }
 },
 tex2jax: {
   inlineMath: [["\\(", "\\)"]],
   displayMath: [["\\[", "\\]"]]
 }
});</script><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lightgallery.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-zoom.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-thumbnail.css"><link type="text/css" rel="stylesheet" href="/lib/fontawesome/brands.min.css"><link type="text/css" rel="stylesheet" href="/lib/fontawesome/fontawesome.min.css"><link rel="stylesheet" href="/css/arknights.css"><script>if (window.localStorage.getItem('theme-mode') === 'light') document.documentElement.setAttribute('theme-mode', 'light')
if (window.localStorage.getItem('theme-mode') === 'dark') document.documentElement.setAttribute('theme-mode', 'dark')</script><style>@font-face {
 font-family: BenderLight;
 src: local('Bender'), url("/font/BenderLight.ttf");
}
@font-face {
 font-family: 'JetBrains Mono';
 src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
}
@font-face {
 font-family: 'Font Awesome 6 Brands';
 src: local('Font Awesome 6 Brands'), url('/lib/fontawesome/fa-brands.woff2') format('woff2');
}
@font-face {
 font-family: 'Font Awesome 6 Free';
 src: local('Font Awesome 6 Free'), url('/lib/fontawesome/fa-regular.woff2') format('woff2');
}</style><style>:root {
  --dark-background: url('https://ak.hypergryph.com/assets/index/images/ak/pc/bk.jpg');
  --light-background: url('/img/bk.jpg');
}</style><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="ISSAC/iss4cf0ng's blog" type="application/atom+xml">
</head><body><div class="loading" style="opacity: 0"><div class="loadingBar left"></div><div class="loadingBar right"></div></div><main><header class="closed"><nav><div class="navBtn hide"><i class="navBtnIcon"><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span></i></div><div class="navItem" id="search-header"><span class="navItemTitle"><input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="Search" spellcheck="false" maxlength="50" type="text" id="search-input"></span></div><div class="navItem" id="search-holder"></div><div class="search-popup"><div id="search-result"></div></div><ol class="navContent"><li class="navItem"><a class="navBlock" href="/"><span class="navItemTitle">Home</span></a></li><li class="navItem" matchdata="categories,tags"><a class="navBlock" href="/archives/"><span class="navItemTitle">Archives</span></a></li><li class="navItem"><a class="navBlock" href="/About/"><span class="navItemTitle">About</span></a></li><li class="navItem"><a class="navBlock" href="/Alien/"><span class="navItemTitle">Alien</span></a></li><li class="navItem"><a class="navBlock" href="/2026/01/28/2026-1-28-ToolsDuplexSpy-v2-0-0/"><span class="navItemTitle">DuplexSpy</span></a></li><li class="navItem"><a class="navBlock" href="/Notes/"><span class="navItemTitle">Notes</span></a></li></ol></nav></header><article><div id="post-bg"><div id="post-title"><h1>[Studying] Analyzing BeastDoor</h1><div id="post-info"><span>First Post: <div class="control"><time datetime="2026-02-20T08:14:41.000Z" id="date"> 2026-02-20</time></div></span><br><span>Last Update: <div class="control"><time datetime="2026-02-25T16:34:55.994Z" id="updated"> 2026-02-26</time></div></span><br><span>Word Count: <div class="control">1.2k</div></span><br><span>Read Time: <div class="control">7 min</div></span></div></div><hr><div id="post-content"><h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>This article is part of my series: <a href="https://iss4cf0ng.github.io/2026/02/18/2026-2-18-StudyingRAT/">Inside Different Generations of RATs</a>. If you are interested in the full series, please click the link above.</p>
<p>This article presents a reverse engineering analysis of BeastDoor(2002), focusing on its internal architecture and communication protocol design.</p>
<h1 id="BeastDoor"><a href="#BeastDoor" class="headerlink" title="BeastDoor"></a>BeastDoor</h1><p>Beast (a.k.a BeastDoor) is a Windows-based backdoor trojan horse. It is capable of infecting versions of Windows from 95 to XP. It was written in Delphi and released first y its author Tataye in 2002 <sup><a href="#fn_1" id="reffn_1">1</a></sup>. Considering the time period, Beast is a powerful RAT since it provides multiple and advanced features.</p>
<p>The earliest publicly available version on the internet is 1.8, while the final released version is 2.07. This article analyzes version 2.07 through reverse engineering.</p>
<p>Since this tool primarily targets Windows XP, some feature may not function correctly on modern operation systems such as Windows 10 or Windows 11.</p>
<h1 id="Experimental-Environmental-Setup"><a href="#Experimental-Environmental-Setup" class="headerlink" title="Experimental Environmental Setup"></a>Experimental Environmental Setup</h1><p>To safely conduct malware analysis, the environment should be isolated using virtual machines. Under no circumstances should malware be executed on a personal or production system</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>Tool</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>PEView</td>
<td>Static analysis tool for examining PE and COFF file structures (EXE, DLL, OBJ, LIB)</td>
</tr>
<tr>
<td>ExeInfo</td>
<td>Tool for identifying packers and analyzing PE metadata</td>
</tr>
<tr>
<td>UPX</td>
<td>Packing and unpacking tool for PE files</td>
</tr>
<tr>
<td>AsDie</td>
<td>PE unpacking and detection tool</td>
</tr>
<tr>
<td>Wireshark</td>
<td>Network protocol analyzer used to capture and inspect live or recorded traffic</td>
</tr>
<tr>
<td>Ghidra</td>
<td>Open-source software reverse engineering framework developed by the NSA</td>
</tr>
</tbody>
</table>
</div>
<hr>
<div class="table-container">
<table>
<thead>
<tr>
<th>Device</th>
<th>IP Address</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Windows XP x86 (VM)</td>
<td>192.168.85.2</td>
<td>Victim machine used for executing both the controller and payload</td>
</tr>
<tr>
<td>Windows 10 x64 (VM)</td>
<td>192.168.85.3</td>
<td>Analysis machine used for reverse engineering</td>
</tr>
</tbody>
</table>
</div>
<p>The two virtual machines where configured within an isolated internal network to prevent unintended external communication. If you want to know how to set up your experimental enviroment, please view:</p>
<ul>
<li><a href="https://iss4cf0ng.github.io/2026/02/21/2026-2-21-HowToSetupYourExpEnv/">How to Setup Your Experimental Environment for Malware Analysis</a></li>
<li><a href="https://iss4cf0ng.github.io/2026/02/21/2026-2-21-WinXpVMWareTool/">Installing VMware Tools on Windows XP and Windows 95 with VMware WorkStation 17</a></li>
</ul>
<h1 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h1><p>Launch <code>Beast2.07.exe</code> on the Windows XP machine:</p>
<p align="center" class='item-img' data-src='/images/article/2026-2-20-Beast/1.png'><img src="/images/article/2026-2-20-Beast/1.png" width=500>
</p>

<p><code>Beast2.07.exe</code> is the attacker-side application. From a networking perspective, it can function as either a server or a client. It supports both direct connections and reverse connections.</p>
<p>To establish a connection, a payload (stub) must first be generated.</p>
<p align="center" class='item-img' data-src='/images/article/2026-2-20-Beast/2.png'><img src="/images/article/2026-2-20-Beast/2.png" width=500>
</p>

<p>Here, the term “Server” may be confusing from a modern perspective. In early-generation RATs, the “server” executable referred to the payload deployed on the victim machine, while the “client” executable provided the graphical interface for attackers. As firewall technilogies evolved and network security became more complex, attackers gradually shifted from direct connections to reverse connections. In addition, the attackers decided to develop builder technique. BeastDoor reflects this transitional design.</p>
<p>To avoid confusion, this article uses the terms:</p>
<ul>
<li>Payload: executable deployed on the victim machine</li>
<li>Controller: attacker-side management application</li>
</ul>
<p>BeastDoor provides process injection capabilities and several builder options, including:</p>
<ul>
<li>Notifications</li>
<li>Startup</li>
<li>AV-FW Kill</li>
<li>Misc</li>
<li>Exe Icon</li>
</ul>
<p><strong>Notifications</strong> are used to inform the attacker when a compromised machine comes online. Several terminologies used by Beast are now obsolete:</p>
<ul>
<li>SIN: Static IP Notification. Used for reverse connections; the host value refers to the attacker’s server.</li>
<li>ICQ: Instant messaging service popular in the late 1990s.</li>
<li>CGI: Common Gateway Interface. In early RATs, this often referred to an HTTP-based notification script.</li>
</ul>
<p>The <strong>Startup</strong> option allows the payload to modify registry entries or ActiveX-related settings to achieve persistence:</p>
<p align="center" class='item-img' data-src='/images/article/2026-2-20-Beast/3.png'><img src="/images/article/2026-2-20-Beast/3.png" width=500>
</p>

<p>The <strong>AV-FW</strong> Kill feature attempts to disable the Windows XP firewall and terminate specified antivirus processes:</p>
<p align="center" class='item-img' data-src='/images/article/2026-2-20-Beast/4.png'><img src="/images/article/2026-2-20-Beast/4.png" width=500>
</p>

<p>The <strong>Misc</strong> options provide additional execution behaviors. For example, the term “Melt” refers to deleting the original executable after execution. The payload copies itself to another directory, launches the replica, and terminates the original process.</p>
<p align="center" class='item-img' data-src='/images/article/2026-2-20-Beast/5.png'><img src="/images/article/2026-2-20-Beast/5.png" width=500>
</p>

<p>The <strong>Exe Icon</strong> option allows the attacker to change the payload’s icon to improve social engineering effectiveness.</p>
<p align="center" class='item-img' data-src='/images/article/2026-2-20-Beast/6.png'><img src="/images/article/2026-2-20-Beast/6.png" width=500>
</p>

<p>Once the payload is executed on the target machine, the controller displays the compromised host if the connection is successful.</p>
<p align="center" class='item-img' data-src='/images/article/2026-2-20-Beast/7.png'><img src="/images/article/2026-2-20-Beast/7.png" width=500>
    <img src="/images/article/2026-2-20-Beast/8.png" width=500>
</p>

<h1 id="Protocol-Analysis"><a href="#Protocol-Analysis" class="headerlink" title="Protocol Analysis"></a>Protocol Analysis</h1><p>Using Wireshark, we can observe Beast 2.07’s network communication:</p>
<p align="center" class='item-img' data-src='/images/article/2026-2-20-Beast/25.png'><img src="/images/article/2026-2-20-Beast/25.png" width=700>
</p>

<p>Beast 2.07 uses plain text communication. Different C2 commands are identified using integer values.</p>
<p>The first string received by the controller represents the username of the compromised machine (confirmed through reverse engineering).</p>
<h1 id="Reverse-Engineering"><a href="#Reverse-Engineering" class="headerlink" title="Reverse Engineering"></a>Reverse Engineering</h1><h2 id="Payload-Analysis"><a href="#Payload-Analysis" class="headerlink" title="Payload Analysis"></a>Payload Analysis</h2><p>Both the payload and controller are written in Delphi:</p>
<p align="center" class='item-img' data-src='/images/article/2026-2-20-Beast/11.png'><img src="/images/article/2026-2-20-Beast/11.png" width=500>
</p>

<p align="center" class='item-img' data-src='/images/article/2026-2-20-Beast/12.png'><img src="/images/article/2026-2-20-Beast/12.png" width=500>
</p>

<p>When analyzing the payload with Ghidra, I noticed that the Import Address Table appeared incomplete. Since a RAT payload is inherently a network application, the absence of APIs such as recv was suspicious.</p>
<p align="center" class='item-img' data-src='/images/article/2026-2-20-Beast/13.png'><img src="/images/article/2026-2-20-Beast/13.png" width=300>
</p>

<p>Ghidra provided the explanation: the binary was packed.</p>
<p align="center" class='item-img' data-src='/images/article/2026-2-20-Beast/17.png'><img src="/images/article/2026-2-20-Beast/17.png" width=300>
</p>

<p>Opening the file with PEView and ExeInfo confirmed that the payload was packed using UPX:</p>
<p align="center" class='item-img' data-src='/images/article/2026-2-20-Beast/14.png'><img src="/images/article/2026-2-20-Beast/14.png" width=500>
</p>

<p align="center" class='item-img' data-src='/images/article/2026-2-20-Beast/15.png'><img src="/images/article/2026-2-20-Beast/15.png" width=700>
</p>

<p>When a PE file is packed with UPX, the original import table is compressed or removed and reconstructed dynamically at runtime. Therefore, static analysis tools initially display incomplete imports.</p>
<blockquote>
<p>If you are interest in how a normal application looks like in <code>PEView.exe</code>, please <a href="https://iss4cf0ng.github.io/2026/01/04/2026-1-4-BookReverseEngineeringCore/#13-5-IAT">click here</a><br>If you are interest in IAT, please <a href="https://iss4cf0ng.github.io/2026/01/04/2026-1-4-BookReverseEngineeringCore/#45-2-TLS">click here</a></p>
</blockquote>
<p>After unpacking with:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">&gt; upx.exe -d packed.exe -o unpacked.exe<br></code></pre></td></tr></table></figure></p>
<p align="center" class='item-img' data-src='/images/article/2026-2-20-Beast/16.png'><img src="/images/article/2026-2-20-Beast/16.png" width=700>
</p>

<p>Reloading the unpacked binary in Ghidra restores the full import table.</p>
<p align="center" class='item-img' data-src='/images/article/2026-2-20-Beast/18.png'><img src="/images/article/2026-2-20-Beast/18.png" width=300>
    <img src="/images/article/2026-2-20-Beast/19.png" width=300>
</p>

<h3 id="Installation-Procedure"><a href="#Installation-Procedure" class="headerlink" title="Installation Procedure"></a>Installation Procedure</h3><p>The decompiled entry point reveals the installation logic:</p>
<p align="center" class='item-img' data-src='/images/article/2026-2-20-Beast/20.png'><img src="/images/article/2026-2-20-Beast/20.png" width=800>
</p>

<p>The payload modifies registry keys for persistence and then copies (or moves) itself to specific system directories:</p>
<p align="center" class='item-img' data-src='/images/article/2026-2-20-Beast/23.png'><img src="/images/article/2026-2-20-Beast/23.png" width=800>
</p>

<p align="center" class='item-img' data-src='/images/article/2026-2-20-Beast/24.png'><img src="/images/article/2026-2-20-Beast/24.png" width=800>
</p>

<h3 id="Notification-Mechanism"><a href="#Notification-Mechanism" class="headerlink" title="Notification Mechanism"></a>Notification Mechanism</h3><p align="center" class='item-img' data-src='/images/article/2026-2-20-Beast/21.png'><img src="/images/article/2026-2-20-Beast/21.png" width=800>
</p>

<p align="center" class='item-img' data-src='/images/article/2026-2-20-Beast/22.png'><img src="/images/article/2026-2-20-Beast/22.png" width=800>
</p>

<p>The notification function transmits victim information to the attacker using different communication mechanisms, depending on configuration.</p>
<p align="center" class='item-img' data-src='/images/article/2026-2-20-Beast/26.png'><img src="/images/article/2026-2-20-Beast/26.png" width=500>
</p>

<h3 id="Main-Function"><a href="#Main-Function" class="headerlink" title="Main Function"></a>Main Function</h3><p align="center" class='item-img' data-src='/images/article/2026-2-20-Beast/27.png'><img src="/images/article/2026-2-20-Beast/27.png" width=600>
</p>

<p align="center" class='item-img' data-src='/images/article/2026-2-20-Beast/28.png'><img src="/images/article/2026-2-20-Beast/28.png" width=600>
</p>

<p>The main function contains logic that determines the role of the payload:</p>
<ul>
<li>Server mode: accepts incoming socket connections</li>
<li>Client mode: connects back to the attacker</li>
</ul>
<p>As mentioned eariler, Beast uses integer values to distinguish C2 commands.</p>
<p align="center" class='item-img' data-src='/images/article/2026-2-20-Beast/29.png'><img src="/images/article/2026-2-20-Beast/29.png" width=600>
</p>

<p>The tool also leverages the <code>ShowWindow</code> Win32 API for features labeled as “Lamer Stuff” and “Fun Stuff”. These features inspired a similar feature in my own tool <a href="https://iss4cf0ng.github.io/2026/01/28/2026-1-28-ToolsDuplexSpy-v2-0-0/#FunStuff">DuplexSpy</a></p>
<p align="center" class='item-img' data-src='/images/article/2026-2-20-Beast/30.png'><img src="/images/article/2026-2-20-Beast/30.png" width=600>
</p>

<h3 id="Remote-Plugin"><a href="#Remote-Plugin" class="headerlink" title="Remote Plugin"></a>Remote Plugin</h3><p>After analyzing the protocol and reverse engineering the implementation, the plugin mechanism becomes clear:</p>
<ol>
<li>The controller sends a DLL as a byte array.</li>
<li>The payload writes the DLL to disk.</li>
<li>The payload dynamically loads the DLL using <code>LoadLibraryA</code></li>
</ol>
<p align="center" class='item-img' data-src='/images/article/2026-2-20-Beast/31.png'><img src="/images/article/2026-2-20-Beast/31.png" width=600>
</p>

<p>Captured traffic shows the <code>MZ</code> signature, confirming PE file transfer.</p>
<p>Beast identifiers this feature using integer value <code>101</code>, which equals <code>0x65</code> in hexadecimal:</p>
<p align="center" class='item-img' data-src='/images/article/2026-2-20-Beast/32.png'><img src="/images/article/2026-2-20-Beast/32.png" width=600>
</p>

<p>This plugin system is not fileless. Since the DLL is written to disk, modern antivirus software can detect this behavior. What’s more, plugins must be developed by the original author.</p>
<p align="center" class='item-img' data-src='/images/article/2026-2-20-Beast/33.png'><img src="/images/article/2026-2-20-Beast/33.png" width=600>
</p>

<h2 id="Controller-Side-Analysis"><a href="#Controller-Side-Analysis" class="headerlink" title="Controller-Side Analysis"></a>Controller-Side Analysis</h2><p>The attacker-side application <code>Beast2.07</code> is also packed. However, it was packed by ASPack instead of UPX:</p>
<p align="center" class='item-img' data-src='/images/article/2026-2-20-Beast/34.png'><img src="/images/article/2026-2-20-Beast/34.png" width=600>
</p>

<p align="center" class='item-img' data-src='/images/article/2026-2-20-Beast/35.png'><img src="/images/article/2026-2-20-Beast/35.png" width=600>
</p>

<h1 id="Vulnerabilities"><a href="#Vulnerabilities" class="headerlink" title="Vulnerabilities"></a>Vulnerabilities</h1><h2 id="Payload"><a href="#Payload" class="headerlink" title="Payload"></a>Payload</h2><p>When operating in server mode, the payload exposes a serious vulnerability in its plugin mechanism. Because the payload directly loads received DLL files using <code>LoadLibraryA</code>, an attacker could build a malicious DLL to achieve remote code execution or establish an alternative C2 channel (e.g., Meterpreter).</p>
<h2 id="Controller-Side"><a href="#Controller-Side" class="headerlink" title="Controller-Side"></a>Controller-Side</h2><p>Beast uses a plain-text protocol and trusts the first received string as machine identification. A simple Python script can send oversized data to the controller to trigger a denial-of-service condition:</p>
<p align="center" class='item-img' data-src='/images/article/2026-2-20-Beast/36.png'><img src="/images/article/2026-2-20-Beast/36.png" width=600>
</p>

<h1 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h1><p>Beast (BeastDoor) was a well-known (or notorious) remote access tool in the early 2000s. It represents a trasitional phase in offensive security techniques—shifting from direct connection models to reverse connection architectures. Although innovative for its time, it contains multiple vulnerabilities when evaluated under modern cybersecurity standards.</p>
<p>Through this reverse engineering process, I gained valuable insights into:</p>
<ul>
<li>UPX packing</li>
<li>ASPack protection</li>
<li>Legacy RAT architecture design</li>
</ul>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><blockquote id="fn_1">
<sup>1</sup>. <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Beast_(Trojan_horse">https://en.wikipedia.org/wiki/Beast_(Trojan_horse</a>)<a href="#reffn_1" title="Jump back to footnote [1] in the text."> &#8617;</a>
</blockquote>
<h1 id="THANKS-FOR-READING"><a href="#THANKS-FOR-READING" class="headerlink" title="THANKS FOR READING"></a>THANKS FOR READING</h1><p align="center" class='item-img' data-src='/images/meme/tea_party.jpg'><img src="/images/meme/tea_party.jpg" width=600>
</p><div id="paginator"></div></div><div id="post-footer"><div id="pages"><div class="footer-link" style="width: 50%;text-align:right;border-right:1px #fe2 solid"><a href="/2026/02/21/2026-2-21-HowToSetupYourExpEnv/">← Next [Learning] How to Setup Your Experimental Environment for Malware Analysis</a></div><div class="footer-link" style="width: 50%;right:1px;border-left:1px #fe2 solid"><a href="/2026/02/18/2026-2-18-BackOrifice/">[Studying] Analyzing Back Orifice Prev →</a></div></div></div></div><div class="bottom-btn"><div><a id="to-top" onClick="scrolls.scrolltop();" title="To Top" style="opacity: 0; display: none;">∧</a><a id="to-index" href="#toc-div" title="To Catalog">≡</a><a id="color-mode" onClick="colorMode.change()" title="Change Theme"></a></div></div></article><aside><div id="about"><a target="_blank" rel="noopener" href="https://github.com/iss4cf0ng/" width="200" id="logo"><img src="https://avatars.githubusercontent.com/u/110074064?v=4" alt="Logo"></a><h1 id="Dr"><a href="/">ISSAC</a></h1><div id="description"><p>Everything is failing...</p></div><div id="social-links"><a class="social" target="_blank" rel="noopener" href="https://github.com/iss4cf0ng/"><i class="fab fa-github" alt="GitHub"></i></a></div></div><div id="music"></div><div class="music-box"><hr style="border:1px solid #ccc; margin:10px 0"><p class="music-title">Feeling exhausted? Let's enjoy (やさしい) music!</p><p style="text-align:center; position: relative"><img class="music-anime" id="anime-img" src="/images/meme/himari_coffee.2.jpg" width="150" height="200"></p><div><button class="music-btn" id="music-toggle">▶ Play Music</button><span id="music-index" style="margin-left:10px"></span></div><hr style="border:1px solid #ccc; margin:10px 0"><audio id="bg-music"><source src="/mp3/music/music_1.mp3" type="audio/mpeg"></audio><script>document.addEventListener("DOMContentLoaded", function () {
  var playlist = [
    "/mp3/music/music_1.mp3",
    "/mp3/music/sugar_story.mp3",
    "/mp3/music/story_music_box.mp3",
    "/mp3/music/musa.mp3",
    "/mp3/music/air.mp3",
    "/mp3/music/last_page.mp3",
  ];

  var current = 0;
  const audio = document.getElementById("bg-music");
  const btn = document.getElementById("music-toggle");
  const indexDisplay = document.getElementById("music-index");

  indexDisplay.innerText = `Currently: ${current + 1} / ${playlist.length}`;

  btn.addEventListener("click", function () {
    if (audio.paused) {
      audio.src = playlist[current];
      audio.play();
      btn.innerText = "⏸ Pause Music";
    } else {
      audio.pause();
      btn.innerText = "▶ Play Music";
    }
  });

  audio.addEventListener("ended", function() {
    current = (current + 1) % playlist.length;
    audio.src = playlist[current];
    audio.play();
    indexDisplay.innerText = `Currently: ${current + 1} / ${playlist.length}`;
  });
});
</script><script>document.addEventListener("DOMContentLoaded", function () {
  const animeImg = document.getElementById("anime-img");

  animeImg.addEventListener("click", function() {
    
    const tip = document.createElement("div");
    tip.innerText = "?";
    tip.style.position = "absolute";
    tip.style.top = "-50px";
    tip.style.left = "50%";
    tip.style.transform = "translateX(-50%)";
    tip.style.backgroundColor = "#fff";
    tip.style.color = "rgb(16, 174, 11)";
    tip.style.padding = "2px 6px";
    tip.style.border = "1px solid #ccc";
    tip.style.borderRadius = "8px";
    tip.style.boxShadow = "0 3px 6px rgba(0,0,0,0.2)";
    tip.style.fontSize = "50px";
    tip.style.fontWeight = "bold";
    tip.style.zIndex = "1000";
    tip.style.opacity = "1";
    tip.style.transition = "opacity 1s, top 1s";
    
    animeImg.parentElement.appendChild(tip);

    setTimeout(() => {
      tip.style.opacity = "0";
      tip.style.top = "-60px";
      setTimeout(() => tip.remove(), 1000);
    }, 2000);
  });
});
</script></div><div id="aside-block"><div id="toc-div"><h1>Catalog</h1><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Introduction"><span class="toc-number">1.</span> <span class="toc-text">Introduction</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#BeastDoor"><span class="toc-number">2.</span> <span class="toc-text">BeastDoor</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Experimental-Environmental-Setup"><span class="toc-number">3.</span> <span class="toc-text">Experimental Environmental Setup</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Usage"><span class="toc-number">4.</span> <span class="toc-text">Usage</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Protocol-Analysis"><span class="toc-number">5.</span> <span class="toc-text">Protocol Analysis</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Reverse-Engineering"><span class="toc-number">6.</span> <span class="toc-text">Reverse Engineering</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Payload-Analysis"><span class="toc-number">6.1.</span> <span class="toc-text">Payload Analysis</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Installation-Procedure"><span class="toc-number">6.1.1.</span> <span class="toc-text">Installation Procedure</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Notification-Mechanism"><span class="toc-number">6.1.2.</span> <span class="toc-text">Notification Mechanism</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Main-Function"><span class="toc-number">6.1.3.</span> <span class="toc-text">Main Function</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Remote-Plugin"><span class="toc-number">6.1.4.</span> <span class="toc-text">Remote Plugin</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Controller-Side-Analysis"><span class="toc-number">6.2.</span> <span class="toc-text">Controller-Side Analysis</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Vulnerabilities"><span class="toc-number">7.</span> <span class="toc-text">Vulnerabilities</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Payload"><span class="toc-number">7.1.</span> <span class="toc-text">Payload</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Controller-Side"><span class="toc-number">7.2.</span> <span class="toc-text">Controller-Side</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Conclusion"><span class="toc-number">8.</span> <span class="toc-text">Conclusion</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Reference"><span class="toc-number">9.</span> <span class="toc-text">Reference</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#THANKS-FOR-READING"><span class="toc-number">10.</span> <span class="toc-text">THANKS FOR READING</span></a></li></ol></div></div><footer><nobr>Published with <a target="_blank" rel="noopener" href="http://hexo.io">Hexo</a></nobr></footer></aside></main><canvas id="canvas-dust"></canvas><script src="/js/search.js"></script><script src="/js/arknights.js"></script><script src="//unpkg.com/lightgallery@2.7.1/lightgallery.min.js"></script><script src="//unpkg.com/lightgallery@2.7.1/plugins/zoom/lg-zoom.min.js"></script><script src="//unpkg.com/lightgallery@2.7.1/plugins/thumbnail/lg-thumbnail.min.js"></script><script src="/js/pjax.js"></script><script class="pjax-js">reset= () => {code.findCode();
document.querySelector('.lg-container')?.remove()
lightGallery(document.getElementById('post-bg'), {
  plugins: [lgZoom,lgThumbnail],
  selector: '.item-img'})}</script><script>window.addEventListener("load",() => {pjax = new Pjax({
 cacheBust: false,
 selectors: ['title','article','#aside-block','.pjax-js'],
 switches: {'article': Pjax.switches.sideBySide},
 switchesOptions: {
   'article': {
     classNames: {
       remove: "pjax-out",
       add: "pjax-in"
     }
   }
 }
});
document.addEventListener("pjax:complete", reset);reset()})</script><script src="/js/slide.js"></script></body></html>